var reweby=function(e){"use strict";function t(e){return e.nodeType===e.ELEMENT_NODE}function r(e){var t=null==e?void 0:e.host;return Boolean((null==t?void 0:t.shadowRoot)===e)}function n(e){return"[object ShadowRoot]"===Object.prototype.toString.call(e)}function i(e){try{var t,r=e.rules||e.cssRules;return r?((t=Array.from(r).map(o).join("")).includes(" background-clip: text;")&&!t.includes(" -webkit-background-clip: text;")&&(t=t.replace(" background-clip: text;"," -webkit-background-clip: text; background-clip: text;")),t):null}catch(n){return null}}function o(e){var t,r=e.cssText;if(t=e,"styleSheet"in t)try{r=i(e.styleSheet)||r}catch(n){}return r}(c=u||(u={}))[c.Document=0]="Document",c[c.DocumentType=1]="DocumentType",c[c.Element=2]="Element",c[c.Text=3]="Text",c[c.CDATA=4]="CDATA",c[c.Comment=5]="Comment";var a,s,l,c,u,d,h,p,f,m,g=function(){function e(){this.idNodeMap=new Map,this.nodeMetaMap=new WeakMap}return e.prototype.getId=function(e){if(!e)return -1;var t,r=null===(t=this.getMeta(e))||void 0===t?void 0:t.id;return null!=r?r:-1},e.prototype.getNode=function(e){return this.idNodeMap.get(e)||null},e.prototype.getIds=function(){return Array.from(this.idNodeMap.keys())},e.prototype.getMeta=function(e){return this.nodeMetaMap.get(e)||null},e.prototype.removeNodeFromMap=function(e){var t=this,r=this.getId(e);this.idNodeMap.delete(r),e.childNodes&&e.childNodes.forEach(function(e){return t.removeNodeFromMap(e)})},e.prototype.has=function(e){return this.idNodeMap.has(e)},e.prototype.hasNode=function(e){return this.nodeMetaMap.has(e)},e.prototype.add=function(e,t){var r=t.id;this.idNodeMap.set(r,e),this.nodeMetaMap.set(e,t)},e.prototype.replace=function(e,t){var r=this.getNode(e);if(r){var n=this.nodeMetaMap.get(r);n&&this.nodeMetaMap.set(t,n)}this.idNodeMap.set(e,t)},e.prototype.reset=function(){this.idNodeMap=new Map,this.nodeMetaMap=new WeakMap},e}();function y(){return new g}function v(e){var t=e.maskInputOptions,r=e.tagName,n=e.type,i=e.value,o=e.maskInputFn,a=i||"";return(t[r.toLowerCase()]||t[n])&&(a=o?o(a):"*".repeat(a.length)),a}var $="__reweby_original__",b=1,C=RegExp("[^a-z0-9-_:]");function I(){return b++}var S=/url\((?:(')([^']*)'|(")(.*?)"|([^)]*))\)/gm,w=/^(?!www\.|(?:http|ftp)s?:\/\/|[A-Za-z]:\\|\/\/|#).*/,N=/^(data:)([^,]*),(.*)/i;function E(e,t){return(e||"").replace(S,function(e,r,n,i,o,a){var s,l,c=n||o||a,u=r||i||"";if(!c)return e;if(!w.test(c)||N.test(c))return"url(".concat(u).concat(c).concat(u,")");if("/"===c[0])return"url(".concat(u).concat((l=(l=(s=t).indexOf("//")>-1?s.split("/").slice(0,3).join("/"):s.split("/")[0]).split("?")[0])+c).concat(u,")");var d=t.split("/"),h=c.split("/");d.pop();for(var p=0,f=h;p<f.length;p++){var m=f[p];"."!==m&&(".."===m?d.pop():d.push(m))}return"url(".concat(u).concat(d.join("/")).concat(u,")")})}var _=/^[^ \t\n\r\u000c]+/,T=/^[, \t\n\r\u000c]+/;function M(e,t){if(!t||""===t.trim())return t;var r=e.createElement("a");return r.href=t,r.href}function R(){var e=document.createElement("a");return e.href="",e.href}function D(e,t,r,n){if("src"===r||"href"===r&&n&&!("use"===t&&"#"===n[0])||"xlink:href"===r&&n&&"#"!==n[0])return M(e,n);if("background"===r&&n&&("table"===t||"td"===t||"th"===t))return M(e,n);if("srcset"===r&&n)return function e(t,r){if(""===r.trim())return r;var n=0;function i(e){var t,i=e.exec(r.substring(n));return i?(n+=(t=i[0]).length,t):""}for(var o=[];i(T),!(n>=r.length);){var a=i(_);if(","===a.slice(-1))a=M(t,a.substring(0,a.length-1)),o.push(a);else{var s="";a=M(t,a);for(var l=!1;;){var c=r.charAt(n);if(""===c){o.push((a+s).trim());break}if(l)")"===c&&(l=!1);else{if(","===c){n+=1,o.push((a+s).trim());break}"("===c&&(l=!0)}s+=c,n+=1}}}return o.join(", ")}(e,n);if("style"===r&&n)return E(n,R());else if("object"===t&&"data"===r&&n)return M(e,n);else return n}function A(e,t,r){if(!e)return!1;if(e.nodeType!==e.ELEMENT_NODE)return!!r&&A(e.parentNode,t,r);for(var n=e.classList.length;n--;){var i=e.classList[n];if(t.test(i))return!0}return!!r&&A(e.parentNode,t,r)}function x(e,t,r){var n=e.nodeType===e.ELEMENT_NODE?e:e.parentElement;if(null===n)return!1;if("string"==typeof t){if(n.classList.contains(t)||n.closest(".".concat(t)))return!0}else if(A(n,t,!0))return!0;return!!(r&&(n.matches(r)||n.closest(r)))}function k(e){return void 0===e?"":e.toLowerCase()}function O(e,o){var a,s=o.doc,l=o.mirror,c=o.blockClass,p=o.blockSelector,f=o.maskTextClass,m=o.maskTextSelector,g=o.skipChild,y=void 0!==g&&g,b=o.inlineStylesheet,S=void 0===b||b,w=o.maskInputOptions,N=void 0===w?{}:w,_=o.maskTextFn,T=o.maskInputFn,M=o.slimDOMOptions,A=o.dataURLOptions,L=void 0===A?{}:A,F=o.inlineImages,P=void 0!==F&&F,G=o.recordCanvas,V=void 0!==G&&G,B=o.onSerialize,W=o.onIframeLoad,Y=o.iframeLoadTimeout,Z=void 0===Y?5e3:Y,U=o.onStylesheetLoad,z=o.stylesheetLoadTimeout,X=void 0===z?5e3:z,H=o.keepIframeSrcFn,K=void 0===H?function(){return!1}:H,j=o.newlyAddedElement,J=o.preserveWhiteSpace,Q=void 0===J||J,q=function e(t,r){var n=r.doc,o=r.mirror,a=r.blockClass,s=r.blockSelector,l=r.maskTextClass,c=r.maskTextSelector,p=r.inlineStylesheet,f=r.maskInputOptions,m=r.maskTextFn,g=r.maskInputFn,y=r.dataURLOptions,b=r.inlineImages,I=r.recordCanvas,S=r.keepIframeSrcFn,w=r.newlyAddedElement,N=function e(t,r){if(r.hasNode(t)){var n=r.getId(t);return 1===n?void 0:n}}(n,o);switch(t.nodeType){case t.DOCUMENT_NODE:if("CSS1Compat"!==t.compatMode)return{type:u.Document,childNodes:[],compatMode:t.compatMode};return{type:u.Document,childNodes:[]};case t.DOCUMENT_TYPE_NODE:return{type:u.DocumentType,name:t.name,publicId:t.publicId,systemId:t.systemId,rootId:N};case t.ELEMENT_NODE:return function e(t,r){for(var n,o=r.doc,a=r.blockClass,s=r.blockSelector,l=r.inlineStylesheet,c=r.maskInputOptions,p=void 0===c?{}:c,f=r.maskInputFn,m=r.dataURLOptions,g=void 0===m?{}:m,y=r.inlineImages,b=r.recordCanvas,I=r.keepIframeSrcFn,S=r.newlyAddedElement,w=r.rootId,N=function e(t,r,n){if("string"==typeof r){if(t.classList.contains(r))return!0}else for(var i=t.classList.length;i--;){var o=t.classList[i];if(r.test(o))return!0}return!!n&&t.matches(n)}(t,a,s),_=function e(t){if(t instanceof HTMLFormElement)return"form";var r=t.tagName.toLowerCase().trim();return C.test(r)?"div":r}(t),T={},M=t.attributes.length,A=0;A<M;A++){var x=t.attributes[A];T[x.name]=D(o,_,x.name,x.value)}if("link"===_&&l){var k=Array.from(o.styleSheets).find(function(e){return e.href===t.href}),O=null;k&&(O=i(k)),O&&(delete T.rel,delete T.href,T._cssText=E(O,k.href))}if("style"===_&&t.sheet&&!(t.innerText||t.textContent||"").trim().length){var O=i(t.sheet);O&&(T._cssText=E(O,R()))}if("input"===_||"textarea"===_||"select"===_){var L=t.value,F=t.checked;"radio"!==T.type&&"checkbox"!==T.type&&"submit"!==T.type&&"button"!==T.type&&L?T.value=v({type:T.type,tagName:_,value:L,maskInputOptions:p,maskInputFn:f}):F&&(T.checked=F)}if("option"===_&&(t.selected&&!p.select?T.selected=!0:delete T.selected),"canvas"===_&&b){if("2d"===t.__context)!function e(t){var r=t.getContext("2d");if(!r)return!0;for(var n=0;n<t.width;n+=50)for(var i=0;i<t.height;i+=50){var o=r.getImageData,a=$ in o?o[$]:o;if(new Uint32Array(a.call(r,n,i,Math.min(50,t.width-n),Math.min(50,t.height-i)).data.buffer).some(function(e){return 0!==e}))return!1}return!0}(t)&&(T.rr_dataURL=t.toDataURL(g.type,g.quality));else if(!("__context"in t)){var P=t.toDataURL(g.type,g.quality),G=document.createElement("canvas");G.width=t.width,G.height=t.height,P!==G.toDataURL(g.type,g.quality)&&(T.rr_dataURL=P)}}if("img"===_&&y){d||(h=(d=o.createElement("canvas")).getContext("2d"));var V=t,B=V.crossOrigin;V.crossOrigin="anonymous";var W=function(){try{d.width=V.naturalWidth,d.height=V.naturalHeight,h.drawImage(V,0,0),T.rr_dataURL=d.toDataURL(g.type,g.quality)}catch(e){console.warn("Cannot inline img src=".concat(V.currentSrc,"! Error: ").concat(e))}B?T.crossOrigin=B:V.removeAttribute("crossorigin")};V.complete&&0!==V.naturalWidth?W():V.onload=W}if(("audio"===_||"video"===_)&&(T.rr_mediaState=t.paused?"paused":"played",T.rr_mediaCurrentTime=t.currentTime),!(void 0!==S&&S)&&(t.scrollLeft&&(T.rr_scrollLeft=t.scrollLeft),t.scrollTop&&(T.rr_scrollTop=t.scrollTop)),N){var Y=t.getBoundingClientRect(),Z=Y.width,U=Y.height;T={class:T.class,rr_width:"".concat(Z,"px"),rr_height:"".concat(U,"px")}}return"iframe"!==_||I(T.src)||(t.contentDocument||(T.rr_src=T.src),delete T.src),{type:u.Element,tagName:_,attributes:T,childNodes:[],isSVG:(n=t,Boolean("svg"===n.tagName||n.ownerSVGElement)||void 0),needBlock:N,rootId:w}}(t,{doc:n,blockClass:a,blockSelector:s,inlineStylesheet:p,maskInputOptions:void 0===f?{}:f,maskInputFn:g,dataURLOptions:void 0===y?{}:y,inlineImages:b,recordCanvas:I,keepIframeSrcFn:S,newlyAddedElement:void 0!==w&&w,rootId:N});case t.TEXT_NODE:return function e(t,r){var n,i,o=r.maskTextClass,a=r.maskTextSelector,s=r.maskTextFn,l=r.rootId,c=t.parentNode&&t.parentNode.tagName,d=t.textContent,h="STYLE"===c||void 0,p="SCRIPT"===c||void 0;if(h&&d){try{t.nextSibling||t.previousSibling||(null===(i=t.parentNode.sheet)||void 0===i?void 0:i.cssRules)&&(d=(n=t.parentNode.sheet).cssRules?Array.from(n.cssRules).map(function(e){return e.cssText||""}).join(""):"")}catch(f){console.warn("Cannot get CSS styles from text's parentNode. Error: ".concat(f),t)}d=E(d,R())}return p&&(d="SCRIPT_PLACEHOLDER"),!h&&!p&&d&&x(t,o,a)&&(d=s?s(d):d.replace(/[\S]/g,"*")),{type:u.Text,textContent:d||"",isStyle:h,rootId:l}}(t,{maskTextClass:l,maskTextSelector:c,maskTextFn:m,rootId:N});case t.CDATA_SECTION_NODE:return{type:u.CDATA,textContent:"",rootId:N};case t.COMMENT_NODE:return{type:u.Comment,textContent:t.textContent||"",rootId:N};default:return!1}}(e,{doc:s,mirror:l,blockClass:c,blockSelector:p,maskTextClass:f,maskTextSelector:m,inlineStylesheet:S,maskInputOptions:N,maskTextFn:_,maskInputFn:T,dataURLOptions:L,inlineImages:P,recordCanvas:V,keepIframeSrcFn:K,newlyAddedElement:void 0!==j&&j});if(!q)return console.warn(e,"not serialized"),null;a=l.hasNode(e)?l.getId(e):!function e(t,r){if(r.comment&&t.type===u.Comment)return!0;if(t.type===u.Element){if(r.script&&("script"===t.tagName||"link"===t.tagName&&"preload"===t.attributes.rel&&"script"===t.attributes.as||"link"===t.tagName&&"prefetch"===t.attributes.rel&&"string"==typeof t.attributes.href&&t.attributes.href.endsWith(".js")))return!0;if(r.headFavicon&&("link"===t.tagName&&"shortcut icon"===t.attributes.rel||"meta"===t.tagName&&(k(t.attributes.name).match(/^msapplication-tile(image|color)$/)||"application-name"===k(t.attributes.name)||"icon"===k(t.attributes.rel)||"apple-touch-icon"===k(t.attributes.rel)||"shortcut icon"===k(t.attributes.rel))))return!0;if("meta"===t.tagName){if(r.headMetaDescKeywords&&k(t.attributes.name).match(/^description|keywords$/))return!0;if(r.headMetaSocial&&(k(t.attributes.property).match(/^(og|twitter|fb):/)||k(t.attributes.name).match(/^(og|twitter):/)||"pinterest"===k(t.attributes.name)))return!0;if(r.headMetaRobots&&("robots"===k(t.attributes.name)||"googlebot"===k(t.attributes.name)||"bingbot"===k(t.attributes.name)))return!0;else if(r.headMetaHttpEquiv&&void 0!==t.attributes["http-equiv"])return!0;else if(r.headMetaAuthorship&&("author"===k(t.attributes.name)||"generator"===k(t.attributes.name)||"framework"===k(t.attributes.name)||"publisher"===k(t.attributes.name)||"progid"===k(t.attributes.name)||k(t.attributes.property).match(/^article:/)||k(t.attributes.property).match(/^product:/)))return!0;else if(r.headMetaVerification&&("google-site-verification"===k(t.attributes.name)||"yandex-verification"===k(t.attributes.name)||"csrf-token"===k(t.attributes.name)||"p:domain_verify"===k(t.attributes.name)||"verify-v1"===k(t.attributes.name)||"verification"===k(t.attributes.name)||"shopify-checkout-api-token"===k(t.attributes.name)))return!0}}return!1}(q,M)&&(Q||q.type!==u.Text||q.isStyle||q.textContent.replace(/^\s+|\s+$/gm,"").length)?I():-2;var ee=Object.assign(q,{id:a});if(l.add(e,ee),-2===a)return null;B&&B(e);var et=!y;if(ee.type===u.Element){et=et&&!ee.needBlock,delete ee.needBlock;var er=e.shadowRoot;er&&n(er)&&(ee.isShadowHost=!0)}if((ee.type===u.Document||ee.type===u.Element)&&et){M.headWhitespace&&ee.type===u.Element&&"head"===ee.tagName&&(Q=!1);for(var en={doc:s,mirror:l,blockClass:c,blockSelector:p,maskTextClass:f,maskTextSelector:m,skipChild:y,inlineStylesheet:S,maskInputOptions:N,maskTextFn:_,maskInputFn:T,slimDOMOptions:M,dataURLOptions:L,inlineImages:P,recordCanvas:V,preserveWhiteSpace:Q,onSerialize:B,onIframeLoad:W,iframeLoadTimeout:Z,onStylesheetLoad:U,stylesheetLoadTimeout:X,keepIframeSrcFn:K},ei=0,eo=Array.from(e.childNodes);ei<eo.length;ei++){var ea=eo[ei],es=O(ea,en);es&&ee.childNodes.push(es)}if(t(e)&&e.shadowRoot)for(var el=0,ec=Array.from(e.shadowRoot.childNodes);el<ec.length;el++){var ea=ec[el],es=O(ea,en);es&&(n(e.shadowRoot)&&(es.isShadow=!0),ee.childNodes.push(es))}}return e.parentNode&&r(e.parentNode)&&n(e.parentNode)&&(ee.isShadow=!0),ee.type===u.Element&&"iframe"===ee.tagName&&function e(t,r,n){var i,o=t.contentWindow;if(o){var a=!1;try{i=o.document.readyState}catch(s){return}if("complete"!==i){var l=setTimeout(function(){a||(r(),a=!0)},n);t.addEventListener("load",function(){clearTimeout(l),a=!0,r()});return}var c="about:blank";if(o.location.href!==c||t.src===c||""===t.src)return setTimeout(r,0),t.addEventListener("load",r);t.addEventListener("load",r)}}(e,function(){var t=e.contentDocument;if(t&&W){var r=O(t,{doc:t,mirror:l,blockClass:c,blockSelector:p,maskTextClass:f,maskTextSelector:m,skipChild:!1,inlineStylesheet:S,maskInputOptions:N,maskTextFn:_,maskInputFn:T,slimDOMOptions:M,dataURLOptions:L,inlineImages:P,recordCanvas:V,preserveWhiteSpace:Q,onSerialize:B,onIframeLoad:W,iframeLoadTimeout:Z,onStylesheetLoad:U,stylesheetLoadTimeout:X,keepIframeSrcFn:K});r&&W(e,r)}},Z),ee.type===u.Element&&"link"===ee.tagName&&"stylesheet"===ee.attributes.rel&&function e(t,r,n){var i,o=!1;try{i=t.sheet}catch(a){return}if(!i){var s=setTimeout(function(){o||(r(),o=!0)},n);t.addEventListener("load",function(){clearTimeout(s),o=!0,r()})}}(e,function(){if(U){var t=O(e,{doc:s,mirror:l,blockClass:c,blockSelector:p,maskTextClass:f,maskTextSelector:m,skipChild:!1,inlineStylesheet:S,maskInputOptions:N,maskTextFn:_,maskInputFn:T,slimDOMOptions:M,dataURLOptions:L,inlineImages:P,recordCanvas:V,preserveWhiteSpace:Q,onSerialize:B,onIframeLoad:W,iframeLoadTimeout:Z,onStylesheetLoad:U,stylesheetLoadTimeout:X,keepIframeSrcFn:K});t&&U(e,t)}},X),ee}var L=/\/\*[^*]*\*+([^/*][^*]*\*+)*\//g;function F(e){return e?e.replace(/^\s+|\s+$/g,""):""}var P={script:"noscript",altglyph:"altGlyph",altglyphdef:"altGlyphDef",altglyphitem:"altGlyphItem",animatecolor:"animateColor",animatemotion:"animateMotion",animatetransform:"animateTransform",clippath:"clipPath",feblend:"feBlend",fecolormatrix:"feColorMatrix",fecomponenttransfer:"feComponentTransfer",fecomposite:"feComposite",feconvolvematrix:"feConvolveMatrix",fediffuselighting:"feDiffuseLighting",fedisplacementmap:"feDisplacementMap",fedistantlight:"feDistantLight",fedropshadow:"feDropShadow",feflood:"feFlood",fefunca:"feFuncA",fefuncb:"feFuncB",fefuncg:"feFuncG",fefuncr:"feFuncR",fegaussianblur:"feGaussianBlur",feimage:"feImage",femerge:"feMerge",femergenode:"feMergeNode",femorphology:"feMorphology",feoffset:"feOffset",fepointlight:"fePointLight",fespecularlighting:"feSpecularLighting",fespotlight:"feSpotLight",fetile:"feTile",feturbulence:"feTurbulence",foreignobject:"foreignObject",glyphref:"glyphRef",lineargradient:"linearGradient",radialgradient:"radialGradient"},G=/([^\\]):hover/,V=RegExp(G.source,"g");function B(e,t){var r=null==t?void 0:t.stylesWithHoverClass.get(e);if(r)return r;var n=function e(t,r){void 0===r&&(r={});var n,i=1,o=1;function a(e){var t=e.match(/\n/g);t&&(i+=t.length);var r=e.lastIndexOf("\n");o=-1===r?o+e.length:e.length-r}function s(){var e={line:i,column:o};return function(t){return t.position=new l(e),m(),t}}var l=function e(t){this.start=t,this.end={line:i,column:o},this.source=r.source};l.prototype.content=t;var c=[];function u(e){var n=Error("".concat(r.source||"",":").concat(i,":").concat(o,": ").concat(e));if(n.reason=e,n.filename=r.source,n.line=i,n.column=o,n.source=t,r.silent)c.push(n);else throw n}function d(){return f(/^{\s*/)}function h(){return f(/^}/)}function p(){var e,r=[];for(m(),g(r);t.length&&"}"!==t.charAt(0)&&(e=E()||_());)!1!==e&&(r.push(e),g(r));return r}function f(e){var r=e.exec(t);if(r){var n=r[0];return a(n),t=t.slice(n.length),r}}function m(){f(/^\s*/)}function g(e){var t;for(void 0===e&&(e=[]);t=y();)!1!==t&&e.push(t),t=y();return e}function y(){var e=s();if("/"===t.charAt(0)&&"*"===t.charAt(1)){for(var r=2;""!==t.charAt(r)&&("*"!==t.charAt(r)||"/"!==t.charAt(r+1));)++r;if(r+=2,""===t.charAt(r-1))return u("End of comment missing");var n=t.slice(2,r-2);return o+=2,a(n),t=t.slice(r),o+=2,e({type:"comment",comment:n})}}function v(){var e=f(/^([^{]+)/);if(e)return F(e[0]).replace(/\/\*([^*]|[\r\n]|(\*+([^*/]|[\r\n])))*\*\/+/g,"").replace(/"(?:\\"|[^"])*"|'(?:\\'|[^'])*'/g,function(e){return e.replace(/,/g,"â€Œ")}).split(/\s*(?![^(]*\)),\s*/).map(function(e){return e.replace(/\u200C/g,",")})}function $(){var e=s(),t=f(/^(\*?[-#\/\*\\\w]+(\[[0-9a-z_-]+\])?)\s*/);if(t){var r=F(t[0]);if(!f(/^:\s*/))return u("property missing ':'");var n=f(/^((?:'(?:\\'|.)*?'|"(?:\\"|.)*?"|\([^\)]*?\)|[^};])+)/),i=e({type:"declaration",property:r.replace(L,""),value:n?F(n[0]).replace(L,""):""});return f(/^[;\s]*/),i}}function b(){var e,t=[];if(!d())return u("missing '{'");for(g(t);e=$();)!1!==e&&(t.push(e),g(t)),e=$();return h()?t:u("missing '}'")}function C(){for(var e,t=[],r=s();e=f(/^((\d+\.\d+|\.\d+|\d+)%?|[a-z]+)\s*/);)t.push(e[1]),f(/^,\s*/);if(t.length)return r({type:"keyframe",values:t,declarations:b()})}var I=N("import"),S=N("charset"),w=N("namespace");function N(e){var t=RegExp("^@"+e+"\\s*([^;]+);");return function(){var r=s(),n=f(t);if(n){var i={type:e};return i[e]=n[1].trim(),r(i)}}}function E(){if("@"===t[0])return function e(){var t,r=s(),n=f(/^@([-\w]+)?keyframes\s*/);if(n){var i=n[1];if(!(n=f(/^([-\w]+)\s*/)))return u("@keyframes missing name");var o=n[1];if(!d())return u("@keyframes missing '{'");for(var a=g();t=C();)a.push(t),a=a.concat(g());return h()?r({type:"keyframes",name:o,vendor:i,keyframes:a}):u("@keyframes missing '}'")}}()||function e(){var t=s(),r=f(/^@media *([^{]+)/);if(r){var n=F(r[1]);if(!d())return u("@media missing '{'");var i=g().concat(p());return h()?t({type:"media",media:n,rules:i}):u("@media missing '}'")}}()||function e(){var t=s(),r=f(/^@custom-media\s+(--[^\s]+)\s*([^{;]+);/);if(r)return t({type:"custom-media",name:F(r[1]),media:F(r[2])})}()||function e(){var t=s(),r=f(/^@supports *([^{]+)/);if(r){var n=F(r[1]);if(!d())return u("@supports missing '{'");var i=g().concat(p());return h()?t({type:"supports",supports:n,rules:i}):u("@supports missing '}'")}}()||I()||S()||w()||function e(){var t=s(),r=f(/^@([-\w]+)?document *([^{]+)/);if(r){var n=F(r[1]),i=F(r[2]);if(!d())return u("@document missing '{'");var o=g().concat(p());return h()?t({type:"document",document:i,vendor:n,rules:o}):u("@document missing '}'")}}()||function e(){var t,r=s();if(f(/^@page */)){var n=v()||[];if(!d())return u("@page missing '{'");for(var i=g();t=$();)i.push(t),i=i.concat(g());return h()?r({type:"page",selectors:n,declarations:i}):u("@page missing '}'")}}()||function e(){var t=s();if(f(/^@host\s*/)){if(!d())return u("@host missing '{'");var r=g().concat(p());return h()?t({type:"host",rules:r}):u("@host missing '}'")}}()||function e(){var t,r=s();if(f(/^@font-face\s*/)){if(!d())return u("@font-face missing '{'");for(var n=g();t=$();)n.push(t),n=n.concat(g());return h()?r({type:"font-face",declarations:n}):u("@font-face missing '}'")}}()}function _(){var e=s(),t=v();return t?(g(),e({type:"rule",selectors:t,declarations:b()})):u("selector missing")}return function e(t,r){for(var n=t&&"string"==typeof t.type,i=n?t:r,o=0,a=Object.keys(t);o<a.length;o++){var s=t[a[o]];Array.isArray(s)?s.forEach(function(t){e(t,i)}):s&&"object"==typeof s&&e(s,i)}return n&&Object.defineProperty(t,"parent",{configurable:!0,writable:!0,enumerable:!1,value:r||null}),t}((n=p(),{type:"stylesheet",stylesheet:{source:r.source,rules:n,parsingErrors:c}}))}(e,{silent:!0});if(!n.stylesheet)return e;var i=[];if(n.stylesheet.rules.forEach(function(e){"selectors"in e&&(e.selectors||[]).forEach(function(e){G.test(e)&&i.push(e)})}),0===i.length)return e;var o=RegExp(i.filter(function(e,t){return i.indexOf(e)===t}).sort(function(e,t){return t.length-e.length}).map(function(e){var t;return(t=e).replace(/[.*+?^${}()|[\]\\]/g,"\\$&")}).join("|"),"g"),a=e.replace(o,function(e){var t=e.replace(V,"$1.\\:hover");return"".concat(e,", ").concat(t)});return null==t||t.stylesWithHoverClass.set(e,a),a}function W(){var e=new Map;return{stylesWithHoverClass:e}}function Y(e,r){var n=r.doc,i=r.mirror,o=r.skipChild,a=r.hackCss,s=void 0===a||a,l=r.afterAppend,c=r.cache,d=function e(t,r){var n=r.doc,i=r.hackCss,o=r.cache;switch(t.type){case u.Document:return n.implementation.createDocument(null,"",null);case u.DocumentType:return n.implementation.createDocumentType(t.name||"html",t.publicId,t.systemId);case u.Element:var a,s,l,c=("link"===(s=P[(a=t).tagName]?P[a.tagName]:a.tagName)&&a.attributes._cssText&&(s="style"),s);l=t.isSVG?n.createElementNS("http://www.w3.org/2000/svg",c):n.createElement(c);var d={};for(var h in t.attributes){if(Object.prototype.hasOwnProperty.call(t.attributes,h)){var p=t.attributes[h];if("option"!==c||"selected"!==h||!1!==p){if(!0===p&&(p=""),h.startsWith("rr_")){d[h]=p;continue}var f="textarea"===c&&"value"===h,m="style"===c&&"_cssText"===h;if(m&&i&&"string"==typeof p&&(p=B(p,o)),(f||m)&&"string"==typeof p){for(var g=n.createTextNode(p),y=0,v=Array.from(l.childNodes);y<v.length;y++){var $=v[y];$.nodeType===l.TEXT_NODE&&l.removeChild($)}l.appendChild(g);continue}try{if(t.isSVG&&"xlink:href"===h)l.setAttributeNS("http://www.w3.org/1999/xlink",h,p.toString());else if("onload"===h||"onclick"===h||"onmouse"===h.substring(0,7))l.setAttribute("_"+h,p.toString());else if("meta"===c&&"Content-Security-Policy"===t.attributes["http-equiv"]&&"content"===h){l.setAttribute("csp-content",p.toString());continue}else"link"===c&&"preload"===t.attributes.rel&&"script"===t.attributes.as||"link"===c&&"prefetch"===t.attributes.rel&&"string"==typeof t.attributes.href&&t.attributes.href.endsWith(".js")||("img"===c&&t.attributes.srcset&&t.attributes.rr_dataURL?l.setAttribute("reweby-original-srcset",t.attributes.srcset):l.setAttribute(h,p.toString()))}catch(b){}}}}for(var C in d)!function(e){var r=d[e];if("canvas"===c&&"rr_dataURL"===e){var n=document.createElement("img");n.onload=function(){var e=l.getContext("2d");e&&e.drawImage(n,0,0,n.width,n.height)},n.src=r.toString(),l.RRNodeType&&(l.rr_dataURL=r.toString())}else if("img"===c&&"rr_dataURL"===e){var i=l;i.currentSrc.startsWith("data:")||(i.setAttribute("reweby-original-src",t.attributes.src),i.src=r.toString())}if("rr_width"===e)l.style.width=r.toString();else if("rr_height"===e)l.style.height=r.toString();else if("rr_mediaCurrentTime"===e&&"number"==typeof r)l.currentTime=r;else if("rr_mediaState"===e)switch(r){case"played":l.play().catch(function(e){return console.warn("media playback error",e)});break;case"paused":l.pause()}}(C);if(t.isShadowHost){if(l.shadowRoot)for(;l.shadowRoot.firstChild;)l.shadowRoot.removeChild(l.shadowRoot.firstChild);else l.attachShadow({mode:"open"})}return l;case u.Text:return n.createTextNode(t.isStyle&&i?B(t.textContent,o):t.textContent);case u.CDATA:return n.createCDATASection(t.textContent);case u.Comment:return n.createComment(t.textContent);default:return null}}(e,{doc:n,hackCss:s,cache:c});if(!d)return null;if(e.rootId&&i.getNode(e.rootId)!==n&&i.replace(e.rootId,n),e.type===u.Document&&(n.close(),n.open(),"BackCompat"===e.compatMode&&e.childNodes&&e.childNodes[0].type!==u.DocumentType&&(e.childNodes[0].type===u.Element&&"xmlns"in e.childNodes[0].attributes&&"http://www.w3.org/1999/xhtml"===e.childNodes[0].attributes.xmlns?n.write('<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "">'):n.write('<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN" "">')),d=n),i.add(d,e),(e.type===u.Document||e.type===u.Element)&&!(void 0!==o&&o))for(var h=0,p=e.childNodes;h<p.length;h++){var f=p[h],m=Y(f,{doc:n,mirror:i,skipChild:!1,hackCss:s,afterAppend:l,cache:c});if(!m){console.warn("Failed to rebuild",f);continue}f.isShadow&&t(d)&&d.shadowRoot?d.shadowRoot.appendChild(m):d.appendChild(m),l&&l(m,f.id)}return d}function Z(e,t,r=document){let n={capture:!0,passive:!0};return r.addEventListener(e,t,n),()=>r.removeEventListener(e,t,n)}let U="Please stop import mirror directly. Instead of that,\r\nnow you can use replayer.getMirror() to access the mirror instance of a replayer,\r\nor you can use record.mirror to access the mirror instance during recording.";function z(e,t,r={}){let n=null,i=0;return function(...o){let a=Date.now();i||!1!==r.leading||(i=a);let s=t-(a-i),l=this;s<=0||s>t?(n&&(clearTimeout(n),n=null),i=a,e.apply(l,o)):n||!1===r.trailing||(n=setTimeout(()=>{i=!1===r.leading?0:Date.now(),n=null,e.apply(l,o)},s))}}function X(e,t,r,n,i=window){let o=i.Object.getOwnPropertyDescriptor(e,t);return i.Object.defineProperty(e,t,n?r:{set(e){setTimeout(()=>{r.set.call(this,e)},0),o&&o.set&&o.set.call(this,e)}}),()=>X(e,t,o||{},!0)}function H(e,t,r){try{if(!(t in e))return()=>{};let n=e[t],i=r(n);return"function"==typeof i&&(i.prototype=i.prototype||{},Object.defineProperties(i,{__reweby_original__:{enumerable:!1,value:n}})),e[t]=i,()=>{e[t]=n}}catch(o){return()=>{}}}function K(){return window.innerHeight||document.documentElement&&document.documentElement.clientHeight||document.body&&document.body.clientHeight}function j(){return window.innerWidth||document.documentElement&&document.documentElement.clientWidth||document.body&&document.body.clientWidth}function J(e,t,r,n){if(!e)return!1;let i=e.nodeType===e.ELEMENT_NODE?e:e.parentElement;if(!i)return!1;if("string"==typeof t){if(i.classList.contains(t)||n&&null!==i.closest("."+t))return!0}else if(A(i,t,n))return!0;return!!(r&&(e.matches(r)||n&&null!==i.closest(r)))}function Q(e,t){return -1!==t.getId(e)}function q(e,t){return -2===t.getId(e)}function ee(e,t){if(r(e))return!1;let n=t.getId(e);return!t.has(n)||(!e.parentNode||e.parentNode.nodeType!==e.DOCUMENT_NODE)&&(!e.parentNode||ee(e.parentNode,t))}function et(e){return Boolean(e.changedTouches)}function er(e=window){"NodeList"in e&&!e.NodeList.prototype.forEach&&(e.NodeList.prototype.forEach=Array.prototype.forEach),"DOMTokenList"in e&&!e.DOMTokenList.prototype.forEach&&(e.DOMTokenList.prototype.forEach=Array.prototype.forEach),Node.prototype.contains||(Node.prototype.contains=(...e)=>{let t=e[0];if(!(0 in e))throw TypeError("1 argument is required");do if(this===t)return!0;while(t=t&&t.parentNode);return!1})}function en(e){let t={},r=(e,r)=>{let n={value:e,parent:r,children:[]};return t[e.node.id]=n,n},n=[];for(let i of e){let{nextId:o,parentId:a}=i;if(o&&o in t){let s=t[o];if(s.parent){let l=s.parent.children.indexOf(s);s.parent.children.splice(l,0,r(i,s.parent))}else{let c=n.indexOf(s);n.splice(c,0,r(i,null))}continue}if(a in t){let u=t[a];u.children.push(r(i,u));continue}n.push(r(i,null))}return n}function ei(e,t){t(e.value);for(let r=e.children.length-1;r>=0;r--)ei(e.children[r],t)}function eo(e,t){return Boolean("IFRAME"===e.nodeName&&t.getMeta(e))}function ea(e,t){return Boolean("LINK"===e.nodeName&&e.nodeType===e.ELEMENT_NODE&&e.getAttribute&&"stylesheet"===e.getAttribute("rel")&&t.getMeta(e))}function es(e,t){var r,n;let i=null==(n=null==(r=e.ownerDocument)?void 0:r.defaultView)?void 0:n.frameElement;if(!i||i===t)return{x:0,y:0,relativeScale:1,absoluteScale:1};let o=i.getBoundingClientRect(),a=es(i,t),s=o.height/i.clientHeight;return{x:o.x*a.relativeScale+a.x,y:o.y*a.relativeScale+a.y,relativeScale:s,absoluteScale:a.absoluteScale*s}}function el(e){return Boolean(null==e?void 0:e.shadowRoot)}function ec(e,t){let r=e[t[0]];return 1===t.length?r:ec(r.cssRules[t[1]].cssRules,t.slice(2))}function eu(e){let t=[...e],r=t.pop();return{positions:t,index:r}}function ed(e){let t=new Set,r=[];for(let n=e.length;n--;){let i=e[n];t.has(i.id)||(r.push(i),t.add(i.id))}return r}e.mirror={map:{},getId:()=>(console.error(U),-1),getNode:()=>(console.error(U),null),removeNodeFromMap(){console.error(U)},has:()=>(console.error(U),!1),reset(){console.error(U)}},"undefined"!=typeof window&&window.Proxy&&window.Reflect&&(e.mirror=new Proxy(e.mirror,{get:(e,t,r)=>("map"===t&&console.error(U),Reflect.get(e,t,r))}));class eh{constructor(){this.id=1,this.styleIDMap=new WeakMap,this.idStyleMap=new Map}getId(e){var t;return null!=(t=this.styleIDMap.get(e))?t:-1}has(e){return this.styleIDMap.has(e)}add(e,t){if(this.has(e))return this.getId(e);let r;return r=void 0===t?this.id++:t,this.styleIDMap.set(e,r),this.idStyleMap.set(r,e),r}getStyle(e){return this.idStyleMap.get(e)||null}reset(){this.styleIDMap=new WeakMap,this.idStyleMap=new Map,this.id=1}generateId(){return this.id++}}var ep,ef,em,eg,ey,ev,e$=Object.freeze({__proto__:null,on:Z,get _mirror(){return e.mirror},throttle:z,hookSetter:X,patch:H,getWindowHeight:K,getWindowWidth:j,isBlocked:J,isSerialized:Q,isIgnored:q,isAncestorRemoved:ee,isTouchEvent:et,polyfill:er,queueToResolveTrees:en,iterateResolveTree:ei,isSerializedIframe:eo,isSerializedStylesheet:ea,getBaseDimension:es,hasShadowRoot:el,getNestedRule:ec,getPositionsAndIndex:eu,uniqueTextMutations:ed,StyleSheetMirror:eh}),eb=((ep=eb||{})[ep.DomContentLoaded=0]="DomContentLoaded",ep[ep.Load=1]="Load",ep[ep.FullSnapshot=2]="FullSnapshot",ep[ep.IncrementalSnapshot=3]="IncrementalSnapshot",ep[ep.Meta=4]="Meta",ep[ep.Custom=5]="Custom",ep[ep.Plugin=6]="Plugin",ep),eC=((ef=eC||{})[ef.Mutation=0]="Mutation",ef[ef.MouseMove=1]="MouseMove",ef[ef.MouseInteraction=2]="MouseInteraction",ef[ef.Scroll=3]="Scroll",ef[ef.ViewportResize=4]="ViewportResize",ef[ef.Input=5]="Input",ef[ef.TouchMove=6]="TouchMove",ef[ef.MediaInteraction=7]="MediaInteraction",ef[ef.StyleSheetRule=8]="StyleSheetRule",ef[ef.CanvasMutation=9]="CanvasMutation",ef[ef.Font=10]="Font",ef[ef.Log=11]="Log",ef[ef.Drag=12]="Drag",ef[ef.StyleDeclaration=13]="StyleDeclaration",ef[ef.Selection=14]="Selection",ef[ef.AdoptedStyleSheet=15]="AdoptedStyleSheet",ef),eI=((em=eI||{})[em.MouseUp=0]="MouseUp",em[em.MouseDown=1]="MouseDown",em[em.Click=2]="Click",em[em.ContextMenu=3]="ContextMenu",em[em.DblClick=4]="DblClick",em[em.Focus=5]="Focus",em[em.Blur=6]="Blur",em[em.TouchStart=7]="TouchStart",em[em.TouchMove_Departed=8]="TouchMove_Departed",em[em.TouchEnd=9]="TouchEnd",em[em.TouchCancel=10]="TouchCancel",em),eS=((eg=eS||{})[eg["2D"]=0]="2D",eg[eg.WebGL=1]="WebGL",eg[eg.WebGL2=2]="WebGL2",eg),ew=((ey=ew||{})[ey.Play=0]="Play",ey[ey.Pause=1]="Pause",ey[ey.Seeked=2]="Seeked",ey[ey.VolumeChange=3]="VolumeChange",ey[ey.RateChange=4]="RateChange",ey),eN=((ev=eN||{}).Start="start",ev.Pause="pause",ev.Resume="resume",ev.Resize="resize",ev.Finish="finish",ev.FullsnapshotRebuilded="fullsnapshot-rebuilded",ev.LoadStylesheetStart="load-stylesheet-start",ev.LoadStylesheetEnd="load-stylesheet-end",ev.SkipStart="skip-start",ev.SkipEnd="skip-end",ev.MouseInteraction="mouse-interaction",ev.EventCast="event-cast",ev.CustomEvent="custom-event",ev.Flush="flush",ev.StateChange="state-change",ev.PlayBack="play-back",ev.Destroy="destroy",ev);function eE(e){return"__ln"in e}class e_{constructor(){this.length=0,this.head=null}get(e){if(e>=this.length)throw Error("Position outside of list range");let t=this.head;for(let r=0;r<e;r++)t=(null==t?void 0:t.next)||null;return t}addNode(e){let t={value:e,previous:null,next:null};if(e.__ln=t,e.previousSibling&&eE(e.previousSibling)){let r=e.previousSibling.__ln.next;t.next=r,t.previous=e.previousSibling.__ln,e.previousSibling.__ln.next=t,r&&(r.previous=t)}else if(e.nextSibling&&eE(e.nextSibling)&&e.nextSibling.__ln.previous){let n=e.nextSibling.__ln.previous;t.previous=n,t.next=e.nextSibling.__ln,e.nextSibling.__ln.previous=t,n&&(n.next=t)}else this.head&&(this.head.previous=t),t.next=this.head,this.head=t;this.length++}removeNode(e){let t=e.__ln;this.head&&(t.previous?(t.previous.next=t.next,t.next&&(t.next.previous=t.previous)):(this.head=t.next,this.head&&(this.head.previous=null)),e.__ln&&delete e.__ln,this.length--)}}let eT=(e,t)=>`${e}@${t}`;class eM{constructor(){this.frozen=!1,this.locked=!1,this.texts=[],this.attributes=[],this.removes=[],this.mapRemoves=[],this.movedMap={},this.addedSet=new Set,this.movedSet=new Set,this.droppedSet=new Set,this.processMutations=e=>{e.forEach(this.processMutation),this.emit()},this.emit=()=>{if(this.frozen||this.locked)return;let e=[],t=new e_,n=e=>{let t=e,r=-2;for(;-2===r;)r=(t=t&&t.nextSibling)&&this.mirror.getId(t);return r},i=i=>{var o,a,s,l;let c=null;(null==(a=null==(o=i.getRootNode)?void 0:o.call(i))?void 0:a.nodeType)===Node.DOCUMENT_FRAGMENT_NODE&&i.getRootNode().host&&(c=i.getRootNode().host);let u=c;for(;(null==(l=null==(s=null==u?void 0:u.getRootNode)?void 0:s.call(u))?void 0:l.nodeType)===Node.DOCUMENT_FRAGMENT_NODE&&u.getRootNode().host;)u=u.getRootNode().host;let d=!this.doc.contains(i)&&(!u||!this.doc.contains(u));if(!i.parentNode||d)return;let h=r(i.parentNode)?this.mirror.getId(c):this.mirror.getId(i.parentNode),p=n(i);if(-1===h||-1===p)return t.addNode(i);let f=O(i,{doc:this.doc,mirror:this.mirror,blockClass:this.blockClass,blockSelector:this.blockSelector,maskTextClass:this.maskTextClass,maskTextSelector:this.maskTextSelector,skipChild:!0,newlyAddedElement:!0,inlineStylesheet:this.inlineStylesheet,maskInputOptions:this.maskInputOptions,maskTextFn:this.maskTextFn,maskInputFn:this.maskInputFn,slimDOMOptions:this.slimDOMOptions,dataURLOptions:this.dataURLOptions,recordCanvas:this.recordCanvas,inlineImages:this.inlineImages,onSerialize:e=>{eo(e,this.mirror)&&this.iframeManager.addIframe(e),ea(e,this.mirror)&&this.stylesheetManager.trackLinkElement(e),el(i)&&this.shadowDomManager.addShadowRoot(i.shadowRoot,this.doc)},onIframeLoad:(e,t)=>{this.iframeManager.attachIframe(e,t),this.shadowDomManager.observeAttachShadow(e)},onStylesheetLoad:(e,t)=>{this.stylesheetManager.attachLinkElement(e,t)}});f&&e.push({parentId:h,nextId:p,node:f})};for(;this.mapRemoves.length;)this.mirror.removeNodeFromMap(this.mapRemoves.shift());for(let o of Array.from(this.movedSet.values()))(!eD(this.removes,o,this.mirror)||this.movedSet.has(o.parentNode))&&i(o);for(let a of Array.from(this.addedSet.values()))eA(this.droppedSet,a)||eD(this.removes,a,this.mirror)?eA(this.movedSet,a)?i(a):this.droppedSet.add(a):i(a);let s=null;for(;t.length;){let l=null;if(s){let c=this.mirror.getId(s.value.parentNode),u=n(s.value);-1!==c&&-1!==u&&(l=s)}if(!l)for(let d=t.length-1;d>=0;d--){let h=t.get(d);if(h){let p=this.mirror.getId(h.value.parentNode),f=n(h.value);if(-1===f)continue;if(-1!==p){l=h;break}{let m=h.value;if(m.parentNode&&m.parentNode.nodeType===Node.DOCUMENT_FRAGMENT_NODE){let g=m.parentNode.host,y=this.mirror.getId(g);if(-1!==y){l=h;break}}}}}if(!l){for(;t.head;)t.removeNode(t.head.value);break}s=l.previous,t.removeNode(l.value),i(l.value)}let v={texts:this.texts.map(e=>({id:this.mirror.getId(e.node),value:e.value})).filter(e=>this.mirror.has(e.id)),attributes:this.attributes.map(e=>({id:this.mirror.getId(e.node),attributes:e.attributes})).filter(e=>this.mirror.has(e.id)),removes:this.removes,adds:e};(v.texts.length||v.attributes.length||v.removes.length||v.adds.length)&&(this.texts=[],this.attributes=[],this.removes=[],this.addedSet=new Set,this.movedSet=new Set,this.droppedSet=new Set,this.movedMap={},this.mutationCb(v))},this.processMutation=e=>{if(!q(e.target,this.mirror))switch(e.type){case"characterData":{let t=e.target.textContent;J(e.target,this.blockClass,this.blockSelector,!1)||t===e.oldValue||this.texts.push({value:x(e.target,this.maskTextClass,this.maskTextSelector)&&t?this.maskTextFn?this.maskTextFn(t):t.replace(/[\S]/g,"*"):t,node:e.target});break}case"attributes":{let i=e.target,o=e.target.getAttribute(e.attributeName);if("value"===e.attributeName&&(o=v({maskInputOptions:this.maskInputOptions,tagName:e.target.tagName,type:e.target.getAttribute("type"),value:o,maskInputFn:this.maskInputFn})),J(e.target,this.blockClass,this.blockSelector,!1)||o===e.oldValue)return;let a=this.attributes.find(t=>t.node===e.target);if("IFRAME"===i.tagName&&"src"===e.attributeName&&!this.keepIframeSrcFn(o)){if(i.contentDocument)return;e.attributeName="rr_src"}if(a||(a={node:e.target,attributes:{}},this.attributes.push(a)),"style"===e.attributeName){let s=this.doc.createElement("span");e.oldValue&&s.setAttribute("style",e.oldValue),(void 0===a.attributes.style||null===a.attributes.style)&&(a.attributes.style={});let l=a.attributes.style;for(let c of Array.from(i.style)){let u=i.style.getPropertyValue(c),d=i.style.getPropertyPriority(c);(u!==s.style.getPropertyValue(c)||d!==s.style.getPropertyPriority(c))&&(""===d?l[c]=u:l[c]=[u,d])}for(let h of Array.from(s.style))""===i.style.getPropertyValue(h)&&(l[h]=!1)}else a.attributes[e.attributeName]=D(this.doc,i.tagName,e.attributeName,o);break}case"childList":if(J(e.target,this.blockClass,this.blockSelector,!0))return;e.addedNodes.forEach(t=>this.genAdds(t,e.target)),e.removedNodes.forEach(t=>{let i=this.mirror.getId(t),o=r(e.target)?this.mirror.getId(e.target.host):this.mirror.getId(e.target);!(J(e.target,this.blockClass,this.blockSelector,!1)||q(t,this.mirror))&&Q(t,this.mirror)&&(this.addedSet.has(t)?(eR(this.addedSet,t),this.droppedSet.add(t)):this.addedSet.has(e.target)&&-1===i||ee(e.target,this.mirror)||(this.movedSet.has(t)&&this.movedMap[eT(i,o)]?eR(this.movedSet,t):this.removes.push({parentId:o,id:i,isShadow:!!(r(e.target)&&n(e.target))||void 0})),this.mapRemoves.push(t))})}},this.genAdds=(e,t)=>{if(this.mirror.hasNode(e)){if(q(e,this.mirror))return;this.movedSet.add(e);let r=null;t&&this.mirror.hasNode(t)&&(r=this.mirror.getId(t)),r&&-1!==r&&(this.movedMap[eT(this.mirror.getId(e),r)]=!0)}else this.addedSet.add(e),this.droppedSet.delete(e);J(e,this.blockClass,this.blockSelector,!1)||e.childNodes.forEach(e=>this.genAdds(e))}}init(e){["mutationCb","blockClass","blockSelector","maskTextClass","maskTextSelector","inlineStylesheet","maskInputOptions","maskTextFn","maskInputFn","keepIframeSrcFn","recordCanvas","inlineImages","slimDOMOptions","dataURLOptions","doc","mirror","iframeManager","stylesheetManager","shadowDomManager","canvasManager"].forEach(t=>{this[t]=e[t]})}freeze(){this.frozen=!0,this.canvasManager.freeze()}unfreeze(){this.frozen=!1,this.canvasManager.unfreeze(),this.emit()}isFrozen(){return this.frozen}lock(){this.locked=!0,this.canvasManager.lock()}unlock(){this.locked=!1,this.canvasManager.unlock(),this.emit()}reset(){this.shadowDomManager.reset(),this.canvasManager.reset()}}function eR(e,t){e.delete(t),t.childNodes.forEach(t=>eR(e,t))}function eD(e,t,r){return 0!==e.length&&function e(t,r,n){let{parentNode:i}=r;if(!i)return!1;let o=n.getId(i);return!!t.some(e=>e.id===o)||e(t,i,n)}(e,t,r)}function eA(e,t){return 0!==e.size&&function e(t,r){let{parentNode:n}=r;return!!n&&(!!t.has(n)||e(t,n))}(e,t)}var ex=Object.defineProperty,ek=Object.defineProperties,eO=Object.getOwnPropertyDescriptors,eL=Object.getOwnPropertySymbols,e0=Object.prototype.hasOwnProperty,e8=Object.prototype.propertyIsEnumerable,eF=(e,t,r)=>t in e?ex(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r,eP=(e,t)=>{for(var r in t||(t={}))e0.call(t,r)&&eF(e,r,t[r]);if(eL)for(var r of eL(t))e8.call(t,r)&&eF(e,r,t[r]);return e},e1=(e,t)=>ek(e,eO(t));let e3=[],eG="undefined"!=typeof CSSGroupingRule,eV="undefined"!=typeof CSSMediaRule,eB="undefined"!=typeof CSSSupportsRule,eW="undefined"!=typeof CSSConditionRule;function eY(e){try{if("composedPath"in e){let t=e.composedPath();if(t.length)return t[0]}else if("path"in e&&e.path.length)return e.path[0];return e.target}catch(r){return e.target}}function eZ(e,t){var r,n;let i=new eM;e3.push(i),i.init(e);let o=window.MutationObserver||window.__rrMutationObserver,a=null==(n=null==(r=null==window?void 0:window.Zone)?void 0:r.__symbol__)?void 0:n.call(r,"MutationObserver");a&&window[a]&&(o=window[a]);let s=new o(i.processMutations.bind(i));return s.observe(t,{attributes:!0,attributeOldValue:!0,characterData:!0,characterDataOldValue:!0,childList:!0,subtree:!0}),s}function eU({scrollCb:e,doc:t,mirror:r,blockClass:n,blockSelector:i,sampling:o}){let a=z(o=>{let a=eY(o);if(!a||J(a,n,i,!0))return;let s=r.getId(a);if(a===t){let l=t.scrollingElement||t.documentElement;e({id:s,x:l.scrollLeft,y:l.scrollTop})}else e({id:s,x:a.scrollLeft,y:a.scrollTop})},o.scroll||100);return Z("scroll",a,t)}function ez(e,t){let r=eP({},e);return t||delete r.userTriggered,r}let eX=["INPUT","TEXTAREA","SELECT"],eH=new WeakMap;function e6(e){return function e(t,r){if(eG&&t.parentRule instanceof CSSGroupingRule||eV&&t.parentRule instanceof CSSMediaRule||eB&&t.parentRule instanceof CSSSupportsRule||eW&&t.parentRule instanceof CSSConditionRule){let n=Array.from(t.parentRule.cssRules),i=n.indexOf(t);r.unshift(i)}else if(t.parentStyleSheet){let o=Array.from(t.parentStyleSheet.cssRules),a=o.indexOf(t);r.unshift(a)}return r}(e,[])}function e7(e,t,r){let n,i;return e?(e.ownerNode?n=t.getId(e.ownerNode):i=r.getId(e),{styleId:i,id:n}):{}}function e2({mirror:e,stylesheetManager:t},r){var n,i,o;let a=null;a="#document"===r.nodeName?e.getId(r):e.getId(r.host);let s="#document"===r.nodeName?null==(n=r.defaultView)?void 0:n.Document:null==(o=null==(i=r.ownerDocument)?void 0:i.defaultView)?void 0:o.ShadowRoot,l=Object.getOwnPropertyDescriptor(null==s?void 0:s.prototype,"adoptedStyleSheets");return null!==a&&-1!==a&&s&&l?(Object.defineProperty(r,"adoptedStyleSheets",{configurable:l.configurable,enumerable:l.enumerable,get(){var e;return null==(e=l.get)?void 0:e.call(this)},set(e){var r;let n=null==(r=l.set)?void 0:r.call(this,e);if(null!==a&&-1!==a)try{t.adoptStyleSheets(e,a)}catch(i){}return n}}),()=>{Object.defineProperty(r,"adoptedStyleSheets",{configurable:l.configurable,enumerable:l.enumerable,get:l.get,set:l.set})}):()=>{}}class e4{constructor(e){this.generateIdFn=e,this.iframeIdToRemoteIdMap=new WeakMap,this.iframeRemoteIdToIdMap=new WeakMap}getId(e,t,r,n){let i=r||this.getIdToRemoteIdMap(e),o=n||this.getRemoteIdToIdMap(e),a=i.get(t);return a||(a=this.generateIdFn(),i.set(t,a),o.set(a,t)),a}getIds(e,t){let r=this.getIdToRemoteIdMap(e),n=this.getRemoteIdToIdMap(e);return t.map(t=>this.getId(e,t,r,n))}getRemoteId(e,t,r){let n=r||this.getRemoteIdToIdMap(e);if("number"!=typeof t)return t;let i=n.get(t);return i||-1}getRemoteIds(e,t){let r=this.getRemoteIdToIdMap(e);return t.map(t=>this.getRemoteId(e,t,r))}reset(e){if(!e){this.iframeIdToRemoteIdMap=new WeakMap,this.iframeRemoteIdToIdMap=new WeakMap;return}this.iframeIdToRemoteIdMap.delete(e),this.iframeRemoteIdToIdMap.delete(e)}getIdToRemoteIdMap(e){let t=this.iframeIdToRemoteIdMap.get(e);return t||(t=new Map,this.iframeIdToRemoteIdMap.set(e,t)),t}getRemoteIdToIdMap(e){let t=this.iframeRemoteIdToIdMap.get(e);return t||(t=new Map,this.iframeRemoteIdToIdMap.set(e,t)),t}}class eK{constructor(e){this.iframes=new WeakMap,this.crossOriginIframeMap=new WeakMap,this.crossOriginIframeMirror=new e4(I),this.mutationCb=e.mutationCb,this.wrappedEmit=e.wrappedEmit,this.stylesheetManager=e.stylesheetManager,this.recordCrossOriginIframes=e.recordCrossOriginIframes,this.crossOriginIframeStyleMirror=new e4(this.stylesheetManager.styleMirror.generateId.bind(this.stylesheetManager.styleMirror)),this.mirror=e.mirror,this.recordCrossOriginIframes&&window.addEventListener("message",this.handleMessage.bind(this))}addIframe(e){this.iframes.set(e,!0),e.contentWindow&&this.crossOriginIframeMap.set(e.contentWindow,e)}addLoadListener(e){this.loadListener=e}attachIframe(e,t){var r;this.mutationCb({adds:[{parentId:this.mirror.getId(e),nextId:null,node:t}],removes:[],texts:[],attributes:[],isAttachIframe:!0}),null==(r=this.loadListener)||r.call(this,e),e.contentDocument&&e.contentDocument.adoptedStyleSheets&&e.contentDocument.adoptedStyleSheets.length>0&&this.stylesheetManager.adoptStyleSheets(e.contentDocument.adoptedStyleSheets,this.mirror.getId(e.contentDocument))}handleMessage(e){if("reweby"===e.data.type){let t=e.source;if(!t)return;let r=this.crossOriginIframeMap.get(e.source);if(!r)return;let n=this.transformCrossOriginEvent(r,e.data.event);n&&this.wrappedEmit(n,e.data.isCheckout)}}transformCrossOriginEvent(e,t){var r;switch(t.type){case eb.FullSnapshot:return this.crossOriginIframeMirror.reset(e),this.crossOriginIframeStyleMirror.reset(e),this.replaceIdOnNode(t.data.node,e),{timestamp:t.timestamp,type:eb.IncrementalSnapshot,data:{source:eC.Mutation,adds:[{parentId:this.mirror.getId(e),nextId:null,node:t.data.node}],removes:[],texts:[],attributes:[],isAttachIframe:!0}};case eb.Meta:case eb.Load:case eb.DomContentLoaded:return!1;case eb.Plugin:return t;case eb.Custom:return this.replaceIds(t.data.payload,e,["id","parentId","previousId","nextId"]),t;case eb.IncrementalSnapshot:switch(t.data.source){case eC.Mutation:return t.data.adds.forEach(t=>{this.replaceIds(t,e,["parentId","nextId","previousId"]),this.replaceIdOnNode(t.node,e)}),t.data.removes.forEach(t=>{this.replaceIds(t,e,["parentId","id"])}),t.data.attributes.forEach(t=>{this.replaceIds(t,e,["id"])}),t.data.texts.forEach(t=>{this.replaceIds(t,e,["id"])}),t;case eC.Drag:case eC.TouchMove:case eC.MouseMove:return t.data.positions.forEach(t=>{this.replaceIds(t,e,["id"])}),t;case eC.ViewportResize:return!1;case eC.MediaInteraction:case eC.MouseInteraction:case eC.Scroll:case eC.CanvasMutation:case eC.Input:return this.replaceIds(t.data,e,["id"]),t;case eC.StyleSheetRule:case eC.StyleDeclaration:return this.replaceIds(t.data,e,["id"]),this.replaceStyleIds(t.data,e,["styleId"]),t;case eC.Font:return t;case eC.Selection:return t.data.ranges.forEach(t=>{this.replaceIds(t,e,["start","end"])}),t;case eC.AdoptedStyleSheet:return this.replaceIds(t.data,e,["id"]),this.replaceStyleIds(t.data,e,["styleIds"]),null==(r=t.data.styles)||r.forEach(t=>{this.replaceStyleIds(t,e,["styleId"])}),t}}}replace(e,t,r,n){for(let i of n)(Array.isArray(t[i])||"number"==typeof t[i])&&(Array.isArray(t[i])?t[i]=e.getIds(r,t[i]):t[i]=e.getId(r,t[i]));return t}replaceIds(e,t,r){return this.replace(this.crossOriginIframeMirror,e,t,r)}replaceStyleIds(e,t,r){return this.replace(this.crossOriginIframeStyleMirror,e,t,r)}replaceIdOnNode(e,t){this.replaceIds(e,t,["id"]),"childNodes"in e&&e.childNodes.forEach(e=>{this.replaceIdOnNode(e,t)})}}var e5=Object.defineProperty,ej=Object.defineProperties,eJ=Object.getOwnPropertyDescriptors,eQ=Object.getOwnPropertySymbols,e9=Object.prototype.hasOwnProperty,eq=Object.prototype.propertyIsEnumerable,te=(e,t,r)=>t in e?e5(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r,tt=(e,t)=>{for(var r in t||(t={}))e9.call(t,r)&&te(e,r,t[r]);if(eQ)for(var r of eQ(t))eq.call(t,r)&&te(e,r,t[r]);return e},tr=(e,t)=>ej(e,eJ(t));class tn{constructor(e){this.shadowDoms=new WeakSet,this.restorePatches=[],this.mutationCb=e.mutationCb,this.scrollCb=e.scrollCb,this.bypassOptions=e.bypassOptions,this.mirror=e.mirror;let t=this;this.restorePatches.push(H(Element.prototype,"attachShadow",function(e){return function(r){let n=e.call(this,r);return this.shadowRoot&&t.addShadowRoot(this.shadowRoot,this.ownerDocument),n}}))}addShadowRoot(e,t){n(e)&&(this.shadowDoms.has(e)||(this.shadowDoms.add(e),eZ(tr(tt({},this.bypassOptions),{doc:t,mutationCb:this.mutationCb,mirror:this.mirror,shadowDomManager:this}),e),eU(tr(tt({},this.bypassOptions),{scrollCb:this.scrollCb,doc:e,mirror:this.mirror})),setTimeout(()=>{e.adoptedStyleSheets&&e.adoptedStyleSheets.length>0&&this.bypassOptions.stylesheetManager.adoptStyleSheets(e.adoptedStyleSheets,this.mirror.getId(e.host)),e2({mirror:this.mirror,stylesheetManager:this.bypassOptions.stylesheetManager},e)},0)))}observeAttachShadow(e){if(e.contentWindow){let t=this;this.restorePatches.push(H(e.contentWindow.HTMLElement.prototype,"attachShadow",function(r){return function(n){let i=r.call(this,n);return this.shadowRoot&&t.addShadowRoot(this.shadowRoot,e.contentDocument),i}}))}}reset(){this.restorePatches.forEach(e=>e()),this.shadowDoms=new WeakSet}}for(var ti="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",to="undefined"==typeof Uint8Array?[]:new Uint8Array(256),ta=0;ta<ti.length;ta++)to[ti.charCodeAt(ta)]=ta;var ts=function(e){var t,r=new Uint8Array(e),n=r.length,i="";for(t=0;t<n;t+=3)i+=ti[r[t]>>2],i+=ti[(3&r[t])<<4|r[t+1]>>4],i+=ti[(15&r[t+1])<<2|r[t+2]>>6],i+=ti[63&r[t+2]];return n%3==2?i=i.substring(0,i.length-1)+"=":n%3==1&&(i=i.substring(0,i.length-2)+"=="),i},tl=function(e){var t,r,n,i,o,a=.75*e.length,s=e.length,l=0;"="===e[e.length-1]&&(a--,"="===e[e.length-2]&&a--);var c=new ArrayBuffer(a),u=new Uint8Array(c);for(t=0;t<s;t+=4)r=to[e.charCodeAt(t)],n=to[e.charCodeAt(t+1)],i=to[e.charCodeAt(t+2)],o=to[e.charCodeAt(t+3)],u[l++]=r<<2|n>>4,u[l++]=(15&n)<<4|i>>2,u[l++]=(3&i)<<6|63&o;return c};let tc=new Map,tu=(e,t,r)=>{var n,i;if(!e||!(th(e,t)||"object"==typeof e))return;let o=e.constructor.name,a,s=(n=r,i=o,(a=tc.get(n))||(a=new Map,tc.set(n,a)),a.has(i)||a.set(i,[]),a.get(i)),l=s.indexOf(e);return -1===l&&(l=s.length,s.push(e)),l},td=(e,t,r)=>[...e].map(e=>(function e(t,r,n){if(t instanceof Array)return t.map(t=>e(t,r,n));if(null===t);else if(t instanceof Float32Array||t instanceof Float64Array||t instanceof Int32Array||t instanceof Uint32Array||t instanceof Uint8Array||t instanceof Uint16Array||t instanceof Int16Array||t instanceof Int8Array||t instanceof Uint8ClampedArray){let i=t.constructor.name;return{rr_type:i,args:[Object.values(t)]}}else if(t instanceof ArrayBuffer){let o=t.constructor.name,a=ts(t);return{rr_type:o,base64:a}}else if(t instanceof DataView){let s=t.constructor.name;return{rr_type:s,args:[e(t.buffer,r,n),t.byteOffset,t.byteLength]}}else if(t instanceof HTMLImageElement){let l=t.constructor.name,{src:c}=t;return{rr_type:l,src:c}}else if(t instanceof HTMLCanvasElement){let u=t.toDataURL();return{rr_type:"HTMLImageElement",src:u}}else if(t instanceof ImageData){let d=t.constructor.name;return{rr_type:d,args:[e(t.data,r,n),t.width,t.height]}}else if(th(t,r)||"object"==typeof t){let h=t.constructor.name,p=tu(t,r,n);return{rr_type:h,index:p}}return t})(e,t,r)),th=(e,t)=>{let r=["WebGLActiveInfo","WebGLBuffer","WebGLFramebuffer","WebGLProgram","WebGLRenderbuffer","WebGLShader","WebGLShaderPrecisionFormat","WebGLTexture","WebGLUniformLocation","WebGLVertexArrayObject","WebGLVertexArrayObjectOES"].filter(e=>"function"==typeof t[e]);return Boolean(r.find(r=>e instanceof t[r]))};function tp(e,t,r){let n=[];try{let i=H(e.HTMLCanvasElement.prototype,"getContext",function(e){return function(n,...i){return J(this,t,r,!0)||"__context"in this||(this.__context=n),e.apply(this,[n,...i])}});n.push(i)}catch(o){console.error("failed to patch HTMLCanvasElement.prototype.getContext")}return()=>{n.forEach(e=>e())}}function tf(e,t,r,n,i,o,a){let s=[],l=Object.getOwnPropertyNames(e);for(let c of l)if(!["isContextLost","canvas","drawingBufferWidth","drawingBufferHeight"].includes(c))try{if("function"!=typeof e[c])continue;let u=H(e,c,function(e){return function(...o){let s=e.apply(this,o);if(tu(s,a,this),!J(this.canvas,n,i,!0)){let l=td([...o],a,this),u={type:t,property:c,args:l};r(this.canvas,u)}return s}});s.push(u)}catch(d){let h=X(e,c,{set(e){r(this.canvas,{type:t,property:c,args:[e],setter:!0})}});s.push(h)}return s}var tm,tg,ty=(tm=!1,function e(t){var r,n,i,o,a,s,l,c;return tg=tg||(r="Lyogcm9sbHVwLXBsdWdpbi13ZWItd29ya2VyLWxvYWRlciAqLwooZnVuY3Rpb24gKCkgewogICAgJ3VzZSBzdHJpY3QnOwoKICAgIC8qCiAgICAgKiBiYXNlNjQtYXJyYXlidWZmZXIgMS4wLjEgPGh0dHBzOi8vZ2l0aHViLmNvbS9uaWtsYXN2aC9iYXNlNjQtYXJyYXlidWZmZXI+CiAgICAgKiBDb3B5cmlnaHQgKGMpIDIwMjEgTmlrbGFzIHZvbiBIZXJ0emVuIDxodHRwczovL2hlcnR6ZW4uY29tPgogICAgICogUmVsZWFzZWQgdW5kZXIgTUlUIExpY2Vuc2UKICAgICAqLwogICAgdmFyIGNoYXJzID0gJ0FCQ0RFRkdISUpLTE1OT1BRUlNUVVZXWFlaYWJjZGVmZ2hpamtsbW5vcHFyc3R1dnd4eXowMTIzNDU2Nzg5Ky8nOwogICAgLy8gVXNlIGEgbG9va3VwIHRhYmxlIHRvIGZpbmQgdGhlIGluZGV4LgogICAgdmFyIGxvb2t1cCA9IHR5cGVvZiBVaW50OEFycmF5ID09PSAndW5kZWZpbmVkJyA/IFtdIDogbmV3IFVpbnQ4QXJyYXkoMjU2KTsKICAgIGZvciAodmFyIGkgPSAwOyBpIDwgY2hhcnMubGVuZ3RoOyBpKyspIHsKICAgICAgICBsb29rdXBbY2hhcnMuY2hhckNvZGVBdChpKV0gPSBpOwogICAgfQogICAgdmFyIGVuY29kZSA9IGZ1bmN0aW9uIChhcnJheWJ1ZmZlcikgewogICAgICAgIHZhciBieXRlcyA9IG5ldyBVaW50OEFycmF5KGFycmF5YnVmZmVyKSwgaSwgbGVuID0gYnl0ZXMubGVuZ3RoLCBiYXNlNjQgPSAnJzsKICAgICAgICBmb3IgKGkgPSAwOyBpIDwgbGVuOyBpICs9IDMpIHsKICAgICAgICAgICAgYmFzZTY0ICs9IGNoYXJzW2J5dGVzW2ldID4+IDJdOwogICAgICAgICAgICBiYXNlNjQgKz0gY2hhcnNbKChieXRlc1tpXSAmIDMpIDw8IDQpIHwgKGJ5dGVzW2kgKyAxXSA+PiA0KV07CiAgICAgICAgICAgIGJhc2U2NCArPSBjaGFyc1soKGJ5dGVzW2kgKyAxXSAmIDE1KSA8PCAyKSB8IChieXRlc1tpICsgMl0gPj4gNildOwogICAgICAgICAgICBiYXNlNjQgKz0gY2hhcnNbYnl0ZXNbaSArIDJdICYgNjNdOwogICAgICAgIH0KICAgICAgICBpZiAobGVuICUgMyA9PT0gMikgewogICAgICAgICAgICBiYXNlNjQgPSBiYXNlNjQuc3Vic3RyaW5nKDAsIGJhc2U2NC5sZW5ndGggLSAxKSArICc9JzsKICAgICAgICB9CiAgICAgICAgZWxzZSBpZiAobGVuICUgMyA9PT0gMSkgewogICAgICAgICAgICBiYXNlNjQgPSBiYXNlNjQuc3Vic3RyaW5nKDAsIGJhc2U2NC5sZW5ndGggLSAyKSArICc9PSc7CiAgICAgICAgfQogICAgICAgIHJldHVybiBiYXNlNjQ7CiAgICB9OwoKICAgIGNvbnN0IGxhc3RCbG9iTWFwID0gLyogQF9fUFVSRV9fICovIG5ldyBNYXAoKTsKICAgIGNvbnN0IHRyYW5zcGFyZW50QmxvYk1hcCA9IC8qIEBfX1BVUkVfXyAqLyBuZXcgTWFwKCk7CiAgICBhc3luYyBmdW5jdGlvbiBnZXRUcmFuc3BhcmVudEJsb2JGb3Iod2lkdGgsIGhlaWdodCwgZGF0YVVSTE9wdGlvbnMpIHsKICAgICAgY29uc3QgaWQgPSBgJHt3aWR0aH0tJHtoZWlnaHR9YDsKICAgICAgaWYgKCJPZmZzY3JlZW5DYW52YXMiIGluIGdsb2JhbFRoaXMpIHsKICAgICAgICBpZiAodHJhbnNwYXJlbnRCbG9iTWFwLmhhcyhpZCkpCiAgICAgICAgICByZXR1cm4gdHJhbnNwYXJlbnRCbG9iTWFwLmdldChpZCk7CiAgICAgICAgY29uc3Qgb2Zmc2NyZWVuID0gbmV3IE9mZnNjcmVlbkNhbnZhcyh3aWR0aCwgaGVpZ2h0KTsKICAgICAgICBvZmZzY3JlZW4uZ2V0Q29udGV4dCgiMmQiKTsKICAgICAgICBjb25zdCBibG9iID0gYXdhaXQgb2Zmc2NyZWVuLmNvbnZlcnRUb0Jsb2IoZGF0YVVSTE9wdGlvbnMpOwogICAgICAgIGNvbnN0IGFycmF5QnVmZmVyID0gYXdhaXQgYmxvYi5hcnJheUJ1ZmZlcigpOwogICAgICAgIGNvbnN0IGJhc2U2NCA9IGVuY29kZShhcnJheUJ1ZmZlcik7CiAgICAgICAgdHJhbnNwYXJlbnRCbG9iTWFwLnNldChpZCwgYmFzZTY0KTsKICAgICAgICByZXR1cm4gYmFzZTY0OwogICAgICB9IGVsc2UgewogICAgICAgIHJldHVybiAiIjsKICAgICAgfQogICAgfQogICAgY29uc3Qgd29ya2VyID0gc2VsZjsKICAgIHdvcmtlci5vbm1lc3NhZ2UgPSBhc3luYyBmdW5jdGlvbihlKSB7CiAgICAgIGlmICgiT2Zmc2NyZWVuQ2FudmFzIiBpbiBnbG9iYWxUaGlzKSB7CiAgICAgICAgY29uc3QgeyBpZCwgYml0bWFwLCB3aWR0aCwgaGVpZ2h0LCBkYXRhVVJMT3B0aW9ucyB9ID0gZS5kYXRhOwogICAgICAgIGNvbnN0IHRyYW5zcGFyZW50QmFzZTY0ID0gZ2V0VHJhbnNwYXJlbnRCbG9iRm9yKHdpZHRoLCBoZWlnaHQsIGRhdGFVUkxPcHRpb25zKTsKICAgICAgICBjb25zdCBvZmZzY3JlZW4gPSBuZXcgT2Zmc2NyZWVuQ2FudmFzKHdpZHRoLCBoZWlnaHQpOwogICAgICAgIGNvbnN0IGN0eCA9IG9mZnNjcmVlbi5nZXRDb250ZXh0KCIyZCIpOwogICAgICAgIGN0eC5kcmF3SW1hZ2UoYml0bWFwLCAwLCAwKTsKICAgICAgICBiaXRtYXAuY2xvc2UoKTsKICAgICAgICBjb25zdCBibG9iID0gYXdhaXQgb2Zmc2NyZWVuLmNvbnZlcnRUb0Jsb2IoZGF0YVVSTE9wdGlvbnMpOwogICAgICAgIGNvbnN0IHR5cGUgPSBibG9iLnR5cGU7CiAgICAgICAgY29uc3QgYXJyYXlCdWZmZXIgPSBhd2FpdCBibG9iLmFycmF5QnVmZmVyKCk7CiAgICAgICAgY29uc3QgYmFzZTY0ID0gZW5jb2RlKGFycmF5QnVmZmVyKTsKICAgICAgICBpZiAoIWxhc3RCbG9iTWFwLmhhcyhpZCkgJiYgYXdhaXQgdHJhbnNwYXJlbnRCYXNlNjQgPT09IGJhc2U2NCkgewogICAgICAgICAgbGFzdEJsb2JNYXAuc2V0KGlkLCBiYXNlNjQpOwogICAgICAgICAgcmV0dXJuIHdvcmtlci5wb3N0TWVzc2FnZSh7IGlkIH0pOwogICAgICAgIH0KICAgICAgICBpZiAobGFzdEJsb2JNYXAuZ2V0KGlkKSA9PT0gYmFzZTY0KQogICAgICAgICAgcmV0dXJuIHdvcmtlci5wb3N0TWVzc2FnZSh7IGlkIH0pOwogICAgICAgIHdvcmtlci5wb3N0TWVzc2FnZSh7CiAgICAgICAgICBpZCwKICAgICAgICAgIHR5cGUsCiAgICAgICAgICBiYXNlNjQsCiAgICAgICAgICB3aWR0aCwKICAgICAgICAgIGhlaWdodAogICAgICAgIH0pOwogICAgICAgIGxhc3RCbG9iTWFwLnNldChpZCwgYmFzZTY0KTsKICAgICAgfSBlbHNlIHsKICAgICAgICByZXR1cm4gd29ya2VyLnBvc3RNZXNzYWdlKHsgaWQ6IGUuZGF0YS5pZCB9KTsKICAgICAgfQogICAgfTsKCn0pKCk7Cgo=",n=null,i=tm,o=void 0===n?null:n,s=(a=function e(t,r){var n=atob(t);if(r){for(var i=new Uint8Array(n.length),o=0,a=n.length;o<a;++o)i[o]=n.charCodeAt(o);return String.fromCharCode.apply(null,new Uint16Array(i.buffer))}return n}(r,void 0!==i&&i)).indexOf("\n",10)+1,l=a.substring(s)+(o?"//# sourceMappingURL="+o:""),c=new Blob([l],{type:"application/javascript"}),URL.createObjectURL(c)),new Worker(tg,t)}),tv=Object.getOwnPropertySymbols,t$=Object.prototype.hasOwnProperty,tb=Object.prototype.propertyIsEnumerable,tC=(e,t)=>{var r={};for(var n in e)t$.call(e,n)&&0>t.indexOf(n)&&(r[n]=e[n]);if(null!=e&&tv)for(var n of tv(e))0>t.indexOf(n)&&tb.call(e,n)&&(r[n]=e[n]);return r},tI=(e,t,r)=>new Promise((n,i)=>{var o=e=>{try{s(r.next(e))}catch(t){i(t)}},a=e=>{try{s(r.throw(e))}catch(t){i(t)}},s=e=>e.done?n(e.value):Promise.resolve(e.value).then(o,a);s((r=r.apply(e,t)).next())});class tS{constructor(e){this.pendingCanvasMutations=new Map,this.rafStamps={latestId:0,invokeId:null},this.frozen=!1,this.locked=!1,this.processMutation=(e,t)=>{let r=this.rafStamps.invokeId&&this.rafStamps.latestId!==this.rafStamps.invokeId;(r||!this.rafStamps.invokeId)&&(this.rafStamps.invokeId=this.rafStamps.latestId),this.pendingCanvasMutations.has(e)||this.pendingCanvasMutations.set(e,[]),this.pendingCanvasMutations.get(e).push(t)};let{sampling:t="all",win:r,blockClass:n,blockSelector:i,recordCanvas:o,dataURLOptions:a}=e;this.mutationCb=e.mutationCb,this.mirror=e.mirror,o&&"all"===t&&this.initCanvasMutationObserver(r,n,i),o&&"number"==typeof t&&this.initCanvasFPSObserver(t,r,n,i,{dataURLOptions:a})}reset(){this.pendingCanvasMutations.clear(),this.resetObservers&&this.resetObservers()}freeze(){this.frozen=!0}unfreeze(){this.frozen=!1}lock(){this.locked=!0}unlock(){this.locked=!1}initCanvasFPSObserver(e,t,r,n,i){let o=tp(t,r,n),a=new Map,s=new ty;s.onmessage=e=>{let{id:t}=e.data;if(a.set(t,!1),!("base64"in e.data))return;let{base64:r,type:n,width:i,height:o}=e.data;this.mutationCb({id:t,type:eS["2D"],commands:[{property:"clearRect",args:[0,0,i,o]},{property:"drawImage",args:[{rr_type:"ImageBitmap",args:[{rr_type:"Blob",data:[{rr_type:"ArrayBuffer",base64:r}],type:n}]},0,0]}]})};let l=1e3/e,c=0,u,d=()=>{let e=[];return t.document.querySelectorAll("canvas").forEach(t=>{J(t,r,n,!0)||e.push(t)}),e},h=e=>{if(c&&e-c<l){u=requestAnimationFrame(h);return}c=e,d().forEach(e=>tI(this,null,function*(){var t;let r=this.mirror.getId(e);if(a.get(r))return;if(a.set(r,!0),["webgl","webgl2"].includes(e.__context)){let n=e.getContext(e.__context);(null==(t=null==n?void 0:n.getContextAttributes())?void 0:t.preserveDrawingBuffer)===!1&&(null==n||n.clear(n.COLOR_BUFFER_BIT))}let o=yield createImageBitmap(e);s.postMessage({id:r,bitmap:o,width:e.width,height:e.height,dataURLOptions:i.dataURLOptions},[o])})),u=requestAnimationFrame(h)};u=requestAnimationFrame(h),this.resetObservers=()=>{o(),cancelAnimationFrame(u)}}initCanvasMutationObserver(e,t,r){this.startRAFTimestamping(),this.startPendingCanvasMutationFlusher();let n=tp(e,t,r),i=function e(t,r,n,i){let o=[],a=Object.getOwnPropertyNames(r.CanvasRenderingContext2D.prototype);for(let s of a)try{if("function"!=typeof r.CanvasRenderingContext2D.prototype[s])continue;let l=H(r.CanvasRenderingContext2D.prototype,s,function(e){return function(...o){return J(this.canvas,n,i,!0)||setTimeout(()=>{let e=td([...o],r,this);t(this.canvas,{type:eS["2D"],property:s,args:e})},0),e.apply(this,o)}});o.push(l)}catch(c){let u=X(r.CanvasRenderingContext2D.prototype,s,{set(e){t(this.canvas,{type:eS["2D"],property:s,args:[e],setter:!0})}});o.push(u)}return()=>{o.forEach(e=>e())}}(this.processMutation.bind(this),e,t,r),o=function e(t,r,n,i,o){let a=[];return a.push(...tf(r.WebGLRenderingContext.prototype,eS.WebGL,t,n,i,o,r)),void 0!==r.WebGL2RenderingContext&&a.push(...tf(r.WebGL2RenderingContext.prototype,eS.WebGL2,t,n,i,o,r)),()=>{a.forEach(e=>e())}}(this.processMutation.bind(this),e,t,r,this.mirror);this.resetObservers=()=>{n(),i(),o()}}startPendingCanvasMutationFlusher(){requestAnimationFrame(()=>this.flushPendingCanvasMutations())}startRAFTimestamping(){let e=t=>{this.rafStamps.latestId=t,requestAnimationFrame(e)};requestAnimationFrame(e)}flushPendingCanvasMutations(){this.pendingCanvasMutations.forEach((e,t)=>{let r=this.mirror.getId(t);this.flushPendingCanvasMutationFor(t,r)}),requestAnimationFrame(()=>this.flushPendingCanvasMutations())}flushPendingCanvasMutationFor(e,t){if(this.frozen||this.locked)return;let r=this.pendingCanvasMutations.get(e);if(!r||-1===t)return;let n=r.map(e=>{let t=tC(e,["type"]);return t}),{type:i}=r[0];this.mutationCb({id:t,type:i,commands:n}),this.pendingCanvasMutations.delete(e)}}class tw{constructor(e){this.trackedLinkElements=new WeakSet,this.styleMirror=new eh,this.mutationCb=e.mutationCb,this.adoptedStyleSheetCb=e.adoptedStyleSheetCb}attachLinkElement(e,t){"_cssText"in t.attributes&&this.mutationCb({adds:[],removes:[],texts:[],attributes:[{id:t.id,attributes:t.attributes}]}),this.trackLinkElement(e)}trackLinkElement(e){this.trackedLinkElements.has(e)||(this.trackedLinkElements.add(e),this.trackStylesheetInLinkElement(e))}adoptStyleSheets(e,t){if(0===e.length)return;let r={id:t,styleIds:[]},n=[];for(let i of e){let a;if(this.styleMirror.has(i))a=this.styleMirror.getId(i);else{a=this.styleMirror.add(i);let s=Array.from(i.rules||CSSRule);n.push({styleId:a,rules:s.map((e,t)=>({rule:o(e),index:t}))})}r.styleIds.push(a)}n.length>0&&(r.styles=n),this.adoptedStyleSheetCb(r)}reset(){this.styleMirror.reset(),this.trackedLinkElements=new WeakSet}trackStylesheetInLinkElement(e){}}var tN=Object.defineProperty,tE=Object.defineProperties,t_=Object.getOwnPropertyDescriptors,tT=Object.getOwnPropertySymbols,tM=Object.prototype.hasOwnProperty,tR=Object.prototype.propertyIsEnumerable,tD=(e,t,r)=>t in e?tN(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r,tA=(e,t)=>{for(var r in t||(t={}))tM.call(t,r)&&tD(e,r,t[r]);if(tT)for(var r of tT(t))tR.call(t,r)&&tD(e,r,t[r]);return e},tx=(e,t)=>tE(e,t_(t));function tk(e){return tx(tA({},e),{timestamp:Date.now()})}let tO,tL,t0,t8=!1,tF=y();function tP(e={}){let{emit:t,checkoutEveryNms:r,checkoutEveryNth:n,blockClass:i="rr-block",blockSelector:o=null,ignoreClass:a="rr-ignore",maskTextClass:s="rr-mask",maskTextSelector:l=null,inlineStylesheet:c=!0,maskAllInputs:u,maskInputOptions:d,slimDOMOptions:h,maskInputFn:p,maskTextFn:f,hooks:m,packFn:y,sampling:$={},dataURLOptions:b={},mousemoveWait:C,recordCanvas:I=!1,recordCrossOriginIframes:S=!1,userTriggeredOnInput:w=!1,collectFonts:N=!1,inlineImages:E=!1,plugins:_,keepIframeSrcFn:T=()=>!1,ignoreCSSAttributes:M=new Set([])}=e,R=!S||window.parent===window,D=!1;if(!R)try{window.parent.document,D=!1}catch(A){D=!0}if(R&&!t)throw Error("emit function is required");void 0!==C&&void 0===$.mousemove&&($.mousemove=C),tF.reset();let x=!0===u?{color:!0,date:!0,"datetime-local":!0,email:!0,month:!0,number:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0,textarea:!0,select:!0,password:!0}:void 0!==d?d:{password:!0},k=!0===h||"all"===h?{script:!0,comment:!0,headFavicon:!0,headWhitespace:!0,headMetaSocial:!0,headMetaRobots:!0,headMetaHttpEquiv:!0,headMetaVerification:!0,headMetaAuthorship:"all"===h,headMetaDescKeywords:"all"===h}:h||{};er();let L,F=0,P=e=>{for(let t of _||[])t.eventProcessor&&(e=t.eventProcessor(e));return y&&(e=y(e)),e};tO=(e,i)=>{var o;if((null==(o=e3[0])?void 0:o.isFrozen())&&e.type!==eb.FullSnapshot&&!(e.type===eb.IncrementalSnapshot&&e.data.source===eC.Mutation)&&e3.forEach(e=>e.unfreeze()),R)null==t||t(P(e),i);else if(D){let a={type:"reweby",event:P(e),isCheckout:i};window.parent.postMessage(a,"*")}if(e.type===eb.FullSnapshot)L=e,F=0;else if(e.type===eb.IncrementalSnapshot){if(e.data.source===eC.Mutation&&e.data.isAttachIframe)return;F++;let s=n&&F>=n,l=r&&e.timestamp-L.timestamp>r;(s||l)&&tL(!0)}};let G=e=>{tO(tk({type:eb.IncrementalSnapshot,data:tA({source:eC.Mutation},e)}))},V=e=>tO(tk({type:eb.IncrementalSnapshot,data:tA({source:eC.Scroll},e)})),B=e=>tO(tk({type:eb.IncrementalSnapshot,data:tA({source:eC.CanvasMutation},e)})),W=e=>tO(tk({type:eb.IncrementalSnapshot,data:tA({source:eC.AdoptedStyleSheet},e)})),Y=new tw({mutationCb:G,adoptedStyleSheetCb:W}),U=new eK({mirror:tF,mutationCb:G,stylesheetManager:Y,recordCrossOriginIframes:S,wrappedEmit:tO});for(let Q of _||[])Q.getMirror&&Q.getMirror({nodeMirror:tF,crossOriginIframeMirror:U.crossOriginIframeMirror,crossOriginIframeStyleMirror:U.crossOriginIframeStyleMirror});t0=new tS({recordCanvas:I,mutationCb:B,win:window,blockClass:i,blockSelector:o,mirror:tF,sampling:$.canvas,dataURLOptions:b});let q=new tn({mutationCb:G,scrollCb:V,bypassOptions:{blockClass:i,blockSelector:o,maskTextClass:s,maskTextSelector:l,inlineStylesheet:c,maskInputOptions:x,dataURLOptions:b,maskTextFn:f,maskInputFn:p,recordCanvas:I,inlineImages:E,sampling:$,slimDOMOptions:k,iframeManager:U,stylesheetManager:Y,canvasManager:t0,keepIframeSrcFn:T},mirror:tF});tL=(e=!1)=>{var t,r,n,a,u,d,h,p,m,y,v,$,C,S,w,N,_,M,R,D,A,L,F,P,G,V,B,W,Z,z,X,H;tO(tk({type:eb.Meta,data:{href:window.location.href,width:j(),height:K()}}),e),Y.reset(),e3.forEach(e=>e.lock());let J=(h=document,v=void 0===(y=(m=p={mirror:tF,blockClass:i,blockSelector:o,maskTextClass:s,maskTextSelector:l,inlineStylesheet:c,maskAllInputs:x,maskTextFn:f,slimDOM:k,dataURLOptions:b,recordCanvas:I,inlineImages:E,onSerialize(e){eo(e,tF)&&U.addIframe(e),ea(e,tF)&&Y.trackLinkElement(e),el(e)&&q.addShadowRoot(e.shadowRoot,document)},onIframeLoad(e,t){U.attachIframe(e,t),q.observeAttachShadow(e)},onStylesheetLoad(e,t){Y.attachLinkElement(e,t)},keepIframeSrcFn:T}).mirror)?new g:y,$=m.blockClass,C=m.blockSelector,S=m.maskTextClass,w=m.maskTextSelector,N=m.inlineStylesheet,_=m.inlineImages,M=m.recordCanvas,D=void 0!==(R=m.maskAllInputs)&&R,A=m.maskTextFn,L=m.maskInputFn,P=void 0!==(F=m.slimDOM)&&F,G=m.dataURLOptions,V=m.preserveWhiteSpace,B=m.onSerialize,W=m.onIframeLoad,Z=m.iframeLoadTimeout,z=m.onStylesheetLoad,X=m.stylesheetLoadTimeout,O(h,{doc:h,mirror:v,blockClass:void 0===$?"rr-block":$,blockSelector:void 0===C?null:C,maskTextClass:void 0===S?"rr-mask":S,maskTextSelector:void 0===w?null:w,skipChild:!1,inlineStylesheet:void 0===N||N,maskInputOptions:!0===D?{color:!0,date:!0,"datetime-local":!0,email:!0,month:!0,number:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0,textarea:!0,select:!0,password:!0}:!1===D?{password:!0}:D,maskTextFn:A,maskInputFn:L,slimDOMOptions:!0===P||"all"===P?{script:!0,comment:!0,headFavicon:!0,headWhitespace:!0,headMetaDescKeywords:"all"===P,headMetaSocial:!0,headMetaRobots:!0,headMetaHttpEquiv:!0,headMetaAuthorship:!0,headMetaVerification:!0}:!1===P?{}:P,dataURLOptions:G,inlineImages:void 0!==_&&_,recordCanvas:void 0!==M&&M,preserveWhiteSpace:V,onSerialize:B,onIframeLoad:W,iframeLoadTimeout:Z,onStylesheetLoad:z,stylesheetLoadTimeout:X,keepIframeSrcFn:void 0===(H=m.keepIframeSrcFn)?function(){return!1}:H,newlyAddedElement:!1}));if(!J)return console.warn("Failed to snapshot the document");tO(tk({type:eb.FullSnapshot,data:{node:J,initialOffset:{left:void 0!==window.pageXOffset?window.pageXOffset:(null==document?void 0:document.documentElement.scrollLeft)||(null==(r=null==(t=null==document?void 0:document.body)?void 0:t.parentElement)?void 0:r.scrollLeft)||(null==(n=null==document?void 0:document.body)?void 0:n.scrollLeft)||0,top:void 0!==window.pageYOffset?window.pageYOffset:(null==document?void 0:document.documentElement.scrollTop)||(null==(u=null==(a=null==document?void 0:document.body)?void 0:a.parentElement)?void 0:u.scrollTop)||(null==(d=null==document?void 0:document.body)?void 0:d.scrollTop)||0}}})),e3.forEach(e=>e.unlock()),document.adoptedStyleSheets&&document.adoptedStyleSheets.length>0&&Y.adoptStyleSheets(document.adoptedStyleSheets,tF.getId(document))};try{let ee=[];ee.push(Z("DOMContentLoaded",()=>{tO(tk({type:eb.DomContentLoaded,data:{}}))}));let en=e=>{var t;return function e(t,r={}){let n=t.doc.defaultView;if(!n)return()=>{};!function e(t,r){let{mutationCb:n,mousemoveCb:i,mouseInteractionCb:o,scrollCb:a,viewportResizeCb:s,inputCb:l,mediaInteractionCb:c,styleSheetRuleCb:u,styleDeclarationCb:d,canvasMutationCb:h,fontCb:p,selectionCb:f}=t;t.mutationCb=(...e)=>{r.mutation&&r.mutation(...e),n(...e)},t.mousemoveCb=(...e)=>{r.mousemove&&r.mousemove(...e),i(...e)},t.mouseInteractionCb=(...e)=>{r.mouseInteraction&&r.mouseInteraction(...e),o(...e)},t.scrollCb=(...e)=>{r.scroll&&r.scroll(...e),a(...e)},t.viewportResizeCb=(...e)=>{r.viewportResize&&r.viewportResize(...e),s(...e)},t.inputCb=(...e)=>{r.input&&r.input(...e),l(...e)},t.mediaInteractionCb=(...e)=>{r.mediaInteaction&&r.mediaInteaction(...e),c(...e)},t.styleSheetRuleCb=(...e)=>{r.styleSheetRule&&r.styleSheetRule(...e),u(...e)},t.styleDeclarationCb=(...e)=>{r.styleDeclaration&&r.styleDeclaration(...e),d(...e)},t.canvasMutationCb=(...e)=>{r.canvasMutation&&r.canvasMutation(...e),h(...e)},t.fontCb=(...e)=>{r.font&&r.font(...e),p(...e)},t.selectionCb=(...e)=>{r.selection&&r.selection(...e),f(...e)}}(t,r);let i=eZ(t,t.doc),o=function e({mousemoveCb:t,sampling:r,doc:n,mirror:i}){if(!1===r.mousemove)return()=>{};let o="number"==typeof r.mousemove?r.mousemove:50,a="number"==typeof r.mousemoveCallback?r.mousemoveCallback:500,s=[],l,c=z(e=>{let r=Date.now()-l;t(s.map(e=>(e.timeOffset-=r,e)),e),s=[],l=null},a),u=z(e=>{let t=eY(e),{clientX:r,clientY:n}=et(e)?e.changedTouches[0]:e;l||(l=Date.now()),s.push({x:r,y:n,id:i.getId(t),timeOffset:Date.now()-l}),c("undefined"!=typeof DragEvent&&e instanceof DragEvent?eC.Drag:e instanceof MouseEvent?eC.MouseMove:eC.TouchMove)},o,{trailing:!1}),d=[Z("mousemove",u,n),Z("touchmove",u,n),Z("drag",u,n)];return()=>{d.forEach(e=>e())}}(t),a=function e({mouseInteractionCb:t,doc:r,mirror:n,blockClass:i,blockSelector:o,sampling:a}){if(!1===a.mouseInteraction)return()=>{};let s=!0===a.mouseInteraction||void 0===a.mouseInteraction?{}:a.mouseInteraction,l=[],c=e=>r=>{let a=eY(r);if(J(a,i,o,!0))return;let s=et(r)?r.changedTouches[0]:r;if(!s)return;let l=n.getId(a),{clientX:c,clientY:u}=s;t({type:eI[e],id:l,x:c,y:u})};return Object.keys(eI).filter(e=>Number.isNaN(Number(e))&&!e.endsWith("_Departed")&&!1!==s[e]).forEach(e=>{let t=e.toLowerCase(),n=c(e);l.push(Z(t,n,r))}),()=>{l.forEach(e=>e())}}(t),s=eU(t),l=function e({viewportResizeCb:t}){let r=-1,n=-1,i=z(()=>{let e=K(),i=j();(r!==e||n!==i)&&(t({width:Number(i),height:Number(e)}),r=e,n=i)},200);return Z("resize",i,window)}(t),c=function e({inputCb:t,doc:r,mirror:n,blockClass:i,blockSelector:o,ignoreClass:a,maskInputOptions:s,maskInputFn:l,sampling:c,userTriggeredOnInput:u}){function d(e){let t=eY(e),n=e.isTrusted;if(t&&"OPTION"===t.tagName&&(t=t.parentElement),!t||!t.tagName||0>eX.indexOf(t.tagName)||J(t,i,o,!0))return;let c=t.type;if(t.classList.contains(a))return;let d=t.value,p=!1;"radio"===c||"checkbox"===c?p=t.checked:(s[t.tagName.toLowerCase()]||s[c])&&(d=v({maskInputOptions:s,tagName:t.tagName,type:c,value:d,maskInputFn:l})),h(t,ez({text:d,isChecked:p,userTriggered:n},u));let f=t.name;"radio"===c&&f&&p&&r.querySelectorAll(`input[type="radio"][name="${f}"]`).forEach(e=>{e!==t&&h(e,ez({text:e.value,isChecked:!p,userTriggered:!1},u))})}function h(e,r){let i=eH.get(e);if(!i||i.text!==r.text||i.isChecked!==r.isChecked){eH.set(e,r);let o=n.getId(e);t(e1(eP({},r),{id:o}))}}let p="last"===c.input?["change"]:["input","change"],f=p.map(e=>Z(e,d,r)),m=r.defaultView;if(!m)return()=>{f.forEach(e=>e())};let g=m.Object.getOwnPropertyDescriptor(m.HTMLInputElement.prototype,"value"),y=[[m.HTMLInputElement.prototype,"value"],[m.HTMLInputElement.prototype,"checked"],[m.HTMLSelectElement.prototype,"value"],[m.HTMLTextAreaElement.prototype,"value"],[m.HTMLSelectElement.prototype,"selectedIndex"],[m.HTMLOptionElement.prototype,"selected"]];return g&&g.set&&f.push(...y.map(e=>X(e[0],e[1],{set(){d({target:this})}},!1,m))),()=>{f.forEach(e=>e())}}(t),u=function e({mediaInteractionCb:t,blockClass:r,blockSelector:n,mirror:i,sampling:o}){let a=e=>z(o=>{let a=eY(o);if(!a||J(a,r,n,!0))return;let{currentTime:s,volume:l,muted:c,playbackRate:u}=a;t({type:e,id:i.getId(a),currentTime:s,volume:l,muted:c,playbackRate:u})},o.media||500),s=[Z("play",a(ew.Play)),Z("pause",a(ew.Pause)),Z("seeked",a(ew.Seeked)),Z("volumechange",a(ew.VolumeChange)),Z("ratechange",a(ew.RateChange))];return()=>{s.forEach(e=>e())}}(t),d=function e({styleSheetRuleCb:t,mirror:r,stylesheetManager:n},{win:i}){let o=i.CSSStyleSheet.prototype.insertRule;i.CSSStyleSheet.prototype.insertRule=function(e,i){let{id:a,styleId:s}=e7(this,r,n.styleMirror);return(a&&-1!==a||s&&-1!==s)&&t({id:a,styleId:s,adds:[{rule:e,index:i}]}),o.apply(this,[e,i])};let a=i.CSSStyleSheet.prototype.deleteRule;i.CSSStyleSheet.prototype.deleteRule=function(e){let{id:i,styleId:o}=e7(this,r,n.styleMirror);return(i&&-1!==i||o&&-1!==o)&&t({id:i,styleId:o,removes:[{index:e}]}),a.apply(this,[e])};let s;i.CSSStyleSheet.prototype.replace&&(s=i.CSSStyleSheet.prototype.replace,i.CSSStyleSheet.prototype.replace=function(e){let{id:i,styleId:o}=e7(this,r,n.styleMirror);return(i&&-1!==i||o&&-1!==o)&&t({id:i,styleId:o,replace:e}),s.apply(this,[e])});let l;i.CSSStyleSheet.prototype.replaceSync&&(l=i.CSSStyleSheet.prototype.replaceSync,i.CSSStyleSheet.prototype.replaceSync=function(e){let{id:i,styleId:o}=e7(this,r,n.styleMirror);return(i&&-1!==i||o&&-1!==o)&&t({id:i,styleId:o,replaceSync:e}),l.apply(this,[e])});let c={};eG?c.CSSGroupingRule=i.CSSGroupingRule:(eV&&(c.CSSMediaRule=i.CSSMediaRule),eW&&(c.CSSConditionRule=i.CSSConditionRule),eB&&(c.CSSSupportsRule=i.CSSSupportsRule));let u={};return Object.entries(c).forEach(([e,i])=>{u[e]={insertRule:i.prototype.insertRule,deleteRule:i.prototype.deleteRule},i.prototype.insertRule=function(i,o){let{id:a,styleId:s}=e7(this.parentStyleSheet,r,n.styleMirror);return(a&&-1!==a||s&&-1!==s)&&t({id:a,styleId:s,adds:[{rule:i,index:[...e6(this),o||0]}]}),u[e].insertRule.apply(this,[i,o])},i.prototype.deleteRule=function(i){let{id:o,styleId:a}=e7(this.parentStyleSheet,r,n.styleMirror);return(o&&-1!==o||a&&-1!==a)&&t({id:o,styleId:a,removes:[{index:[...e6(this),i]}]}),u[e].deleteRule.apply(this,[i])}}),()=>{i.CSSStyleSheet.prototype.insertRule=o,i.CSSStyleSheet.prototype.deleteRule=a,s&&(i.CSSStyleSheet.prototype.replace=s),l&&(i.CSSStyleSheet.prototype.replaceSync=l),Object.entries(c).forEach(([e,t])=>{t.prototype.insertRule=u[e].insertRule,t.prototype.deleteRule=u[e].deleteRule})}}(t,{win:n}),h=e2(t,t.doc),p=function e({styleDeclarationCb:t,mirror:r,ignoreCSSAttributes:n,stylesheetManager:i},{win:o}){let a=o.CSSStyleDeclaration.prototype.setProperty;o.CSSStyleDeclaration.prototype.setProperty=function(e,o,s){var l;if(n.has(e))return a.apply(this,[e,o,s]);let{id:c,styleId:u}=e7(null==(l=this.parentRule)?void 0:l.parentStyleSheet,r,i.styleMirror);return(c&&-1!==c||u&&-1!==u)&&t({id:c,styleId:u,set:{property:e,value:o,priority:s},index:e6(this.parentRule)}),a.apply(this,[e,o,s])};let s=o.CSSStyleDeclaration.prototype.removeProperty;return o.CSSStyleDeclaration.prototype.removeProperty=function(e){var o;if(n.has(e))return s.apply(this,[e]);let{id:a,styleId:l}=e7(null==(o=this.parentRule)?void 0:o.parentStyleSheet,r,i.styleMirror);return(a&&-1!==a||l&&-1!==l)&&t({id:a,styleId:l,remove:{property:e},index:e6(this.parentRule)}),s.apply(this,[e])},()=>{o.CSSStyleDeclaration.prototype.setProperty=a,o.CSSStyleDeclaration.prototype.removeProperty=s}}(t,{win:n}),f=t.collectFonts?function e({fontCb:t,doc:r}){let n=r.defaultView;if(!n)return()=>{};let i=[],o=new WeakMap,a=n.FontFace;n.FontFace=function e(t,r,n){let i=new a(t,r,n);return o.set(i,{family:t,buffer:"string"!=typeof r,descriptors:n,fontSource:"string"==typeof r?r:JSON.stringify(Array.from(new Uint8Array(r)))}),i};let s=H(r.fonts,"add",function(e){return function(r){return setTimeout(()=>{let e=o.get(r);e&&(t(e),o.delete(r))},0),e.apply(this,[r])}});return i.push(()=>{n.FontFace=a}),i.push(s),()=>{i.forEach(e=>e())}}(t):()=>{},m=function e(t){let{doc:r,mirror:n,blockClass:i,blockSelector:o,selectionCb:a}=t,s=!0,l=()=>{let e=r.getSelection();if(!e||s&&(null==e?void 0:e.isCollapsed))return;s=e.isCollapsed||!1;let t=[],l=e.rangeCount||0;for(let c=0;c<l;c++){let u=e.getRangeAt(c),{startContainer:d,startOffset:h,endContainer:p,endOffset:f}=u,m=J(d,i,o,!0)||J(p,i,o,!0);m||t.push({start:n.getId(d),startOffset:h,end:n.getId(p),endOffset:f})}a({ranges:t})};return l(),Z("selectionchange",l)}(t),g=[];for(let y of t.plugins)g.push(y.observer(y.callback,n,y.options));return()=>{e3.forEach(e=>e.reset()),i.disconnect(),o(),a(),s(),l(),c(),u(),d(),h(),p(),f(),m(),g.forEach(e=>e())}}({mutationCb:G,mousemoveCb:(e,t)=>tO(tk({type:eb.IncrementalSnapshot,data:{source:t,positions:e}})),mouseInteractionCb:e=>tO(tk({type:eb.IncrementalSnapshot,data:tA({source:eC.MouseInteraction},e)})),scrollCb:V,viewportResizeCb:e=>tO(tk({type:eb.IncrementalSnapshot,data:tA({source:eC.ViewportResize},e)})),inputCb:e=>tO(tk({type:eb.IncrementalSnapshot,data:tA({source:eC.Input},e)})),mediaInteractionCb:e=>tO(tk({type:eb.IncrementalSnapshot,data:tA({source:eC.MediaInteraction},e)})),styleSheetRuleCb:e=>tO(tk({type:eb.IncrementalSnapshot,data:tA({source:eC.StyleSheetRule},e)})),styleDeclarationCb:e=>tO(tk({type:eb.IncrementalSnapshot,data:tA({source:eC.StyleDeclaration},e)})),canvasMutationCb:B,fontCb:e=>tO(tk({type:eb.IncrementalSnapshot,data:tA({source:eC.Font},e)})),selectionCb(e){tO(tk({type:eb.IncrementalSnapshot,data:tA({source:eC.Selection},e)}))},blockClass:i,ignoreClass:a,maskTextClass:s,maskTextSelector:l,maskInputOptions:x,inlineStylesheet:c,sampling:$,recordCanvas:I,inlineImages:E,userTriggeredOnInput:w,collectFonts:N,doc:e,maskInputFn:p,maskTextFn:f,keepIframeSrcFn:T,blockSelector:o,slimDOMOptions:k,dataURLOptions:b,mirror:tF,iframeManager:U,stylesheetManager:Y,shadowDomManager:q,canvasManager:t0,ignoreCSSAttributes:M,plugins:(null==(t=null==_?void 0:_.filter(e=>e.observer))?void 0:t.map(e=>({observer:e.observer,options:e.options,callback:t=>tO(tk({type:eb.Plugin,data:{plugin:e.name,payload:t}}))})))||[]},m)};U.addLoadListener(e=>{ee.push(en(e.contentDocument))});let ei=()=>{tL(),ee.push(en(document)),t8=!0};return"interactive"===document.readyState||"complete"===document.readyState?ei():ee.push(Z("load",()=>{tO(tk({type:eb.Load,data:{}})),ei()},window)),()=>{ee.forEach(e=>e()),t8=!1}}catch(es){console.warn(es)}}tP.addCustomEvent=(e,t)=>{if(!t8)throw Error("please add custom event after start recording");tO(tk({type:eb.Custom,data:{tag:e,payload:t}}))},tP.freezePage=()=>{e3.forEach(e=>e.freeze())},tP.takeFullSnapshot=e=>{if(!t8)throw Error("please take full snapshot after start recording");tL(e)},tP.mirror=tF,(a=p||(p={}))[a.Document=0]="Document",a[a.DocumentType=1]="DocumentType",a[a.Element=2]="Element",a[a.Text=3]="Text",a[a.CDATA=4]="CDATA",a[a.Comment=5]="Comment";var t1=function(){function e(){this.idNodeMap=new Map,this.nodeMetaMap=new WeakMap}return e.prototype.getId=function(e){if(!e)return -1;var t,r=null===(t=this.getMeta(e))||void 0===t?void 0:t.id;return null!=r?r:-1},e.prototype.getNode=function(e){return this.idNodeMap.get(e)||null},e.prototype.getIds=function(){return Array.from(this.idNodeMap.keys())},e.prototype.getMeta=function(e){return this.nodeMetaMap.get(e)||null},e.prototype.removeNodeFromMap=function(e){var t=this,r=this.getId(e);this.idNodeMap.delete(r),e.childNodes&&e.childNodes.forEach(function(e){return t.removeNodeFromMap(e)})},e.prototype.has=function(e){return this.idNodeMap.has(e)},e.prototype.hasNode=function(e){return this.nodeMetaMap.has(e)},e.prototype.add=function(e,t){var r=t.id;this.idNodeMap.set(r,e),this.nodeMetaMap.set(e,t)},e.prototype.replace=function(e,t){var r=this.getNode(e);if(r){var n=this.nodeMetaMap.get(r);n&&this.nodeMetaMap.set(t,n)}this.idNodeMap.set(e,t)},e.prototype.reset=function(){this.idNodeMap=new Map,this.nodeMetaMap=new WeakMap},e}();function t3(e){let t=[];for(let r in e){let n=e[r];if("string"!=typeof n)continue;let i=tY(r);t.push(`${i}: ${n};`)}return t.join(" ")}let tG=/-([a-z])/g,tV=/^--[a-zA-Z0-9-]+$/,tB=e=>tV.test(e)?e:e.replace(tG,(e,t)=>t?t.toUpperCase():""),tW=/\B([A-Z])/g,tY=e=>e.replace(tW,"-$1").toLowerCase();class tZ{constructor(...e){this.childNodes=[],this.parentElement=null,this.parentNode=null,this.ELEMENT_NODE=f.ELEMENT_NODE,this.TEXT_NODE=f.TEXT_NODE}get firstChild(){return this.childNodes[0]||null}get lastChild(){return this.childNodes[this.childNodes.length-1]||null}get nextSibling(){let e=this.parentNode;if(!e)return null;let t=e.childNodes,r=t.indexOf(this);return t[r+1]||null}contains(e){if(e===this)return!0;for(let t of this.childNodes)if(t.contains(e))return!0;return!1}appendChild(e){throw Error("RRDomException: Failed to execute 'appendChild' on 'RRNode': This RRNode type does not support this method.")}insertBefore(e,t){throw Error("RRDomException: Failed to execute 'insertBefore' on 'RRNode': This RRNode type does not support this method.")}removeChild(e){throw Error("RRDomException: Failed to execute 'removeChild' on 'RRNode': This RRNode type does not support this method.")}toString(){return"RRNode"}}function tU(e){return class t extends e{constructor(){super(...arguments),this.nodeType=f.DOCUMENT_NODE,this.nodeName="#document",this.compatMode="CSS1Compat",this.RRNodeType=p.Document,this.textContent=null}get documentElement(){return this.childNodes.find(e=>e.RRNodeType===p.Element&&"HTML"===e.tagName)||null}get body(){var e;return(null===(e=this.documentElement)||void 0===e?void 0:e.childNodes.find(e=>e.RRNodeType===p.Element&&"BODY"===e.tagName))||null}get head(){var e;return(null===(e=this.documentElement)||void 0===e?void 0:e.childNodes.find(e=>e.RRNodeType===p.Element&&"HEAD"===e.tagName))||null}get implementation(){return this}get firstElementChild(){return this.documentElement}appendChild(e){let t=e.RRNodeType;if((t===p.Element||t===p.DocumentType)&&this.childNodes.some(e=>e.RRNodeType===t))throw Error(`RRDomException: Failed to execute 'appendChild' on 'RRNode': Only one ${t===p.Element?"RRElement":"RRDoctype"} on RRDocument allowed.`);return e.parentElement=null,e.parentNode=this,this.childNodes.push(e),e}insertBefore(e,t){let r=e.RRNodeType;if((r===p.Element||r===p.DocumentType)&&this.childNodes.some(e=>e.RRNodeType===r))throw Error(`RRDomException: Failed to execute 'insertBefore' on 'RRNode': Only one ${r===p.Element?"RRElement":"RRDoctype"} on RRDocument allowed.`);if(null===t)return this.appendChild(e);let n=this.childNodes.indexOf(t);if(-1==n)throw Error("Failed to execute 'insertBefore' on 'RRNode': The RRNode before which the new node is to be inserted is not a child of this RRNode.");return this.childNodes.splice(n,0,e),e.parentElement=null,e.parentNode=this,e}removeChild(e){let t=this.childNodes.indexOf(e);if(-1===t)throw Error("Failed to execute 'removeChild' on 'RRDocument': The RRNode to be removed is not a child of this RRNode.");return this.childNodes.splice(t,1),e.parentElement=null,e.parentNode=null,e}open(){this.childNodes=[]}close(){}write(e){let t;if('<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "">'===e?t="-//W3C//DTD XHTML 1.0 Transitional//EN":'<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN" "">'===e&&(t="-//W3C//DTD HTML 4.0 Transitional//EN"),t){let r=this.createDocumentType("html",t,"");this.open(),this.appendChild(r)}}createDocument(e,r,n){return new t}createDocumentType(e,t,r){let n=new(tz(tZ))(e,t,r);return n.ownerDocument=this,n}createElement(e){let t=new(tX(tZ))(e);return t.ownerDocument=this,t}createElementNS(e,t){return this.createElement(t)}createTextNode(e){let t=new(t6(tZ))(e);return t.ownerDocument=this,t}createComment(e){let t=new(t7(tZ))(e);return t.ownerDocument=this,t}createCDATASection(e){let t=new(t2(tZ))(e);return t.ownerDocument=this,t}toString(){return"RRDocument"}}}function tz(e){return class t extends e{constructor(e,t,r){super(),this.nodeType=f.DOCUMENT_TYPE_NODE,this.RRNodeType=p.DocumentType,this.textContent=null,this.name=e,this.publicId=t,this.systemId=r,this.nodeName=e}toString(){return"RRDocumentType"}}}function tX(e){return class t extends e{constructor(e){super(),this.nodeType=f.ELEMENT_NODE,this.RRNodeType=p.Element,this.attributes={},this.shadowRoot=null,this.tagName=e.toUpperCase(),this.nodeName=e.toUpperCase()}get textContent(){let e="";return this.childNodes.forEach(t=>e+=t.textContent),e}set textContent(e){this.childNodes=[this.ownerDocument.createTextNode(e)]}get classList(){return new t4(this.attributes.class,e=>{this.attributes.class=e})}get id(){return this.attributes.id||""}get className(){return this.attributes.class||""}get style(){let e=this.attributes.style?function e(t){let r={},n=/:(.+)/;return t.replace(/\/\*.*?\*\//g,"").split(/;(?![^(]*\))/g).forEach(function(e){if(e){let t=e.split(n);t.length>1&&(r[tB(t[0].trim())]=t[1].trim())}}),r}(this.attributes.style):{},t=/\B([A-Z])/g;return e.setProperty=(r,n,i)=>{if(t.test(r))return;let o=tB(r);n?e[o]=n:delete e[o],"important"===i&&(e[o]+=" !important"),this.attributes.style=t3(e)},e.removeProperty=r=>{if(t.test(r))return"";let n=tB(r),i=e[n]||"";return delete e[n],this.attributes.style=t3(e),i},e}getAttribute(e){return this.attributes[e]||null}setAttribute(e,t){this.attributes[e]=t}setAttributeNS(e,t,r){this.setAttribute(t,r)}removeAttribute(e){delete this.attributes[e]}appendChild(e){return this.childNodes.push(e),e.parentNode=this,e.parentElement=this,e}insertBefore(e,t){if(null===t)return this.appendChild(e);let r=this.childNodes.indexOf(t);if(-1==r)throw Error("Failed to execute 'insertBefore' on 'RRNode': The RRNode before which the new node is to be inserted is not a child of this RRNode.");return this.childNodes.splice(r,0,e),e.parentElement=this,e.parentNode=this,e}removeChild(e){let t=this.childNodes.indexOf(e);if(-1===t)throw Error("Failed to execute 'removeChild' on 'RRElement': The RRNode to be removed is not a child of this RRNode.");return this.childNodes.splice(t,1),e.parentElement=null,e.parentNode=null,e}attachShadow(e){let t=this.ownerDocument.createElement("SHADOWROOT");return this.shadowRoot=t,t}dispatchEvent(e){return!0}toString(){let e="";for(let t in this.attributes)e+=`${t}="${this.attributes[t]}" `;return`${this.tagName} ${e}`}}}function tH(e){return class t extends e{attachShadow(e){throw Error("RRDomException: Failed to execute 'attachShadow' on 'RRElement': This RRElement does not support attachShadow")}play(){this.paused=!1}pause(){this.paused=!0}}}function t6(e){return class t extends e{constructor(e){super(),this.nodeType=f.TEXT_NODE,this.nodeName="#text",this.RRNodeType=p.Text,this.data=e}get textContent(){return this.data}set textContent(e){this.data=e}toString(){return`RRText text=${JSON.stringify(this.data)}`}}}function t7(e){return class t extends e{constructor(e){super(),this.nodeType=f.COMMENT_NODE,this.nodeName="#comment",this.RRNodeType=p.Comment,this.data=e}get textContent(){return this.data}set textContent(e){this.data=e}toString(){return`RRComment text=${JSON.stringify(this.data)}`}}}function t2(e){return class t extends e{constructor(e){super(),this.nodeName="#cdata-section",this.nodeType=f.CDATA_SECTION_NODE,this.RRNodeType=p.CDATA,this.data=e}get textContent(){return this.data}set textContent(e){this.data=e}toString(){return`RRCDATASection data=${JSON.stringify(this.data)}`}}}class t4{constructor(e,t){if(this.classes=[],this.add=(...e)=>{for(let t of e){let r=String(t);this.classes.indexOf(r)>=0||this.classes.push(r)}this.onChange&&this.onChange(this.classes.join(" "))},this.remove=(...e)=>{this.classes=this.classes.filter(t=>-1===e.indexOf(t)),this.onChange&&this.onChange(this.classes.join(" "))},e){let r=e.trim().split(/\s+/);this.classes.push(...r)}this.onChange=t}}(s=f||(f={}))[s.PLACEHOLDER=0]="PLACEHOLDER",s[s.ELEMENT_NODE=1]="ELEMENT_NODE",s[s.ATTRIBUTE_NODE=2]="ATTRIBUTE_NODE",s[s.TEXT_NODE=3]="TEXT_NODE",s[s.CDATA_SECTION_NODE=4]="CDATA_SECTION_NODE",s[s.ENTITY_REFERENCE_NODE=5]="ENTITY_REFERENCE_NODE",s[s.ENTITY_NODE=6]="ENTITY_NODE",s[s.PROCESSING_INSTRUCTION_NODE=7]="PROCESSING_INSTRUCTION_NODE",s[s.COMMENT_NODE=8]="COMMENT_NODE",s[s.DOCUMENT_NODE=9]="DOCUMENT_NODE",s[s.DOCUMENT_TYPE_NODE=10]="DOCUMENT_TYPE_NODE",s[s.DOCUMENT_FRAGMENT_NODE=11]="DOCUMENT_FRAGMENT_NODE";let tK={svg:"http://www.w3.org/2000/svg","xlink:href":"http://www.w3.org/1999/xlink",xmlns:"http://www.w3.org/2000/xmlns/"},t5={altglyph:"altGlyph",altglyphdef:"altGlyphDef",altglyphitem:"altGlyphItem",animatecolor:"animateColor",animatemotion:"animateMotion",animatetransform:"animateTransform",clippath:"clipPath",feblend:"feBlend",fecolormatrix:"feColorMatrix",fecomponenttransfer:"feComponentTransfer",fecomposite:"feComposite",feconvolvematrix:"feConvolveMatrix",fediffuselighting:"feDiffuseLighting",fedisplacementmap:"feDisplacementMap",fedistantlight:"feDistantLight",fedropshadow:"feDropShadow",feflood:"feFlood",fefunca:"feFuncA",fefuncb:"feFuncB",fefuncg:"feFuncG",fefuncr:"feFuncR",fegaussianblur:"feGaussianBlur",feimage:"feImage",femerge:"feMerge",femergenode:"feMergeNode",femorphology:"feMorphology",feoffset:"feOffset",fepointlight:"fePointLight",fespecularlighting:"feSpecularLighting",fespotlight:"feSpotLight",fetile:"feTile",feturbulence:"feTurbulence",foreignobject:"foreignObject",glyphref:"glyphRef",lineargradient:"linearGradient",radialgradient:"radialGradient"};function tj(e,t,r,n){let i=e.childNodes,o=t.childNodes;n=n||t.mirror||t.ownerDocument.mirror,(i.length>0||o.length>0)&&tJ(Array.from(i),o,e,r,n);let a=null,s=null;switch(t.RRNodeType){case p.Document:s=t.scrollData;break;case p.Element:{let l=e,c=t;switch(function e(t,r,n){let i=t.attributes,o=r.attributes;for(let a in o){let s=o[a],l=n.getMeta(r);if(l&&"isSVG"in l&&l.isSVG&&tK[a])t.setAttributeNS(tK[a],a,s);else if("CANVAS"===r.tagName&&"rr_dataURL"===a){let c=document.createElement("img");c.src=s,c.onload=()=>{let e=t.getContext("2d");e&&e.drawImage(c,0,0,c.width,c.height)}}else t.setAttribute(a,s)}for(let{name:u}of Array.from(i))u in o||t.removeAttribute(u);r.scrollLeft&&(t.scrollLeft=r.scrollLeft),r.scrollTop&&(t.scrollTop=r.scrollTop)}(l,c,n),s=c.scrollData,a=c.inputData,c.tagName){case"AUDIO":case"VIDEO":{let u=e,d=c;void 0!==d.paused&&(d.paused?u.pause():u.play()),void 0!==d.muted&&(u.muted=d.muted),void 0!==d.volume&&(u.volume=d.volume),void 0!==d.currentTime&&(u.currentTime=d.currentTime),void 0!==d.playbackRate&&(u.playbackRate=d.playbackRate);break}case"CANVAS":{let h=t;if(null!==h.rr_dataURL){let f=document.createElement("img");f.onload=()=>{let e=l.getContext("2d");e&&e.drawImage(f,0,0,f.width,f.height)},f.src=h.rr_dataURL}h.canvasMutations.forEach(t=>r.applyCanvas(t.event,t.mutation,e))}break;case"STYLE":{let m=l.sheet;m&&t.rules.forEach(e=>r.applyStyleSheetMutation(e,m))}}if(c.shadowRoot){l.shadowRoot||l.attachShadow({mode:"open"});let g=l.shadowRoot.childNodes,y=c.shadowRoot.childNodes;(g.length>0||y.length>0)&&tJ(Array.from(g),y,l.shadowRoot,r,n)}break}case p.Text:case p.Comment:case p.CDATA:e.textContent!==t.data&&(e.textContent=t.data)}if(s&&r.applyScroll(s,!0),a&&r.applyInput(a),"IFRAME"===t.nodeName){let v=e.contentDocument,$=t;if(v){let b=n.getMeta($.contentDocument);b&&r.mirror.add(v,Object.assign({},b)),tj(v,$.contentDocument,r,n)}}}function tJ(e,t,r,n,i){var o;let a=0,s=e.length-1,l=0,c=t.length-1,u=e[a],d=e[s],h=t[l],f=t[c],m,g;for(;a<=s&&l<=c;){let y=n.mirror.getId(u),v=n.mirror.getId(d),$=i.getId(h),b=i.getId(f);if(void 0===u)u=e[++a];else if(void 0===d)d=e[--s];else if(-1!==y&&y===$)tj(u,h,n,i),u=e[++a],h=t[++l];else if(-1!==v&&v===b)tj(d,f,n,i),d=e[--s],f=t[--c];else if(-1!==y&&y===b)r.insertBefore(u,d.nextSibling),tj(u,f,n,i),u=e[++a],f=t[--c];else if(-1!==v&&v===$)r.insertBefore(d,u),tj(d,h,n,i),d=e[--s],h=t[++l];else{if(!m){m={};for(let C=a;C<=s;C++){let I=e[C];I&&n.mirror.hasNode(I)&&(m[n.mirror.getId(I)]=C)}}if(g=m[i.getId(h)]){let S=e[g];r.insertBefore(S,u),tj(S,h,n,i),e[g]=void 0}else{let w=tQ(h,n.mirror,i);"#document"===r.nodeName&&(null===(o=n.mirror.getMeta(w))||void 0===o?void 0:o.type)===p.Element&&r.documentElement&&(r.removeChild(r.documentElement),e[a]=void 0,u=void 0),r.insertBefore(w,u||null),tj(w,h,n,i)}h=t[++l]}}if(a>s){let N=t[c+1],E=null;for(N&&r.childNodes.forEach(e=>{n.mirror.getId(e)===i.getId(N)&&(E=e)});l<=c;++l){let _=tQ(t[l],n.mirror,i);r.insertBefore(_,E),tj(_,t[l],n,i)}}else if(l>c)for(;a<=s;a++){let T=e[a];T&&(r.removeChild(T),n.mirror.removeNodeFromMap(T))}}function tQ(e,t,r){let n=r.getId(e),i=r.getMeta(e),o=null;if(n>-1&&(o=t.getNode(n)),null!==o)return o;switch(e.RRNodeType){case p.Document:o=new Document;break;case p.DocumentType:o=document.implementation.createDocumentType(e.name,e.publicId,e.systemId);break;case p.Element:{let a=e.tagName.toLowerCase();a=t5[a]||a,o=i&&"isSVG"in i&&(null==i?void 0:i.isSVG)?document.createElementNS(tK.svg,a):document.createElement(e.tagName);break}case p.Text:o=document.createTextNode(e.data);break;case p.Comment:o=document.createComment(e.data);break;case p.CDATA:o=document.createCDATASection(e.data)}return i&&t.add(o,Object.assign({},i)),o}class t9 extends tU(tZ){constructor(e){super(),this.UNSERIALIZED_STARTING_ID=-2,this._unserializedId=this.UNSERIALIZED_STARTING_ID,this.mirror=new rc,this.scrollData=null,e&&(this.mirror=e)}get unserializedId(){return this._unserializedId--}createDocument(e,t,r){return new t9}createDocumentType(e,t,r){let n=new tq(e,t,r);return n.ownerDocument=this,n}createElement(e){let t=e.toUpperCase(),r;switch(t){case"AUDIO":case"VIDEO":r=new rt(t);break;case"IFRAME":r=new ri(t,this.mirror);break;case"CANVAS":r=new rr(t);break;case"STYLE":r=new rn(t);break;default:r=new re(t)}return r.ownerDocument=this,r}createComment(e){let t=new ra(e);return t.ownerDocument=this,t}createCDATASection(e){let t=new rs(e);return t.ownerDocument=this,t}createTextNode(e){let t=new ro(e);return t.ownerDocument=this,t}destroyTree(){this.childNodes=[],this.mirror.reset()}open(){super.open(),this._unserializedId=this.UNSERIALIZED_STARTING_ID}}let tq=tz(tZ);class re extends tX(tZ){constructor(){super(...arguments),this.inputData=null,this.scrollData=null}}class rt extends tH(re){}class rr extends re{constructor(){super(...arguments),this.rr_dataURL=null,this.canvasMutations=[]}getContext(){return null}}class rn extends re{constructor(){super(...arguments),this.rules=[]}}class ri extends re{constructor(e,t){super(e),this.contentDocument=new t9,this.contentDocument.mirror=t}}let ro=t6(tZ),ra=t7(tZ),rs=t2(tZ);function rl(e,t,r,n){let i;switch(e.nodeType){case f.DOCUMENT_NODE:n&&"IFRAME"===n.nodeName?i=n.contentDocument:(i=t).compatMode=e.compatMode;break;case f.DOCUMENT_TYPE_NODE:{let o=e;i=t.createDocumentType(o.name,o.publicId,o.systemId);break}case f.ELEMENT_NODE:{var a;let s=e,l=(a=s)instanceof HTMLFormElement?"FORM":a.tagName.toUpperCase();i=t.createElement(l);let c=i;for(let{name:u,value:d}of Array.from(s.attributes))c.attributes[u]=d;s.scrollLeft&&(c.scrollLeft=s.scrollLeft),s.scrollTop&&(c.scrollTop=s.scrollTop);break}case f.TEXT_NODE:i=t.createTextNode(e.textContent||"");break;case f.CDATA_SECTION_NODE:i=t.createCDATASection(e.data);break;case f.COMMENT_NODE:i=t.createComment(e.textContent||"");break;case f.DOCUMENT_FRAGMENT_NODE:i=n.attachShadow({mode:"open"});break;default:return null}let h=r.getMeta(e);return t instanceof t9&&(h||(h=ru(i,t.unserializedId),r.add(e,h)),t.mirror.add(i,Object.assign({},h))),i}class rc{constructor(){this.idNodeMap=new Map,this.nodeMetaMap=new WeakMap}getId(e){var t;if(!e)return -1;let r=null===(t=this.getMeta(e))||void 0===t?void 0:t.id;return null!=r?r:-1}getNode(e){return this.idNodeMap.get(e)||null}getIds(){return Array.from(this.idNodeMap.keys())}getMeta(e){return this.nodeMetaMap.get(e)||null}removeNodeFromMap(e){let t=this.getId(e);this.idNodeMap.delete(t),e.childNodes&&e.childNodes.forEach(e=>this.removeNodeFromMap(e))}has(e){return this.idNodeMap.has(e)}hasNode(e){return this.nodeMetaMap.has(e)}add(e,t){let r=t.id;this.idNodeMap.set(r,e),this.nodeMetaMap.set(e,t)}replace(e,t){let r=this.getNode(e);if(r){let n=this.nodeMetaMap.get(r);n&&this.nodeMetaMap.set(t,n)}this.idNodeMap.set(e,t)}reset(){this.idNodeMap=new Map,this.nodeMetaMap=new WeakMap}}function ru(e,t){switch(e.RRNodeType){case p.Document:return{id:t,type:e.RRNodeType,childNodes:[]};case p.DocumentType:{let r=e;return{id:t,type:e.RRNodeType,name:r.name,publicId:r.publicId,systemId:r.systemId}}case p.Element:return{id:t,type:e.RRNodeType,tagName:e.tagName.toLowerCase(),attributes:{},childNodes:[]};case p.Text:case p.Comment:return{id:t,type:e.RRNodeType,textContent:e.textContent||""};case p.CDATA:return{id:t,type:e.RRNodeType,textContent:""}}}function rd(e){return{all:e=e||new Map,on:function(t,r){var n=e.get(t);n?n.push(r):e.set(t,[r])},off:function(t,r){var n=e.get(t);n&&(r?n.splice(n.indexOf(r)>>>0,1):e.set(t,[]))},emit:function(t,r){var n=e.get(t);n&&n.slice().map(function(e){e(r)}),(n=e.get("*"))&&n.slice().map(function(e){e(t,r)})}}}var rh=Object.freeze({__proto__:null,default:rd});function rp(e,t){if(e.type===eb.IncrementalSnapshot&&e.data.source===eC.MouseMove&&e.data.positions&&e.data.positions.length){let r=e.data.positions[0].timeOffset,n=e.timestamp+r;return e.delay=n-t,n-t}return e.delay=e.timestamp-t,e.delay}/*! *****************************************************************************
    Copyright (c) Microsoft Corporation.

    Permission to use, copy, modify, and/or distribute this software for any
    purpose with or without fee is hereby granted.

    THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
    REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
    AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
    INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
    LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
    OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
    PERFORMANCE OF THIS SOFTWARE.
    ***************************************************************************** */ function rf(e,t){var r="function"==typeof Symbol&&e[Symbol.iterator];if(!r)return e;var n,i,o=r.call(e),a=[];try{for(;(void 0===t||t-- >0)&&!(n=o.next()).done;)a.push(n.value)}catch(s){i={error:s}}finally{try{n&&!n.done&&(r=o.return)&&r.call(o)}finally{if(i)throw i.error}}return a}(l=m||(m={}))[l.NotStarted=0]="NotStarted",l[l.Running=1]="Running",l[l.Stopped=2]="Stopped";var rm={type:"xstate.init"};function rg(e){return void 0===e?[]:[].concat(e)}function ry(e){return{type:"xstate.assign",assignment:e}}function rv(e,t){return"string"==typeof(e="string"==typeof e&&t&&t[e]?t[e]:e)?{type:e}:"function"==typeof e?{type:e.name,exec:e}:e}function r$(e){return function(t){return e===t}}function rb(e){return"string"==typeof e?{type:e}:e}function rC(e,t,r){var n=t,i=!1;return[e.filter(function(e){if("xstate.assign"===e.type){i=!0;var t=Object.assign({},n);return"function"==typeof e.assignment?t=e.assignment(n,r):Object.keys(e.assignment).forEach(function(i){t[i]="function"==typeof e.assignment[i]?e.assignment[i](n,r):e.assignment[i]}),n=t,!1}return!0}),n,i]}function rI(e,t){void 0===t&&(t={});var r=rf(rC(rg(e.states[e.initial].entry).map(function(e){return rv(e,t.actions)}),e.context,rm),2),n=r[0],i=r[1],o={config:e,_options:t,initialState:{value:e.initial,actions:n,context:i,matches:r$(e.initial)},transition:function(t,r){var n,i,a,s,l="string"==typeof t?{value:t,context:e.context}:t,c=l.value,u=l.context,d=rb(r),h=e.states[c];if(h.on){var p=rg(h.on[d.type]);try{for(var f=function(e){var t="function"==typeof Symbol&&Symbol.iterator,r=t&&e[t],n=0;if(r)return r.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&n>=e.length&&(e=void 0),{value:e&&e[n++],done:!e}}};throw TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")}(p),m=f.next();!m.done;m=f.next()){var g=m.value;if(void 0===g)break;var y="string"==typeof g?{target:g}:g,v=y.target,$=y.actions,b=void 0===$?[]:$,C=y.cond,I=void 0===C?function(){return!0}:C,S=void 0===v,w=null!=v?v:c,N=e.states[w];if(I(u,d)){var E=rf(rC((S?rg(b):[].concat(h.exit,b,N.entry).filter(function(e){return e})).map(function(e){return rv(e,o._options.actions)}),u,d),3),_=E[0],T=E[1],M=E[2],R=null!=v?v:c;return{value:R,context:T,actions:_,changed:v!==c||_.length>0||M,matches:r$(R)}}}}catch(D){a={error:D}}finally{try{m&&!m.done&&(s=f.return)&&s.call(f)}finally{if(a)throw a.error}}}return n=c,i=u,{value:n,context:i,actions:[],changed:!1,matches:r$(n)}}};return o}var rS=function(e,t){return e.actions.forEach(function(r){var n=r.exec;return n&&n(e.context,t)})};function rw(e){var t=e.initialState,r=m.NotStarted,n=new Set,i={_machine:e,send:function(i){r===m.Running&&(t=e.transition(t,i),rS(t,rb(i)),n.forEach(function(e){return e(t)}))},subscribe:function(e){return n.add(e),e(t),{unsubscribe:function(){return n.delete(e)}}},start:function(n){if(n){var o="object"==typeof n?n:{context:e.config.context,value:n};t={value:o.value,actions:[],context:o.context,matches:r$(o.value)}}return r=m.Running,rS(t,rm),i},stop:function(){return r=m.Stopped,n.clear(),i},get state(){return t},get status(){return r}};return i}var rN=Object.defineProperty,rE=Object.defineProperties,r_=Object.getOwnPropertyDescriptors,rT=Object.getOwnPropertySymbols,rM=Object.prototype.hasOwnProperty,rR=Object.prototype.propertyIsEnumerable,rD=(e,t,r)=>t in e?rN(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r,rA=(e,t)=>{for(var r in t||(t={}))rM.call(t,r)&&rD(e,r,t[r]);if(rT)for(var r of rT(t))rR.call(t,r)&&rD(e,r,t[r]);return e},rx=(e,t)=>rE(e,r_(t));let rk=e=>[`.${e} { background: currentColor }`,"noscript { display: none !important; }"];var rO=(e,t,r)=>new Promise((n,i)=>{var o=e=>{try{s(r.next(e))}catch(t){i(t)}},a=e=>{try{s(r.throw(e))}catch(t){i(t)}},s=e=>e.done?n(e.value):Promise.resolve(e.value).then(o,a);s((r=r.apply(e,t)).next())});let rL=new Map;function r0(e,t){let r=rL.get(e);return r||(r=new Map,rL.set(e,r)),r.has(t)||r.set(t,[]),r.get(t)}function r8(e,t,r){return n=>rO(this,null,function*(){if(n&&"object"==typeof n&&"rr_type"in n){if(r&&(r.isUnchanged=!1),"ImageBitmap"===n.rr_type&&"args"in n){let i=yield r8(e,t,r)(n.args);return yield createImageBitmap.apply(null,i)}if("index"in n){if(r||null===t)return n;let{rr_type:o,index:a}=n;return r0(t,o)[a]}if("args"in n){let{rr_type:s,args:l}=n,c=window[s];return new c(...yield Promise.all(l.map(r8(e,t,r))))}else if("base64"in n)return tl(n.base64);else if("src"in n){let u=e.get(n.src);if(u)return u;{let d=new Image;return d.src=n.src,e.set(n.src,d),d}}else if("data"in n&&"Blob"===n.rr_type){let h=yield Promise.all(n.data.map(r8(e,t,r))),p=new Blob(h,{type:n.type});return p}}else if(Array.isArray(n)){let f=yield Promise.all(n.map(r8(e,t,r)));return f}return n})}var rF=(e,t,r)=>new Promise((n,i)=>{var o=e=>{try{s(r.next(e))}catch(t){i(t)}},a=e=>{try{s(r.throw(e))}catch(t){i(t)}},s=e=>e.done?n(e.value):Promise.resolve(e.value).then(o,a);s((r=r.apply(e,t)).next())});let rP=["WebGLActiveInfo","WebGLBuffer","WebGLFramebuffer","WebGLProgram","WebGLRenderbuffer","WebGLShader","WebGLShaderPrecisionFormat","WebGLTexture","WebGLUniformLocation","WebGLVertexArrayObject"];function r1(e){return rF(this,arguments,function*({mutation:e,target:t,type:r,imageMap:n,errorHandler:i}){try{let o=function e(t,r){try{if(r===eS.WebGL)return t.getContext("webgl")||t.getContext("experimental-webgl");return t.getContext("webgl2")}catch(n){return null}}(t,r);if(!o)return;if(e.setter){o[e.property]=e.args[0];return}let a=o[e.property],s=yield Promise.all(e.args.map(r8(n,o))),l=a.apply(o,s);!function e(t,r){if(!(null==r?void 0:r.constructor))return;let{name:n}=r.constructor;if(!rP.includes(n))return;let i=r0(t,n);i.includes(r)||i.push(r)}(o,l)}catch(c){i(e,c)}})}var r3=(e,t,r)=>new Promise((n,i)=>{var o=e=>{try{s(r.next(e))}catch(t){i(t)}},a=e=>{try{s(r.throw(e))}catch(t){i(t)}},s=e=>e.done?n(e.value):Promise.resolve(e.value).then(o,a);s((r=r.apply(e,t)).next())});function rG(e){return r3(this,arguments,function*({event:e,mutation:t,target:r,imageMap:n,errorHandler:i}){try{let o=r.getContext("2d");if(t.setter){o[t.property]=t.args[0];return}let a=o[t.property];if("drawImage"===t.property&&"string"==typeof t.args[0])n.get(e),a.apply(o,t.args);else{let s=yield Promise.all(t.args.map(r8(n,o)));a.apply(o,s)}}catch(l){i(t,l)}})}var rV=(e,t,r)=>new Promise((n,i)=>{var o=e=>{try{s(r.next(e))}catch(t){i(t)}},a=e=>{try{s(r.throw(e))}catch(t){i(t)}},s=e=>e.done?n(e.value):Promise.resolve(e.value).then(o,a);s((r=r.apply(e,t)).next())});function rB(e){return rV(this,arguments,function*({event:e,mutation:t,target:r,imageMap:n,canvasEventMap:i,errorHandler:o}){try{let a=i.get(e)||t,s="commands"in a?a.commands:[a];if([eS.WebGL,eS.WebGL2].includes(t.type)){for(let l=0;l<s.length;l++){let c=s[l];yield r1({mutation:c,type:t.type,target:r,imageMap:n,errorHandler:o})}return}for(let u=0;u<s.length;u++){let d=s[u];yield rG({event:e,mutation:d,target:r,imageMap:n,errorHandler:o})}}catch(h){o(t,h)}})}var rW=Object.defineProperty,rY=Object.defineProperties,rZ=Object.getOwnPropertyDescriptors,rU=Object.getOwnPropertySymbols,rz=Object.prototype.hasOwnProperty,rX=Object.prototype.propertyIsEnumerable,rH=(e,t,r)=>t in e?rW(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r,r6=(e,t)=>{for(var r in t||(t={}))rz.call(t,r)&&rH(e,r,t[r]);if(rU)for(var r of rU(t))rX.call(t,r)&&rH(e,r,t[r]);return e},r7=(e,t)=>rY(e,rZ(t)),r2=(e,t,r)=>new Promise((n,i)=>{var o=e=>{try{s(r.next(e))}catch(t){i(t)}},a=e=>{try{s(r.throw(e))}catch(t){i(t)}},s=e=>e.done?n(e.value):Promise.resolve(e.value).then(o,a);s((r=r.apply(e,t)).next())});let r4="[replayer]",rK={duration:500,lineCap:"round",lineWidth:3,strokeStyle:"red"};function r5(e){return e.type==eb.IncrementalSnapshot&&(e.data.source==eC.TouchMove||e.data.source==eC.MouseInteraction&&e.data.type==eI.TouchStart)}let{addCustomEvent:rj}=tP,{freezePage:rJ}=tP;var rQ=Uint8Array,r9=Uint16Array,rq=Uint32Array,ne=new rQ([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,0,0,0]),nt=new rQ([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13,0,0]),nr=new rQ([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),nn=function(e,t){for(var r=new r9(31),n=0;n<31;++n)r[n]=t+=1<<e[n-1];for(var i=new rq(r[30]),n=1;n<30;++n)for(var o=r[n];o<r[n+1];++o)i[o]=o-r[n]<<5|n;return[r,i]},ni=nn(ne,2),no=ni[0],na=ni[1];no[28]=258,na[258]=28;for(var ns=nn(nt,0),nl=ns[0],nc=ns[1],nu=new r9(32768),nd=0;nd<32768;++nd){var nh=(43690&nd)>>>1|(21845&nd)<<1;nh=(61680&(nh=(52428&nh)>>>2|(13107&nh)<<2))>>>4|(3855&nh)<<4,nu[nd]=((65280&nh)>>>8|(255&nh)<<8)>>>1}for(var np=function(e,t,r){for(var n,i=e.length,o=0,a=new r9(t);o<i;++o)++a[e[o]-1];var s=new r9(t);for(o=0;o<t;++o)s[o]=s[o-1]+a[o-1]<<1;if(r){n=new r9(1<<t);var l=15-t;for(o=0;o<i;++o)if(e[o])for(var c=o<<4|e[o],u=t-e[o],d=s[e[o]-1]++<<u,h=d|(1<<u)-1;d<=h;++d)n[nu[d]>>>l]=c}else for(o=0,n=new r9(i);o<i;++o)n[o]=nu[s[e[o]-1]++]>>>15-e[o];return n},nf=new rQ(288),nd=0;nd<144;++nd)nf[nd]=8;for(var nd=144;nd<256;++nd)nf[nd]=9;for(var nd=256;nd<280;++nd)nf[nd]=7;for(var nd=280;nd<288;++nd)nf[nd]=8;for(var nm=new rQ(32),nd=0;nd<32;++nd)nm[nd]=5;var ng=np(nf,9,0),ny=np(nf,9,1),nv=np(nm,5,0),n$=np(nm,5,1),nb=function(e){for(var t=e[0],r=1;r<e.length;++r)e[r]>t&&(t=e[r]);return t},nC=function(e,t,r){var n=t/8>>0;return(e[n]|e[n+1]<<8)>>>(7&t)&r},nI=function(e,t){var r=t/8>>0;return(e[r]|e[r+1]<<8|e[r+2]<<16)>>>(7&t)},nS=function(e){return(e/8>>0)+(7&e&&1)},nw=function(e,t,r){(null==t||t<0)&&(t=0),(null==r||r>e.length)&&(r=e.length);var n=new(e instanceof r9?r9:e instanceof rq?rq:rQ)(r-t);return n.set(e.subarray(t,r)),n},nN=function(e,t,r){var n=e.length,i=!t||r,o=!r||r.i;r||(r={}),t||(t=new rQ(3*n));var a=function(e){var r=t.length;if(e>r){var n=new rQ(Math.max(2*r,e));n.set(t),t=n}},s=r.f||0,l=r.p||0,c=r.b||0,u=r.l,d=r.d,h=r.m,p=r.n,f=8*n;do{if(!u){r.f=s=nC(e,l,1);var m=nC(e,l+1,3);if(l+=3,m){if(1==m)u=ny,d=n$,h=9,p=5;else if(2==m){var g=nC(e,l,31)+257,y=nC(e,l+10,15)+4,v=g+nC(e,l+5,31)+1;l+=14;for(var $=new rQ(v),b=new rQ(19),C=0;C<y;++C)b[nr[C]]=nC(e,l+3*C,7);l+=3*y;var I=nb(b),S=(1<<I)-1;if(!o&&l+v*(I+7)>f)break;for(var w=np(b,I,1),C=0;C<v;){var N=w[nC(e,l,S)];l+=15&N;var E=N>>>4;if(E<16)$[C++]=E;else{var _=0,T=0;for(16==E?(T=3+nC(e,l,3),l+=2,_=$[C-1]):17==E?(T=3+nC(e,l,7),l+=3):18==E&&(T=11+nC(e,l,127),l+=7);T--;)$[C++]=_}}var M=$.subarray(0,g),R=$.subarray(g);h=nb(M),p=nb(R),u=np(M,h,1),d=np(R,p,1)}else throw"invalid block type"}else{var E=nS(l)+4,D=e[E-4]|e[E-3]<<8,A=E+D;if(A>n){if(o)throw"unexpected EOF";break}i&&a(c+D),t.set(e.subarray(E,A),c),r.b=c+=D,r.p=l=8*A;continue}if(l>f)throw"unexpected EOF"}i&&a(c+131072);for(var x=(1<<h)-1,k=(1<<p)-1,O=h+p+18;o||l+O<f;){var _=u[nI(e,l)&x],L=_>>>4;if((l+=15&_)>f)throw"unexpected EOF";if(!_)throw"invalid length/literal";if(L<256)t[c++]=L;else if(256==L){u=null;break}else{var F=L-254;if(L>264){var C=L-257,P=ne[C];F=nC(e,l,(1<<P)-1)+no[C],l+=P}var G=d[nI(e,l)&k],V=G>>>4;if(!G)throw"invalid distance";l+=15&G;var R=nl[V];if(V>3){var P=nt[V];R+=nI(e,l)&(1<<P)-1,l+=P}if(l>f)throw"unexpected EOF";i&&a(c+131072);for(var B=c+F;c<B;c+=4)t[c]=t[c-R],t[c+1]=t[c+1-R],t[c+2]=t[c+2-R],t[c+3]=t[c+3-R];c=B}}r.l=u,r.p=l,r.b=c,u&&(s=1,r.m=h,r.d=d,r.n=p)}while(!s);return c==t.length?t:nw(t,0,c)},nE=function(e,t,r){r<<=7&t;var n=t/8>>0;e[n]|=r,e[n+1]|=r>>>8},n_=function(e,t,r){r<<=7&t;var n=t/8>>0;e[n]|=r,e[n+1]|=r>>>8,e[n+2]|=r>>>16},nT=function(e,t){for(var r=[],n=0;n<e.length;++n)e[n]&&r.push({s:n,f:e[n]});var i=r.length,o=r.slice();if(!i)return[new rQ(0),0];if(1==i){var a=new rQ(r[0].s+1);return a[r[0].s]=1,[a,1]}r.sort(function(e,t){return e.f-t.f}),r.push({s:-1,f:25001});var s=r[0],l=r[1],c=0,u=1,d=2;for(r[0]={s:-1,f:s.f+l.f,l:s,r:l};u!=i-1;)s=r[r[c].f<r[d].f?c++:d++],l=r[c!=u&&r[c].f<r[d].f?c++:d++],r[u++]={s:-1,f:s.f+l.f,l:s,r:l};for(var h=o[0].s,n=1;n<i;++n)o[n].s>h&&(h=o[n].s);var p=new r9(h+1),f=nM(r[u-1],p,0);if(f>t){var n=0,m=0,g=f-t,y=1<<g;for(o.sort(function(e,t){return p[t.s]-p[e.s]||e.f-t.f});n<i;++n){var v=o[n].s;if(p[v]>t)m+=y-(1<<f-p[v]),p[v]=t;else break}for(m>>>=g;m>0;){var $=o[n].s;p[$]<t?m-=1<<t-p[$]++-1:++n}for(;n>=0&&m;--n){var b=o[n].s;p[b]==t&&(--p[b],++m)}f=t}return[new rQ(p),f]},nM=function(e,t,r){return -1==e.s?Math.max(nM(e.l,t,r+1),nM(e.r,t,r+1)):t[e.s]=r},nR=function(e){for(var t=e.length;t&&!e[--t];);for(var r=new r9(++t),n=0,i=e[0],o=1,a=function(e){r[n++]=e},s=1;s<=t;++s)if(e[s]==i&&s!=t)++o;else{if(!i&&o>2){for(;o>138;o-=138)a(32754);o>2&&(a(o>10?o-11<<5|28690:o-3<<5|12305),o=0)}else if(o>3){for(a(i),--o;o>6;o-=6)a(8304);o>2&&(a(o-3<<5|8208),o=0)}for(;o--;)a(i);o=1,i=e[s]}return[r.subarray(0,n),t]},nD=function(e,t){for(var r=0,n=0;n<t.length;++n)r+=e[n]*t[n];return r},nA=function(e,t,r){var n=r.length,i=nS(t+2);e[i]=255&n,e[i+1]=n>>>8,e[i+2]=255^e[i],e[i+3]=255^e[i+1];for(var o=0;o<n;++o)e[i+o+4]=r[o];return(i+4+n)*8},nx=function(e,t,r,n,i,o,a,s,l,c,u){nE(t,u++,r),++i[256];for(var d,h,p,f,m=nT(i,15),g=m[0],y=m[1],v=nT(o,15),$=v[0],b=v[1],C=nR(g),I=C[0],S=C[1],w=nR($),N=w[0],E=w[1],_=new r9(19),T=0;T<I.length;++T)_[31&I[T]]++;for(var T=0;T<N.length;++T)_[31&N[T]]++;for(var M=nT(_,7),R=M[0],D=M[1],A=19;A>4&&!R[nr[A-1]];--A);var x=c+5<<3,k=nD(i,nf)+nD(o,nm)+a,O=nD(i,g)+nD(o,$)+a+14+3*A+nD(_,R)+(2*_[16]+3*_[17]+7*_[18]);if(x<=k&&x<=O)return nA(t,u,e.subarray(l,l+c));if(nE(t,u,1+(O<k)),u+=2,O<k){d=np(g,y,0),h=g,p=np($,b,0),f=$;var L=np(R,D,0);nE(t,u,S-257),nE(t,u+5,E-1),nE(t,u+10,A-4),u+=14;for(var T=0;T<A;++T)nE(t,u+3*T,R[nr[T]]);u+=3*A;for(var F=[I,N],P=0;P<2;++P)for(var G=F[P],T=0;T<G.length;++T){var V=31&G[T];nE(t,u,L[V]),u+=R[V],V>15&&(nE(t,u,G[T]>>>5&127),u+=G[T]>>>12)}}else d=ng,h=nf,p=nv,f=nm;for(var T=0;T<s;++T)if(n[T]>255){var V=n[T]>>>18&31;n_(t,u,d[V+257]),u+=h[V+257],V>7&&(nE(t,u,n[T]>>>23&31),u+=ne[V]);var B=31&n[T];n_(t,u,p[B]),u+=f[B],B>3&&(n_(t,u,n[T]>>>5&8191),u+=nt[B])}else n_(t,u,d[n[T]]),u+=h[n[T]];return n_(t,u,d[256]),u+h[256]},nk=new rq([65540,131080,131088,131104,262176,1048704,1048832,2114560,2117632]),nO=new rQ(0),nL=function(e,t,r,n,i,o){var a=e.length,s=new rQ(n+a+5*(1+Math.floor(a/7e3))+i),l=s.subarray(n,s.length-i),c=0;if(!t||a<8)for(var u=0;u<=a;u+=65535){var d=u+65535;d<a?c=nA(l,c,e.subarray(u,d)):(l[u]=o,c=nA(l,c,e.subarray(u,a)))}else{for(var h=nk[t-1],p=h>>>13,f=8191&h,m=(1<<r)-1,g=new r9(32768),y=new r9(m+1),v=Math.ceil(r/3),$=2*v,b=function(t){return(e[t]^e[t+1]<<v^e[t+2]<<$)&m},C=new rq(25e3),I=new r9(288),S=new r9(32),w=0,N=0,u=0,E=0,_=0,T=0;u<a;++u){var M=b(u),R=32767&u,D=y[M];if(g[R]=D,y[M]=R,_<=u){var A=a-u;if((w>7e3||E>24576)&&A>423){c=nx(e,l,0,C,I,S,N,E,T,u-T,c),E=w=N=0,T=u;for(var x=0;x<286;++x)I[x]=0;for(var x=0;x<30;++x)S[x]=0}var k=2,O=0,L=f,F=R-D&32767;if(A>2&&M==b(u-F))for(var P=Math.min(p,A)-1,G=Math.min(32767,u),V=Math.min(258,A);F<=G&&--L&&R!=D;){if(e[u+k]==e[u+k-F]){for(var B=0;B<V&&e[u+B]==e[u+B-F];++B);if(B>k){if(k=B,O=F,B>P)break;for(var W=Math.min(F,B-2),Y=0,x=0;x<W;++x){var Z=u-F+x+32768&32767,U=g[Z],z=Z-U+32768&32767;z>Y&&(Y=z,D=Z)}}}D=g[R=D],F+=R-D+32768&32767}if(O){C[E++]=268435456|na[k]<<18|nc[O];var X=31&na[k],H=31&nc[O];N+=ne[X]+nt[H],++I[257+X],++S[H],_=u+k,++w}else C[E++]=e[u],++I[e[u]]}}c=nx(e,l,o,C,I,S,N,E,T,u-T,c),o||(c=nA(l,c,nO))}return nw(s,0,n+nS(c)+i)},n0=function(){var e=1,t=0;return{p:function(r){for(var n=e,i=t,o=r.length,a=0;a!=o;){for(var s=Math.min(a+5552,o);a<s;++a)n+=r[a],i+=n;n%=65521,i%=65521}e=n,t=i},d:function(){return(e>>>8<<16|(255&t)<<8|t>>>8)+((255&e)<<23)*2}}},n8=function(e,t,r){for(;r;++t)e[t]=r,r>>>=8},nF=function(e,t){var r=t.level,n=0==r?0:r<6?1:9==r?3:2;e[0]=120,e[1]=n<<6|(n?32-2*n:1)},nP=function(e){if((15&e[0])!=8||e[0]>>>4>7||(e[0]<<8|e[1])%31)throw"invalid zlib data";if(32&e[1])throw"invalid zlib data: preset dictionaries not supported"};function n1(e,t){var r=e.length;if(!t&&"undefined"!=typeof TextEncoder)return new TextEncoder().encode(e);for(var n=new rQ(e.length+(e.length>>>1)),i=0,o=function(e){n[i++]=e},a=0;a<r;++a){if(i+5>n.length){var s=new rQ(i+8+(r-a<<1));s.set(n),n=s}var l=e.charCodeAt(a);l<128||t?o(l):l<2048?(o(192|l>>>6),o(128|63&l)):l>55295&&l<57344?(o(240|(l=65536+(1047552&l)|1023&e.charCodeAt(++a))>>>18),o(128|l>>>12&63),o(128|l>>>6&63),o(128|63&l)):(o(224|l>>>12),o(128|l>>>6&63),o(128|63&l))}return nw(n,0,i)}function n3(e,t){var r="";if(!t&&"undefined"!=typeof TextDecoder)return new TextDecoder().decode(e);for(var n=0;n<e.length;){var i=e[n++];i<128||t?r+=String.fromCharCode(i):i<224?r+=String.fromCharCode((31&i)<<6|63&e[n++]):i<240?r+=String.fromCharCode((15&i)<<12|(63&e[n++])<<6|63&e[n++]):r+=String.fromCharCode(55296|(i=((15&i)<<18|(63&e[n++])<<12|(63&e[n++])<<6|63&e[n++])-65536)>>10,56320|1023&i)}return r}var nG=Object.defineProperty,nV=Object.defineProperties,nB=Object.getOwnPropertyDescriptors,nW=Object.getOwnPropertySymbols,nY=Object.prototype.hasOwnProperty,nZ=Object.prototype.propertyIsEnumerable,nU=(e,t,r)=>t in e?nG(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r,nz=(e,t)=>{for(var r in t||(t={}))nY.call(t,r)&&nU(e,r,t[r]);if(nW)for(var r of nW(t))nZ.call(t,r)&&nU(e,r,t[r]);return e},nX=(e,t)=>nV(e,nB(t));let nH=e=>{var t,r,n,i,o,a,s,l;let c=nX(nz({},e),{v:"v1"});return n3((t=n1(JSON.stringify(c)),void 0===r&&(r={}),(n=n0()).p(t),l=(i=t,nL(i,null==(o=r).level?6:o.level,null==o.mem?Math.ceil(1.5*Math.max(8,Math.min(13,Math.log(i.length)))):12+o.mem,2,4,!0)),nF(l,r),n8(l,l.length-4,n.d()),l),!0)},n6=e=>{if("string"!=typeof e)return e;try{let t=JSON.parse(e);if(t.timestamp)return t}catch(r){}try{var n;let i=JSON.parse(n3((n=n1(e,!0),nN((nP(n),n.subarray(2,-4)),void 0))));if("v1"===i.v)return i;throw Error(`These events were packed with packer ${i.v} which is incompatible with current packer v1.`)}catch(o){throw console.error(o),Error("Unknown data format.")}};class n7{constructor(e){this.fileName=e.fileName||"",this.functionName=e.functionName||"",this.lineNumber=e.lineNumber,this.columnNumber=e.columnNumber}toString(){let e=this.lineNumber||"",t=this.columnNumber||"";return this.functionName?`${this.functionName} (${this.fileName}:${e}:${t})`:`${this.fileName}:${e}:${t}`}}let n2=/(^|@)\S+:\d+/,n4=/^\s*at .*(\S+:\d+|\(native\))/m,nK=/^(eval@)?(\[native code])?$/,n5={parse:function(e){if(!e)return[];if(void 0!==e.stacktrace||void 0!==e["opera#sourceloc"])return this.parseOpera(e);if(e.stack&&e.stack.match(n4))return this.parseV8OrIE(e);if(e.stack)return this.parseFFOrSafari(e);throw Error("Cannot parse given Error object")},extractLocation:function(e){if(-1===e.indexOf(":"))return[e];let t=/(.+?)(?::(\d+))?(?::(\d+))?$/.exec(e.replace(/[()]/g,""));if(!t)throw Error(`Cannot parse given url: ${e}`);return[t[1],t[2]||void 0,t[3]||void 0]},parseV8OrIE:function(e){let t=e.stack.split("\n").filter(function(e){return!!e.match(n4)},this);return t.map(function(e){e.indexOf("(eval ")>-1&&(e=e.replace(/eval code/g,"eval").replace(/(\(eval at [^()]*)|(\),.*$)/g,""));let t=e.replace(/^\s+/,"").replace(/\(eval code/g,"("),r=t.match(/ (\((.+):(\d+):(\d+)\)$)/);t=r?t.replace(r[0],""):t;let n=t.split(/\s+/).slice(1),i=this.extractLocation(r?r[1]:n.pop()),o=n.join(" ")||void 0,a=["eval","<anonymous>"].indexOf(i[0])>-1?void 0:i[0];return new n7({functionName:o,fileName:a,lineNumber:i[1],columnNumber:i[2]})},this)},parseFFOrSafari:function(e){let t=e.stack.split("\n").filter(function(e){return!e.match(nK)},this);return t.map(function(e){if(e.indexOf(" > eval")>-1&&(e=e.replace(/ line (\d+)(?: > eval line \d+)* > eval:\d+:\d+/g,":$1")),-1===e.indexOf("@")&&-1===e.indexOf(":"))return new n7({functionName:e});{let t=/((.*".+"[^@]*)?[^@]*)(?:@)/,r=e.match(t),n=r&&r[1]?r[1]:void 0,i=this.extractLocation(e.replace(t,""));return new n7({functionName:n,fileName:i[0],lineNumber:i[1],columnNumber:i[2]})}},this)},parseOpera:function(e){return!e.stacktrace||e.message.indexOf("\n")>-1&&e.message.split("\n").length>e.stacktrace.split("\n").length?this.parseOpera9(e):e.stack?this.parseOpera11(e):this.parseOpera10(e)},parseOpera9:function(e){let t=/Line (\d+).*script (?:in )?(\S+)/i,r=e.message.split("\n"),n=[];for(let i=2,o=r.length;i<o;i+=2){let a=t.exec(r[i]);a&&n.push(new n7({fileName:a[2],lineNumber:parseFloat(a[1])}))}return n},parseOpera10:function(e){let t=/Line (\d+).*script (?:in )?(\S+)(?:: In function (\S+))?$/i,r=e.stacktrace.split("\n"),n=[];for(let i=0,o=r.length;i<o;i+=2){let a=t.exec(r[i]);a&&n.push(new n7({functionName:a[3]||void 0,fileName:a[2],lineNumber:parseFloat(a[1])}))}return n},parseOpera11:function(e){let t=e.stack.split("\n").filter(function(e){return!!e.match(n2)&&!e.match(/^Error created at/)},this);return t.map(function(e){let t=e.split("@"),r=this.extractLocation(t.pop()),n=t.shift()||"",i=n.replace(/<anonymous function(: (\w+))?>/,"$2").replace(/\([^)]*\)/g,"")||void 0;return new n7({functionName:i,fileName:r[0],lineNumber:r[1],columnNumber:r[2]})},this)}};function nj(e){if(!e||!e.outerHTML)return"";let t="";for(;e.parentElement;){let r=e.localName;if(!r)break;r=r.toLowerCase();let n=e.parentElement,i=[];if(n.children&&n.children.length>0)for(let o=0;o<n.children.length;o++){let a=n.children[o];a.localName&&a.localName.toLowerCase&&a.localName.toLowerCase()===r&&i.push(a)}i.length>1&&(r+=`:eq(${i.indexOf(e)})`),t=r+(t?">"+t:""),e=n}return t}function nJ(e){return"[object Object]"===Object.prototype.toString.call(e)}function nQ(e,t){let r={numOfKeysLimit:50,depthOfLimit:4};Object.assign(r,t);let n=[],i=[];return JSON.stringify(e,function(e,t){var o,a;if(n.length>0){let s=n.indexOf(this);~s?n.splice(s+1):n.push(this),~s?i.splice(s,1/0,e):i.push(e),~n.indexOf(t)&&(t=n[0]===t?"[Circular ~]":"[Circular ~."+i.slice(0,n.indexOf(t)).join(".")+"]")}else n.push(t);if(null===t)return t;if(void 0===t)return"undefined";if(o=t,nJ(o)&&Object.keys(o).length>r.numOfKeysLimit||"function"==typeof o||nJ(o)&&function e(t,r){if(0===r)return!0;let n=Object.keys(t);for(let i of n)if(nJ(t[i])&&e(t[i],r-1))return!0;return!1}(o,r.depthOfLimit)){let l;return a=t,l=a.toString(),r.stringLengthLimit&&l.length>r.stringLengthLimit&&(l=`${l.slice(0,r.stringLengthLimit)}...`),l}if(t instanceof Event){let c={};for(let u in t){let d=t[u];Array.isArray(d)?c[u]=nj(d.length?d[0]:null):c[u]=d}return c}return t instanceof Node?t instanceof HTMLElement?t?t.outerHTML:"":t.nodeName:t instanceof Error?t.stack?t.stack+"\nEnd of stack for Error object":t.name+": "+t.message:t})}let n9={level:["assert","clear","count","countReset","debug","dir","dirxml","error","group","groupCollapsed","groupEnd","info","log","table","time","timeEnd","timeLog","trace","warn"],lengthThreshold:1e3,logger:"console"};function nq(e,t,r){let n=r?Object.assign({},n9,r):n9,i=n.logger;if(!i)return()=>{};let o;o="string"==typeof i?t[i]:i;let a=0,s=[];if(n.level.includes("error")&&window){let l=t=>{let r=t.message,i=t.error,o=n5.parse(i).map(e=>e.toString()),a=[nQ(r,n.stringifyOptions)];e({level:"error",trace:o,payload:a})};window.addEventListener("error",l),s.push(()=>{window&&window.removeEventListener("error",l)})}for(let c of n.level)s.push(u(o,c));return()=>{s.forEach(e=>e())};function u(t,r){return t[r]?H(t,r,t=>(...i)=>{t.apply(this,i);try{let o=n5.parse(Error()).map(e=>e.toString()).splice(1),s=i.map(e=>nQ(e,n.stringifyOptions));++a<n.lengthThreshold?e({level:r,trace:o,payload:s}):a===n.lengthThreshold&&e({level:"warn",trace:[],payload:[nQ("The number of log records reached the threshold.")]})}catch(l){t("reweby logger error:",l,...i)}}):()=>{}}}let ie="reweby/console@1",it=e=>({name:ie,observer:nq,options:e}),ir="__reweby_original__";class ii{constructor(e){this.config=Object.assign({level:["assert","clear","count","countReset","debug","dir","dirxml","error","group","groupCollapsed","groupEnd","info","log","table","time","timeEnd","timeLog","trace","warn"],replayLogger:void 0},e)}getConsoleLogger(){let e={};for(let t of this.config.level)"trace"===t?e[t]=e=>{let t=console.log[ir]?console.log[ir]:console.log;t(...e.payload.map(e=>JSON.parse(e)),this.formatMessage(e))}:e[t]=e=>{let r=console[t][ir]?console[t][ir]:console[t];r(...e.payload.map(e=>JSON.parse(e)),this.formatMessage(e))};return e}formatMessage(e){if(0===e.trace.length)return"";let t="\n	at ",r=t;return r+e.trace.join(t)}}let io=e=>{let t=(null==e?void 0:e.replayLogger)||new ii(e).getConsoleLogger();return{handler(e,r,n){let i=null;if(e.type===eb.IncrementalSnapshot&&e.data.source===eC.Log?i=e.data:e.type===eb.Plugin&&e.data.plugin===ie&&(i=e.data.payload),i)try{"function"==typeof t[i.level]&&t[i.level](i)}catch(o){n.replayer.config.showWarning&&console.warn(o)}}}};return e.EventType=eb,e.IncrementalSource=eC,e.MouseInteractions=eI,e.PLUGIN_NAME=ie,e.Replayer=class e{constructor(e,t){if(this.usingVirtualDom=!1,this.virtualDom=new t9,this.mouseTail=null,this.tailPositions=[],this.emitter=(rd||rh)(),this.legacy_missingNodeRetryMap={},this.cache=W(),this.imageMap=new Map,this.canvasEventMap=new Map,this.mirror=y(),this.styleMirror=new eh,this.firstFullSnapshot=null,this.newDocumentQueue=[],this.mousePos=null,this.touchActive=null,this.lastSelectionData=null,this.constructedStyleMutations=[],this.adoptedStyleSheets=[],this.handleResize=e=>{for(let t of(this.iframe.style.display="inherit",[this.mouseTail,this.iframe]))t&&(t.setAttribute("width",String(e.width)),t.setAttribute("height",String(e.height)))},this.applyEventsSynchronously=e=>{for(let t of e){switch(t.type){case eb.DomContentLoaded:case eb.Load:case eb.Custom:continue;case eb.FullSnapshot:case eb.Meta:case eb.Plugin:case eb.IncrementalSnapshot:}let r=this.getCastFn(t,!0);r()}!0===this.touchActive?this.mouse.classList.add("touch-active"):!1===this.touchActive&&this.mouse.classList.remove("touch-active"),this.touchActive=null},this.getCastFn=(e,t=!1)=>{let r;switch(e.type){case eb.DomContentLoaded:case eb.Load:break;case eb.Custom:r=()=>{this.emitter.emit(eN.CustomEvent,e)};break;case eb.Meta:r=()=>this.emitter.emit(eN.Resize,{width:e.data.width,height:e.data.height});break;case eb.FullSnapshot:r=()=>{var r;if(this.firstFullSnapshot){if(this.firstFullSnapshot===e){this.firstFullSnapshot=!0;return}}else this.firstFullSnapshot=!0;this.rebuildFullSnapshot(e,t),null==(r=this.iframe.contentWindow)||r.scrollTo(e.data.initialOffset),this.styleMirror.reset()};break;case eb.IncrementalSnapshot:r=()=>{if(this.applyIncremental(e,t),!t&&(e===this.nextUserInteractionEvent&&(this.nextUserInteractionEvent=null,this.backToNormal()),this.config.skipInactive&&!this.nextUserInteractionEvent)){for(let r of this.service.state.context.events)if(!(r.timestamp<=e.timestamp)&&this.isUserInteraction(r)){r.delay-e.delay>1e4*this.speedService.state.context.timer.speed&&(this.nextUserInteractionEvent=r);break}if(this.nextUserInteractionEvent){let n=this.nextUserInteractionEvent.delay-e.delay,i={speed:Math.min(Math.round(n/5e3),this.config.maxSpeed)};this.speedService.send({type:"FAST_FORWARD",payload:i}),this.emitter.emit(eN.SkipStart,i)}}}}let n=()=>{for(let n of(r&&r(),this.config.plugins||[]))n.handler&&n.handler(e,t,{replayer:this});this.service.send({type:"CAST_EVENT",payload:{event:e}});let i=this.service.state.context.events.length-1;if(e===this.service.state.context.events[i]){let o=()=>{!(i<this.service.state.context.events.length-1)&&(this.backToNormal(),this.service.send("END"),this.emitter.emit(eN.Finish))};e.type===eb.IncrementalSnapshot&&e.data.source===eC.MouseMove&&e.data.positions.length?setTimeout(()=>{o()},Math.max(0,-e.data.positions[0].timeOffset+50)):o()}this.emitter.emit(eN.EventCast,e)};return n},!(null==t?void 0:t.liveMode)&&e.length<2)throw Error("Replayer need at least 2 events.");let r={speed:1,maxSpeed:360,root:document.body,loadTimeout:0,skipInactive:!1,showWarning:!0,showDebug:!1,blockClass:"rr-block",liveMode:!1,insertStyleRules:[],triggerFocus:!0,UNSAFE_replayCanvas:!1,pauseAnimation:!0,mouseTail:rK,useVirtualDom:!0};for(let n of(this.config=Object.assign({},r,t),this.handleResize=this.handleResize.bind(this),this.getCastFn=this.getCastFn.bind(this),this.applyEventsSynchronously=this.applyEventsSynchronously.bind(this),this.emitter.on(eN.Resize,this.handleResize),this.setupDom(),this.config.plugins||[]))n.getMirror&&n.getMirror({nodeMirror:this.mirror});this.emitter.on(eN.Flush,()=>{if(this.usingVirtualDom){let e={mirror:this.mirror,applyCanvas:(e,t,r)=>{rB({event:e,mutation:t,target:r,imageMap:this.imageMap,canvasEventMap:this.canvasEventMap,errorHandler:this.warnCanvasMutationFailed.bind(this)})},applyInput:this.applyInput.bind(this),applyScroll:this.applyScroll.bind(this),applyStyleSheetMutation:(e,t)=>{e.source===eC.StyleSheetRule?this.applyStyleSheetRule(e,t):e.source===eC.StyleDeclaration&&this.applyStyleDeclaration(e,t)}};if(this.iframe.contentDocument&&tj(this.iframe.contentDocument,this.virtualDom,e,this.virtualDom.mirror),this.virtualDom.destroyTree(),this.usingVirtualDom=!1,Object.keys(this.legacy_missingNodeRetryMap).length)for(let t in this.legacy_missingNodeRetryMap)try{let r=this.legacy_missingNodeRetryMap[t],n=tQ(r.node,this.mirror,this.virtualDom.mirror);tj(n,r.node,e,this.virtualDom.mirror),r.node=n}catch(i){this.config.showWarning&&console.warn(i)}this.constructedStyleMutations.forEach(e=>{this.applyStyleSheetMutation(e)}),this.constructedStyleMutations=[],this.adoptedStyleSheets.forEach(e=>{this.applyAdoptedStyleSheet(e)}),this.adoptedStyleSheets=[]}this.mousePos&&(this.moveAndHover(this.mousePos.x,this.mousePos.y,this.mousePos.id,!0,this.mousePos.debugData),this.mousePos=null),this.lastSelectionData&&(this.applySelection(this.lastSelectionData),this.lastSelectionData=null)}),this.emitter.on(eN.PlayBack,()=>{this.firstFullSnapshot=null,this.mirror.reset(),this.styleMirror.reset()});let i=new class e{constructor(e=[],t){this.timeOffset=0,this.raf=null,this.actions=e,this.speed=t.speed,this.liveMode=t.liveMode}addAction(e){if(!this.actions.length||this.actions[this.actions.length-1].delay<=e.delay){this.actions.push(e);return}let t=this.findActionIndex(e);this.actions.splice(t,0,e)}start(){this.timeOffset=0;let e=performance.now(),t=()=>{let r=performance.now();for(this.timeOffset+=(r-e)*this.speed,e=r;this.actions.length;){let n=this.actions[0];if(this.timeOffset>=n.delay)this.actions.shift(),n.doAction();else break}(this.actions.length>0||this.liveMode)&&(this.raf=requestAnimationFrame(t))};this.raf=requestAnimationFrame(t)}clear(){this.raf&&(cancelAnimationFrame(this.raf),this.raf=null),this.actions.length=0}setSpeed(e){this.speed=e}toggleLiveMode(e){this.liveMode=e}isActive(){return null!==this.raf}findActionIndex(e){let t=0,r=this.actions.length-1;for(;t<=r;){let n=Math.floor((t+r)/2);if(this.actions[n].delay<e.delay)t=n+1;else{if(!(this.actions[n].delay>e.delay))return n+1;r=n-1}}return t}}([],{speed:this.config.speed,liveMode:this.config.liveMode});this.service=function e(t,{getCastFn:r,applyEventsSynchronously:n,emitter:i}){let o=rI({id:"player",context:t,initial:"paused",states:{playing:{on:{PAUSE:{target:"paused",actions:["pause"]},CAST_EVENT:{target:"playing",actions:"castEvent"},END:{target:"paused",actions:["resetLastPlayedEvent","pause"]},ADD_EVENT:{target:"playing",actions:["addEvent"]}}},paused:{on:{PLAY:{target:"playing",actions:["recordTimeOffset","play"]},CAST_EVENT:{target:"paused",actions:"castEvent"},TO_LIVE:{target:"live",actions:["startLive"]},ADD_EVENT:{target:"paused",actions:["addEvent"]}}},live:{on:{ADD_EVENT:{target:"live",actions:["addEvent"]},CAST_EVENT:{target:"live",actions:["castEvent"]}}}}},{actions:{castEvent:ry({lastPlayedEvent:(e,t)=>"CAST_EVENT"===t.type?t.payload.event:e.lastPlayedEvent}),recordTimeOffset:ry((e,t)=>{let r=e.timeOffset;return"payload"in t&&"timeOffset"in t.payload&&(r=t.payload.timeOffset),rx(rA({},e),{timeOffset:r,baselineTime:e.events[0].timestamp+r})}),play(e){var t;let{timer:o,events:a,baselineTime:s,lastPlayedEvent:l}=e;for(let c of(o.clear(),a))rp(c,s);let u=function e(t,r){for(let n=t.length-1;n>=0;n--){let i=t[n];if(i.type===eb.Meta&&i.timestamp<=r)return t.slice(n)}return t}(a,s),d=null==l?void 0:l.timestamp;(null==l?void 0:l.type)===eb.IncrementalSnapshot&&l.data.source===eC.MouseMove&&(d=l.timestamp+(null==(t=l.data.positions[0])?void 0:t.timeOffset)),s<(d||0)&&i.emit(eN.PlayBack);let h=[];for(let p of u)if(!d||!(d<s)||!(p.timestamp<=d)&&p!==l){if(p.timestamp<s)h.push(p);else{let f=r(p,!1);o.addAction({doAction(){f()},delay:p.delay})}}n(h),i.emit(eN.Flush),o.start()},pause(e){e.timer.clear()},resetLastPlayedEvent:ry(e=>rx(rA({},e),{lastPlayedEvent:null})),startLive:ry({baselineTime:(e,t)=>(e.timer.toggleLiveMode(!0),e.timer.start(),"TO_LIVE"===t.type&&t.payload.baselineTime)?t.payload.baselineTime:Date.now()}),addEvent:ry((e,t)=>{let{baselineTime:n,timer:i,events:o}=e;if("ADD_EVENT"===t.type){let{event:a}=t.payload;rp(a,n);let s=o.length-1;if(!o[s]||o[s].timestamp<=a.timestamp)o.push(a);else{let l=-1,c=0;for(;c<=s;){let u=Math.floor((c+s)/2);o[u].timestamp<=a.timestamp?c=u+1:s=u-1}-1===l&&(l=c),o.splice(l,0,a)}let d=a.timestamp<n,h=r(a,d);d?h():i.isActive()&&i.addAction({doAction(){h()},delay:a.delay})}return rx(rA({},e),{events:o})})}});return rw(o)}({events:e.map(e=>t&&t.unpackFn?t.unpackFn(e):e).sort((e,t)=>e.timestamp-t.timestamp),timer:i,timeOffset:0,baselineTime:0,lastPlayedEvent:null},{getCastFn:this.getCastFn,applyEventsSynchronously:this.applyEventsSynchronously,emitter:this.emitter}),this.service.start(),this.service.subscribe(e=>{this.emitter.emit(eN.StateChange,{player:e})}),this.speedService=function e(t){let r=rI({id:"speed",context:t,initial:"normal",states:{normal:{on:{FAST_FORWARD:{target:"skipping",actions:["recordSpeed","setSpeed"]},SET_SPEED:{target:"normal",actions:["setSpeed"]}}},skipping:{on:{BACK_TO_NORMAL:{target:"normal",actions:["restoreSpeed"]},SET_SPEED:{target:"normal",actions:["setSpeed"]}}}}},{actions:{setSpeed(e,t){"payload"in t&&e.timer.setSpeed(t.payload.speed)},recordSpeed:ry({normalSpeed:e=>e.timer.speed}),restoreSpeed(e){e.timer.setSpeed(e.normalSpeed)}}});return rw(r)}({normalSpeed:-1,timer:i}),this.speedService.start(),this.speedService.subscribe(e=>{this.emitter.emit(eN.StateChange,{speed:e})});let o=this.service.state.context.events.find(e=>e.type===eb.Meta),a=this.service.state.context.events.find(e=>e.type===eb.FullSnapshot);if(o){let{width:s,height:l}=o.data;setTimeout(()=>{this.emitter.emit(eN.Resize,{width:s,height:l})},0)}a&&setTimeout(()=>{var e;!this.firstFullSnapshot&&(this.firstFullSnapshot=a,this.rebuildFullSnapshot(a),null==(e=this.iframe.contentWindow)||e.scrollTo(a.data.initialOffset))},1),this.service.state.context.events.find(r5)&&this.mouse.classList.add("touch-device")}get timer(){return this.service.state.context.timer}on(e,t){return this.emitter.on(e,t),this}off(e,t){return this.emitter.off(e,t),this}setConfig(e){Object.keys(e).forEach(t=>{e[t],this.config[t]=e[t]}),this.config.skipInactive||this.backToNormal(),void 0!==e.speed&&this.speedService.send({type:"SET_SPEED",payload:{speed:e.speed}}),void 0!==e.mouseTail&&(!1===e.mouseTail?this.mouseTail&&(this.mouseTail.style.display="none"):(this.mouseTail||(this.mouseTail=document.createElement("canvas"),this.mouseTail.width=Number.parseFloat(this.iframe.width),this.mouseTail.height=Number.parseFloat(this.iframe.height),this.mouseTail.classList.add("replayer-mouse-tail"),this.wrapper.insertBefore(this.mouseTail,this.iframe)),this.mouseTail.style.display="inherit"))}getMetaData(){let e=this.service.state.context.events[0],t=this.service.state.context.events[this.service.state.context.events.length-1];return{startTime:e.timestamp,endTime:t.timestamp,totalTime:t.timestamp-e.timestamp}}getCurrentTime(){return this.timer.timeOffset+this.getTimeOffset()}getTimeOffset(){let{baselineTime:e,events:t}=this.service.state.context;return e-t[0].timestamp}getMirror(){return this.mirror}play(e=0){var t,r;this.service.state.matches("paused")||this.service.send({type:"PAUSE"}),this.service.send({type:"PLAY",payload:{timeOffset:e}}),null==(r=null==(t=this.iframe.contentDocument)?void 0:t.getElementsByTagName("html")[0])||r.classList.remove("reweby-paused"),this.emitter.emit(eN.Start)}pause(e){var t,r;void 0===e&&this.service.state.matches("playing")&&this.service.send({type:"PAUSE"}),"number"==typeof e&&(this.play(e),this.service.send({type:"PAUSE"})),null==(r=null==(t=this.iframe.contentDocument)?void 0:t.getElementsByTagName("html")[0])||r.classList.add("reweby-paused"),this.emitter.emit(eN.Pause)}resume(e=0){console.warn("The 'resume' was deprecated in 1.0. Please use 'play' method which has the same interface."),this.play(e),this.emitter.emit(eN.Resume)}destroy(){this.pause(),this.config.root.removeChild(this.wrapper),this.emitter.emit(eN.Destroy)}startLive(e){this.service.send({type:"TO_LIVE",payload:{baselineTime:e}})}addEvent(e){let t=this.config.unpackFn?this.config.unpackFn(e):e;r5(t)&&this.mouse.classList.add("touch-device"),Promise.resolve().then(()=>this.service.send({type:"ADD_EVENT",payload:{event:t}}))}enableInteract(){this.iframe.setAttribute("scrolling","auto"),this.iframe.style.pointerEvents="auto"}disableInteract(){this.iframe.setAttribute("scrolling","no"),this.iframe.style.pointerEvents="none"}resetCache(){this.cache=W()}setupDom(){this.wrapper=document.createElement("div"),this.wrapper.classList.add("replayer-wrapper"),this.config.root.appendChild(this.wrapper),this.mouse=document.createElement("div"),this.mouse.classList.add("replayer-mouse"),this.wrapper.appendChild(this.mouse),!1!==this.config.mouseTail&&(this.mouseTail=document.createElement("canvas"),this.mouseTail.classList.add("replayer-mouse-tail"),this.mouseTail.style.display="inherit",this.wrapper.appendChild(this.mouseTail)),this.iframe=document.createElement("iframe");let e=["allow-same-origin"];this.config.UNSAFE_replayCanvas&&e.push("allow-scripts"),this.iframe.style.display="none",this.iframe.setAttribute("sandbox",e.join(" ")),this.disableInteract(),this.wrapper.appendChild(this.iframe),this.iframe.contentWindow&&this.iframe.contentDocument&&(function e(t=window,r=document){var n;if("scrollBehavior"in r.documentElement.style&&!0!==t.__forceSmoothScrollPolyfill__)return;let i=t.HTMLElement||t.Element,o={scroll:t.scroll||t.scrollTo,scrollBy:t.scrollBy,elementScroll:i.prototype.scroll||l,scrollIntoView:i.prototype.scrollIntoView},a=t.performance&&t.performance.now?t.performance.now.bind(t.performance):Date.now,s=(n=t.navigator.userAgent,RegExp("MSIE |Trident/|Edge/").test(n))?1:0;function l(e,t){this.scrollLeft=e,this.scrollTop=t}function c(e){if(null===e||"object"!=typeof e||void 0===e.behavior||"auto"===e.behavior||"instant"===e.behavior)return!0;if("object"==typeof e&&"smooth"===e.behavior)return!1;throw TypeError("behavior member of ScrollOptions "+e.behavior+" is not a valid value for enumeration ScrollBehavior.")}function u(e,t){return"Y"===t?e.clientHeight+s<e.scrollHeight:"X"===t?e.clientWidth+s<e.scrollWidth:void 0}function d(e,r){let n=t.getComputedStyle(e,null)["overflow"+r];return"auto"===n||"scroll"===n}function h(e){let t=u(e,"Y")&&d(e,"Y"),r=u(e,"X")&&d(e,"X");return t||r}function p(e,n,i){let s,c,u,d,h=a();e===r.body?(s=t,c=t.scrollX||t.pageXOffset,u=t.scrollY||t.pageYOffset,d=o.scroll):(s=e,c=e.scrollLeft,u=e.scrollTop,d=l),function e(r){var n;let i=a(),o,s,l,c=(i-r.startTime)/468;o=.5*(1-Math.cos(Math.PI*(n=c=c>1?1:c))),s=r.startX+(r.x-r.startX)*o,l=r.startY+(r.y-r.startY)*o,r.method.call(r.scrollable,s,l),(s!==r.x||l!==r.y)&&t.requestAnimationFrame(e.bind(t,r))}({scrollable:s,method:d,startTime:h,startX:c,startY:u,x:n,y:i})}t.scroll=t.scrollTo=function(){if(void 0!==arguments[0]){if(!0===c(arguments[0])){o.scroll.call(t,void 0!==arguments[0].left?arguments[0].left:"object"!=typeof arguments[0]?arguments[0]:t.scrollX||t.pageXOffset,void 0!==arguments[0].top?arguments[0].top:void 0!==arguments[1]?arguments[1]:t.scrollY||t.pageYOffset);return}p.call(t,r.body,void 0!==arguments[0].left?~~arguments[0].left:t.scrollX||t.pageXOffset,void 0!==arguments[0].top?~~arguments[0].top:t.scrollY||t.pageYOffset)}},t.scrollBy=function(){if(void 0!==arguments[0]){if(c(arguments[0])){o.scrollBy.call(t,void 0!==arguments[0].left?arguments[0].left:"object"!=typeof arguments[0]?arguments[0]:0,void 0!==arguments[0].top?arguments[0].top:void 0!==arguments[1]?arguments[1]:0);return}p.call(t,r.body,~~arguments[0].left+(t.scrollX||t.pageXOffset),~~arguments[0].top+(t.scrollY||t.pageYOffset))}},i.prototype.scroll=i.prototype.scrollTo=function(){if(void 0===arguments[0])return;if(!0===c(arguments[0])){if("number"==typeof arguments[0]&&void 0===arguments[1])throw SyntaxError("Value could not be converted");o.elementScroll.call(this,void 0!==arguments[0].left?~~arguments[0].left:"object"!=typeof arguments[0]?~~arguments[0]:this.scrollLeft,void 0!==arguments[0].top?~~arguments[0].top:void 0!==arguments[1]?~~arguments[1]:this.scrollTop);return}let e=arguments[0].left,t=arguments[0].top;p.call(this,this,void 0===e?this.scrollLeft:~~e,void 0===t?this.scrollTop:~~t)},i.prototype.scrollBy=function(){if(void 0!==arguments[0]){if(!0===c(arguments[0])){o.elementScroll.call(this,void 0!==arguments[0].left?~~arguments[0].left+this.scrollLeft:~~arguments[0]+this.scrollLeft,void 0!==arguments[0].top?~~arguments[0].top+this.scrollTop:~~arguments[1]+this.scrollTop);return}this.scroll({left:~~arguments[0].left+this.scrollLeft,top:~~arguments[0].top+this.scrollTop,behavior:arguments[0].behavior})}},i.prototype.scrollIntoView=function(){if(!0===c(arguments[0])){o.scrollIntoView.call(this,void 0===arguments[0]||arguments[0]);return}let e=function e(t){for(;t!==r.body&&!1===h(t);)t=t.parentNode||t.host;return t}(this),n=e.getBoundingClientRect(),i=this.getBoundingClientRect();e!==r.body?(p.call(this,e,e.scrollLeft+i.left-n.left,e.scrollTop+i.top-n.top),"fixed"!==t.getComputedStyle(e).position&&t.scrollBy({left:n.left,top:n.top,behavior:"smooth"})):t.scrollBy({left:i.left,top:i.top,behavior:"smooth"})}}(this.iframe.contentWindow,this.iframe.contentDocument),er(this.iframe.contentWindow))}rebuildFullSnapshot(e,t=!1){var r,n,i,o,a,s,l,c,d,h;if(!this.iframe.contentDocument)return console.warn("Looks like your replayer has been destroyed.");Object.keys(this.legacy_missingNodeRetryMap).length&&console.warn("Found unresolved missing node map",this.legacy_missingNodeRetryMap),this.legacy_missingNodeRetryMap={};let p=[],f=(e,t)=>{for(let r of(this.collectIframeAndAttachDocument(p,e),this.config.plugins||[]))r.onBuild&&r.onBuild(e,{id:t,replayer:this})};for(let{mutationInQueue:m,builtNode:y}of(r=e.data.node,i=(n={doc:this.iframe.contentDocument,afterAppend:f,cache:this.cache,mirror:this.mirror}).doc,o=n.onVisit,a=n.hackCss,s=n.afterAppend,l=n.cache,d=void 0===(c=n.mirror)?new g:c,Y(r,{doc:i,mirror:d,skipChild:!1,hackCss:void 0===a||a,afterAppend:s,cache:l}),function e(t,r){function n(e){r(e)}for(var i=0,o=t.getIds();i<o.length;i++){var a,s=o[i];t.has(s)&&r(a=t.getNode(s))}}(d,function(e){o&&o(e),function e(t,r){var n=r.getMeta(t);if((null==n?void 0:n.type)===u.Element){var i=t;for(var o in n.attributes)if(Object.prototype.hasOwnProperty.call(n.attributes,o)&&o.startsWith("rr_")){var a=n.attributes[o];"rr_scrollLeft"===o&&(i.scrollLeft=a),"rr_scrollTop"===o&&(i.scrollTop=a)}}}(e,d)}),f(this.iframe.contentDocument,e.data.node.id),p))this.attachDocumentToIframe(m,y),this.newDocumentQueue=this.newDocumentQueue.filter(e=>e!==m);let{documentElement:v,head:$}=this.iframe.contentDocument;this.insertStyleRules(v,$),this.service.state.matches("playing")||this.iframe.contentDocument.getElementsByTagName("html")[0].classList.add("reweby-paused"),this.emitter.emit(eN.FullsnapshotRebuilded,e),t||this.waitForStylesheetLoad(),this.config.UNSAFE_replayCanvas&&this.preloadAllImages()}insertStyleRules(e,t){var r;let n=rk(this.config.blockClass).concat(this.config.insertStyleRules);if(this.config.pauseAnimation&&n.push("html.reweby-paused *, html.reweby-paused *:before, html.reweby-paused *:after { animation-play-state: paused !important; }"),this.usingVirtualDom){let i=this.virtualDom.createElement("style");this.virtualDom.mirror.add(i,ru(i,this.virtualDom.unserializedId)),e.insertBefore(i,t),i.rules.push({source:eC.StyleSheetRule,adds:n.map((e,t)=>({rule:e,index:t}))})}else{let o=document.createElement("style");e.insertBefore(o,t);for(let a=0;a<n.length;a++)null==(r=o.sheet)||r.insertRule(n[a],a)}}attachDocumentToIframe(e,t){let r=this.usingVirtualDom?this.virtualDom.mirror:this.mirror,n=[],i=(e,i)=>{this.collectIframeAndAttachDocument(n,e);let o=r.getMeta(e);if((null==o?void 0:o.type)===u.Element&&(null==o?void 0:o.tagName.toUpperCase())==="HTML"){let{documentElement:a,head:s}=t.contentDocument;this.insertStyleRules(a,s)}for(let l of this.config.plugins||[])l.onBuild&&l.onBuild(e,{id:i,replayer:this})};for(let{mutationInQueue:o,builtNode:a}of(Y(e.node,{doc:t.contentDocument,mirror:r,hackCss:!0,skipChild:!1,afterAppend:i,cache:this.cache}),i(t.contentDocument,e.node.id),n))this.attachDocumentToIframe(o,a),this.newDocumentQueue=this.newDocumentQueue.filter(e=>e!==o)}collectIframeAndAttachDocument(e,t){if(eo(t,this.mirror)){let r=this.newDocumentQueue.find(e=>e.parentId===this.mirror.getId(t));r&&e.push({mutationInQueue:r,builtNode:t})}}waitForStylesheetLoad(){var e;let t=null==(e=this.iframe.contentDocument)?void 0:e.head;if(t){let r=new Set,n,i=this.service.state,o=()=>{i=this.service.state};this.emitter.on(eN.Start,o),this.emitter.on(eN.Pause,o);let a=()=>{this.emitter.off(eN.Start,o),this.emitter.off(eN.Pause,o)};t.querySelectorAll('link[rel="stylesheet"]').forEach(e=>{e.sheet||(r.add(e),e.addEventListener("load",()=>{r.delete(e),0===r.size&&-1!==n&&(i.matches("playing")&&this.play(this.getCurrentTime()),this.emitter.emit(eN.LoadStylesheetEnd),n&&clearTimeout(n),a())}))}),r.size>0&&(this.service.send({type:"PAUSE"}),this.emitter.emit(eN.LoadStylesheetStart),n=setTimeout(()=>{i.matches("playing")&&this.play(this.getCurrentTime()),n=-1,a()},this.config.loadTimeout))}}preloadAllImages(){return r2(this,null,function*(){this.service.state;let e=()=>{this.service.state};this.emitter.on(eN.Start,e),this.emitter.on(eN.Pause,e);let t=[];for(let r of this.service.state.context.events)if(r.type===eb.IncrementalSnapshot&&r.data.source===eC.CanvasMutation){t.push(this.deserializeAndPreloadCanvasEvents(r.data,r));let n="commands"in r.data?r.data.commands:[r.data];n.forEach(e=>{this.preloadImages(e,r)})}return Promise.all(t)})}preloadImages(e,t){if("drawImage"===e.property&&"string"==typeof e.args[0]&&!this.imageMap.has(t)){let r=document.createElement("canvas"),n=r.getContext("2d"),i=null==n?void 0:n.createImageData(r.width,r.height);null==i||i.data,JSON.parse(e.args[0]),null==n||n.putImageData(i,0,0)}}deserializeAndPreloadCanvasEvents(e,t){return r2(this,null,function*(){if(!this.canvasEventMap.has(t)){let r={isUnchanged:!0};if("commands"in e){let n=yield Promise.all(e.commands.map(e=>r2(this,null,function*(){let t=yield Promise.all(e.args.map(r8(this.imageMap,null,r)));return r7(r6({},e),{args:t})})));!1===r.isUnchanged&&this.canvasEventMap.set(t,r7(r6({},e),{commands:n}))}else{let i=yield Promise.all(e.args.map(r8(this.imageMap,null,r)));!1===r.isUnchanged&&this.canvasEventMap.set(t,r7(r6({},e),{args:i}))}}})}applyIncremental(e,t){var r,n,i;let{data:o}=e;switch(o.source){case eC.Mutation:try{this.applyMutation(o,t)}catch(a){this.warn(`Exception in mutation ${a.message||a}`,o)}break;case eC.Drag:case eC.TouchMove:case eC.MouseMove:if(t){let s=o.positions[o.positions.length-1];this.mousePos={x:s.x,y:s.y,id:s.id,debugData:o}}else o.positions.forEach(r=>{let n={doAction:()=>{this.moveAndHover(r.x,r.y,r.id,t,o)},delay:r.timeOffset+e.timestamp-this.service.state.context.baselineTime};this.timer.addAction(n)}),this.timer.addAction({doAction(){},delay:e.delay-(null==(r=o.positions[0])?void 0:r.timeOffset)});break;case eC.MouseInteraction:{if(-1===o.id||t)break;let l=new Event(eI[o.type].toLowerCase()),c=this.mirror.getNode(o.id);if(!c)return this.debugNodeNotFound(o,o.id);this.emitter.emit(eN.MouseInteraction,{type:o.type,target:c});let{triggerFocus:u}=this.config;switch(o.type){case eI.Blur:"blur"in c&&c.blur();break;case eI.Focus:u&&c.focus&&c.focus({preventScroll:!0});break;case eI.Click:case eI.TouchStart:case eI.TouchEnd:t?(o.type===eI.TouchStart?this.touchActive=!0:o.type===eI.TouchEnd&&(this.touchActive=!1),this.mousePos={x:o.x,y:o.y,id:o.id,debugData:o}):(o.type===eI.TouchStart&&(this.tailPositions.length=0),this.moveAndHover(o.x,o.y,o.id,t,o),o.type===eI.Click?(this.mouse.classList.remove("active"),this.mouse.offsetWidth,this.mouse.classList.add("active")):o.type===eI.TouchStart?(this.mouse.offsetWidth,this.mouse.classList.add("touch-active")):o.type===eI.TouchEnd&&this.mouse.classList.remove("touch-active"));break;case eI.TouchCancel:t?this.touchActive=!1:this.mouse.classList.remove("touch-active");break;default:c.dispatchEvent(l)}break}case eC.Scroll:if(-1===o.id)break;if(this.usingVirtualDom){let d=this.virtualDom.mirror.getNode(o.id);if(!d)return this.debugNodeNotFound(o,o.id);d.scrollData=o;break}this.applyScroll(o,t);break;case eC.ViewportResize:this.emitter.emit(eN.Resize,{width:o.width,height:o.height});break;case eC.Input:if(-1===o.id)break;if(this.usingVirtualDom){let h=this.virtualDom.mirror.getNode(o.id);if(!h)return this.debugNodeNotFound(o,o.id);h.inputData=o;break}this.applyInput(o);break;case eC.MediaInteraction:{let p=this.usingVirtualDom?this.virtualDom.mirror.getNode(o.id):this.mirror.getNode(o.id);if(!p)return this.debugNodeNotFound(o,o.id);let f=p;try{o.currentTime&&(f.currentTime=o.currentTime),o.volume&&(f.volume=o.volume),o.muted&&(f.muted=o.muted),o.type===ew.Pause&&f.pause(),o.type===ew.Play&&f.play(),o.type===ew.RateChange&&(f.playbackRate=o.playbackRate)}catch(m){this.config.showWarning&&console.warn(`Failed to replay media interactions: ${m.message||m}`)}break}case eC.StyleSheetRule:case eC.StyleDeclaration:this.usingVirtualDom?o.styleId?this.constructedStyleMutations.push(o):o.id&&(null==(n=this.virtualDom.mirror.getNode(o.id))||n.rules.push(o)):this.applyStyleSheetMutation(o);break;case eC.CanvasMutation:if(!this.config.UNSAFE_replayCanvas)return;if(this.usingVirtualDom){let g=this.virtualDom.mirror.getNode(o.id);if(!g)return this.debugNodeNotFound(o,o.id);g.canvasMutations.push({event:e,mutation:o})}else{let y=this.mirror.getNode(o.id);if(!y)return this.debugNodeNotFound(o,o.id);rB({event:e,mutation:o,target:y,imageMap:this.imageMap,canvasEventMap:this.canvasEventMap,errorHandler:this.warnCanvasMutationFailed.bind(this)})}break;case eC.Font:try{let v=new FontFace(o.family,o.buffer?new Uint8Array(JSON.parse(o.fontSource)):o.fontSource,o.descriptors);null==(i=this.iframe.contentDocument)||i.fonts.add(v)}catch($){this.config.showWarning&&console.warn($)}break;case eC.Selection:if(t){this.lastSelectionData=o;break}this.applySelection(o);break;case eC.AdoptedStyleSheet:this.usingVirtualDom?this.adoptedStyleSheets.push(o):this.applyAdoptedStyleSheet(o)}}applyMutation(e,t){if(this.config.useVirtualDom&&!this.usingVirtualDom&&t&&(this.usingVirtualDom=!0,function e(t,r=new t1,n=new t9){return function e(t,i){let o=rl(t,n,r,i);if(null!==o){if((null==i?void 0:i.nodeName)!=="IFRAME"&&t.nodeType!==f.DOCUMENT_FRAGMENT_NODE&&(null==i||i.appendChild(o),o.parentNode=i,o.parentElement=i),"IFRAME"===t.nodeName){let a=t.contentDocument;a&&e(a,o)}else(t.nodeType===f.DOCUMENT_NODE||t.nodeType===f.ELEMENT_NODE||t.nodeType===f.DOCUMENT_FRAGMENT_NODE)&&(t.nodeType===f.ELEMENT_NODE&&t.shadowRoot&&e(t.shadowRoot,o),t.childNodes.forEach(t=>e(t,o)))}}(t,null),n}(this.iframe.contentDocument,this.mirror,this.virtualDom),Object.keys(this.legacy_missingNodeRetryMap).length))for(let r in this.legacy_missingNodeRetryMap)try{let n=this.legacy_missingNodeRetryMap[r],i=rl(n.node,this.virtualDom,this.mirror);i&&(n.node=i)}catch(o){this.config.showWarning&&console.warn(o)}let a=this.usingVirtualDom?this.virtualDom.mirror:this.mirror;e.removes.forEach(t=>{var r;let n=a.getNode(t.id);if(!n){if(e.removes.find(e=>e.id===t.parentId))return;return this.warnNodeNotFound(e,t.id)}let i=a.getNode(t.parentId);if(!i)return this.warnNodeNotFound(e,t.parentId);if(t.isShadow&&el(i)&&(i=i.shadowRoot),a.removeNodeFromMap(n),i)try{i.removeChild(n),this.usingVirtualDom&&"#text"===n.nodeName&&"STYLE"===i.nodeName&&(null==(r=i.rules)?void 0:r.length)>0&&(i.rules=[])}catch(o){if(o instanceof DOMException)this.warn("parent could not remove child in mutation",i,n,e);else throw o}});let s=r6({},this.legacy_missingNodeRetryMap),l=[],c=e=>{let t=null;return e.nextId&&(t=a.getNode(e.nextId)),null!==e.nextId&&void 0!==e.nextId&&-1!==e.nextId&&!t},d=e=>{var t;if(!this.iframe.contentDocument)return console.warn("Looks like your replayer has been destroyed.");let r=a.getNode(e.parentId);if(!r)return e.node.type===u.Document?this.newDocumentQueue.push(e):l.push(e);e.node.isShadow&&(el(r)||r.attachShadow({mode:"open"}),r=r.shadowRoot);let n=null,i=null;if(e.previousId&&(n=a.getNode(e.previousId)),e.nextId&&(i=a.getNode(e.nextId)),c(e))return l.push(e);if(e.node.rootId&&!a.getNode(e.node.rootId))return;let o=e.node.rootId?a.getNode(e.node.rootId):this.usingVirtualDom?this.virtualDom:this.iframe.contentDocument;if(eo(r,a)){this.attachDocumentToIframe(e,r);return}let d=(e,t)=>{for(let r of this.config.plugins||[])r.onBuild&&r.onBuild(e,{id:t,replayer:this})},h=Y(e.node,{doc:o,mirror:a,skipChild:!0,hackCss:!0,cache:this.cache,afterAppend:d});if(-1===e.previousId||-1===e.nextId){s[e.node.id]={node:h,mutation:e};return}let p=a.getMeta(r);if(p&&p.type===u.Element&&"textarea"===p.tagName&&e.node.type===u.Text){let f=Array.isArray(r.childNodes)?r.childNodes:Array.from(r.childNodes);for(let m of f)m.nodeType===r.TEXT_NODE&&r.removeChild(m)}if(n&&n.nextSibling&&n.nextSibling.parentNode)r.insertBefore(h,n.nextSibling);else if(i&&i.parentNode)r.contains(i)?r.insertBefore(h,i):r.insertBefore(h,null);else{if(r===o)for(;o.firstChild;)o.removeChild(o.firstChild);r.appendChild(h)}if(d(h,e.node.id),this.usingVirtualDom&&"#text"===h.nodeName&&"STYLE"===r.nodeName&&(null==(t=r.rules)?void 0:t.length)>0&&(r.rules=[]),eo(h,this.mirror)){let g=this.mirror.getId(h),y=this.newDocumentQueue.find(e=>e.parentId===g);y&&(this.attachDocumentToIframe(y,h),this.newDocumentQueue=this.newDocumentQueue.filter(e=>e!==y))}(e.previousId||e.nextId)&&this.legacy_resolveMissingNode(s,r,h,e)};e.adds.forEach(e=>{d(e)});let h=Date.now();for(;l.length;){let p=en(l);if(l.length=0,Date.now()-h>500){this.warn("Timeout in the loop, please check the resolve tree data:",p);break}for(let m of p){let g=a.getNode(m.value.parentId);g?ei(m,e=>{d(e)}):this.debug("Drop resolve tree since there is no parent for the root node.",m)}}Object.keys(s).length&&Object.assign(this.legacy_missingNodeRetryMap,s),ed(e.texts).forEach(t=>{var r;let n=a.getNode(t.id);if(!n){if(e.removes.find(e=>e.id===t.id))return;return this.warnNodeNotFound(e,t.id)}if(n.textContent=t.value,this.usingVirtualDom){let i=n.parentNode;(null==(r=null==i?void 0:i.rules)?void 0:r.length)>0&&(i.rules=[])}}),e.attributes.forEach(t=>{let r=a.getNode(t.id);if(!r){if(e.removes.find(e=>e.id===t.id))return;return this.warnNodeNotFound(e,t.id)}for(let n in t.attributes)if("string"==typeof n){let i=t.attributes[n];if(null===i)r.removeAttribute(n);else if("string"==typeof i)try{if("_cssText"===n&&("LINK"===r.nodeName||"STYLE"===r.nodeName))try{let o=a.getMeta(r);Object.assign(o.attributes,t.attributes);let s=Y(o,{doc:r.ownerDocument,mirror:a,skipChild:!0,hackCss:!0,cache:this.cache}),l=r.nextSibling,c=r.parentNode;if(s&&c){c.removeChild(r),c.insertBefore(s,l),a.replace(t.id,s);break}}catch(u){}r.setAttribute(n,i)}catch(d){this.config.showWarning&&console.warn("An error occurred may due to the checkout feature.",d)}else if("style"===n){let h=i,p=r;for(let f in h)if(!1===h[f])p.style.removeProperty(f);else if(h[f]instanceof Array){let m=h[f];p.style.setProperty(f,m[0],m[1])}else{let g=h[f];p.style.setProperty(f,g)}}}})}applyScroll(e,t){var r,n;let i=this.mirror.getNode(e.id);if(!i)return this.debugNodeNotFound(e,e.id);let o=this.mirror.getMeta(i);if(i===this.iframe.contentDocument)null==(r=this.iframe.contentWindow)||r.scrollTo({top:e.y,left:e.x,behavior:t?"auto":"smooth"});else if((null==o?void 0:o.type)===u.Document)null==(n=i.defaultView)||n.scrollTo({top:e.y,left:e.x,behavior:t?"auto":"smooth"});else try{i.scrollTo({top:e.y,left:e.x,behavior:t?"auto":"smooth"})}catch(a){}}applyInput(e){let t=this.mirror.getNode(e.id);if(!t)return this.debugNodeNotFound(e,e.id);try{t.checked=e.isChecked,t.value=e.text}catch(r){}}applySelection(e){try{let t=new Set,r=e.ranges.map(({start:e,startOffset:r,end:n,endOffset:i})=>{let o=this.mirror.getNode(e),a=this.mirror.getNode(n);if(!o||!a)return;let s=new Range;s.setStart(o,r),s.setEnd(a,i);let l=o.ownerDocument,c=null==l?void 0:l.getSelection();return c&&t.add(c),{range:s,selection:c}});t.forEach(e=>e.removeAllRanges()),r.forEach(e=>{var t;return e&&(null==(t=e.selection)?void 0:t.addRange(e.range))})}catch(n){}}applyStyleSheetMutation(e){var t;let r=null;e.styleId?r=this.styleMirror.getStyle(e.styleId):e.id&&(r=(null==(t=this.mirror.getNode(e.id))?void 0:t.sheet)||null),r&&(e.source===eC.StyleSheetRule?this.applyStyleSheetRule(e,r):e.source===eC.StyleDeclaration&&this.applyStyleDeclaration(e,r))}applyStyleSheetRule(e,t){var r,n,i,o;if(null==(r=e.adds)||r.forEach(({rule:e,index:r})=>{try{if(Array.isArray(r)){let{positions:n,index:i}=eu(r),o=ec(t.cssRules,n);o.insertRule(e,i)}else{let a=void 0===r?void 0:Math.min(r,t.cssRules.length);null==t||t.insertRule(e,a)}}catch(s){}}),null==(n=e.removes)||n.forEach(({index:e})=>{try{if(Array.isArray(e)){let{positions:r,index:n}=eu(e),i=ec(t.cssRules,r);i.deleteRule(n||0)}else null==t||t.deleteRule(e)}catch(o){}}),e.replace)try{null==(i=t.replace)||i.call(t,e.replace)}catch(a){}if(e.replaceSync)try{null==(o=t.replaceSync)||o.call(t,e.replaceSync)}catch(s){}}applyStyleDeclaration(e,t){if(e.set){let r=ec(t.rules,e.index);r.style.setProperty(e.set.property,e.set.value,e.set.priority)}if(e.remove){let n=ec(t.rules,e.index);n.style.removeProperty(e.remove.property)}}applyAdoptedStyleSheet(e){var t;let r=this.mirror.getNode(e.id);if(!r)return;null==(t=e.styles)||t.forEach(e=>{var t;let n=null,i=null;if(el(r)?i=(null==(t=r.ownerDocument)?void 0:t.defaultView)||null:"#document"===r.nodeName&&(i=r.defaultView),i)try{n=new i.CSSStyleSheet,this.styleMirror.add(n,e.styleId),this.applyStyleSheetRule({source:eC.StyleSheetRule,adds:e.rules},n)}catch(o){}});let n=0,i=(e,t)=>{let r=t.map(e=>this.styleMirror.getStyle(e)).filter(e=>null!==e);el(e)?e.shadowRoot.adoptedStyleSheets=r:"#document"===e.nodeName&&(e.adoptedStyleSheets=r),r.length!==t.length&&n<10&&(setTimeout(()=>i(e,t),0+100*n),n++)};i(r,e.styleIds)}legacy_resolveMissingNode(e,t,r,n){let{previousId:i,nextId:o}=n,a=i&&e[i],s=o&&e[o];if(a){let{node:l,mutation:c}=a;t.insertBefore(l,r),delete e[c.node.id],delete this.legacy_missingNodeRetryMap[c.node.id],(c.previousId||c.nextId)&&this.legacy_resolveMissingNode(e,t,l,c)}if(s){let{node:u,mutation:d}=s;t.insertBefore(u,r.nextSibling),delete e[d.node.id],delete this.legacy_missingNodeRetryMap[d.node.id],(d.previousId||d.nextId)&&this.legacy_resolveMissingNode(e,t,u,d)}}moveAndHover(e,t,r,n,i){let o=this.mirror.getNode(r);if(!o)return this.debugNodeNotFound(i,r);let a=es(o,this.iframe),s=e*a.absoluteScale+a.x,l=t*a.absoluteScale+a.y;this.mouse.style.left=`${s}px`,this.mouse.style.top=`${l}px`,n||this.drawMouseTail({x:s,y:l}),this.hoverElements(o)}drawMouseTail(e){if(!this.mouseTail)return;let{lineCap:t,lineWidth:r,strokeStyle:n,duration:i}=!0===this.config.mouseTail?rK:Object.assign({},rK,this.config.mouseTail),o=()=>{if(!this.mouseTail)return;let e=this.mouseTail.getContext("2d");e&&this.tailPositions.length&&(e.clearRect(0,0,this.mouseTail.width,this.mouseTail.height),e.beginPath(),e.lineWidth=r,e.lineCap=t,e.strokeStyle=n,e.moveTo(this.tailPositions[0].x,this.tailPositions[0].y),this.tailPositions.forEach(t=>e.lineTo(t.x,t.y)),e.stroke())};this.tailPositions.push(e),o(),setTimeout(()=>{this.tailPositions=this.tailPositions.filter(t=>t!==e),o()},i/this.speedService.state.context.timer.speed)}hoverElements(e){var t;null==(t=this.iframe.contentDocument)||t.querySelectorAll(".\\:hover").forEach(e=>{e.classList.remove(":hover")});let r=e;for(;r;)r.classList&&r.classList.add(":hover"),r=r.parentElement}isUserInteraction(e){return e.type===eb.IncrementalSnapshot&&e.data.source>eC.Mutation&&e.data.source<=eC.Input}backToNormal(){this.nextUserInteractionEvent=null,!this.speedService.state.matches("normal")&&(this.speedService.send({type:"BACK_TO_NORMAL"}),this.emitter.emit(eN.SkipEnd,{speed:this.speedService.state.context.normalSpeed}))}warnNodeNotFound(e,t){this.warn(`Node with id '${t}' not found. `,e)}warnCanvasMutationFailed(e,t){this.warn("Has error on canvas update",t,"canvas mutation:",e)}debugNodeNotFound(e,t){this.debug(r4,`Node with id '${t}' not found. `,e)}warn(...e){this.config.showWarning&&console.warn(r4,...e)}debug(...e){this.config.showDebug&&console.log(r4,...e)}},e.ReplayerEvents=eN,e.addCustomEvent=rj,e.freezePage=rJ,e.getRecordConsolePlugin=it,e.getReplayConsolePlugin=io,e.pack=nH,e.record=tP,e.unpack=n6,e.utils=e$,Object.defineProperty(e,"__esModule",{value:!0}),e}({});